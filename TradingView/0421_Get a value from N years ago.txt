// This source code is subject to the terms of the Mozilla Public License 2.0 at https://mozilla.org/MPL/2.0/
// Â© MichelT

//@version=4
study("Get a value some years ago")
startPointTimeIndex = 9999
max_bars_back(time, 9999)

binarySearch(seachedTime) =>
    L = startPointTimeIndex
    R = 0

    for i = 0 to 100
        if L == R or time[L] == seachedTime
            break

        m = ceil((L + R) / 2)
        if time[m] > seachedTime
            R := m - 1
        else
            L := m
    _return = L

yearsBack = input(type=input.integer, defval=1, title="Years back")

requiredTime = timestamp(year - yearsBack, month, dayofmonth, hour, minute, second)
idx = binarySearch(requiredTime)

plot(year(time[idx]), title="Year", color=color.red)
plot(month(time[idx]), title="Month", color=color.green)
plot(dayofmonth(time[idx]), title="DayOfMonth", color=color.blue)

plot(hour(time[idx]), title="Hour", color=color.navy)
plot(minute(time[idx]), title="Minute", color=color.fuchsia)