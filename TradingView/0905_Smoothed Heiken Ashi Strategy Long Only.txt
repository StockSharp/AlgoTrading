//@version=5
strategy("Smoothed Heiken Ashi Strategy Long Only", overlay=true, initial_capital=1000, default_qty_type=strategy.percent_of_equity, default_qty_value=100)

len = input.int(10, title="EMA Length")
len2 = input.int(10, title="Smoothing Length")

o = ta.ema(open, len)
c = ta.ema(close, len)
h = ta.ema(high, len)
l = ta.ema(low, len)
haclose = (o + h + l + c) / 4

var float haopen = 0.0
haopen := na(haopen[1]) ? (o + c) / 2 : (haopen[1] + haclose[1]) / 2
hahigh = math.max(h, math.max(haopen, haclose))
halow = math.min(l, math.min(haopen, haclose))

o2 = ta.ema(haopen, len2)
c2 = ta.ema(haclose, len2)
col = o2 > c2 ? 0 : 1 // 0 for red, 1 for lime

// Plotting candles without wicks
plotcandle(o2, o2, c2, c2, title="Smoothed HA", color=col == 0 ? color.red : color.lime)

// Strategy logic
longEntryCondition = col == 1 and col[1] == 0
longExitCondition = col == 0 and col[1] == 1

if (longEntryCondition)
    strategy.entry("Long", strategy.long)

if (longExitCondition)
    strategy.close("Long")

// Plotting signals after the close of the candle
plotshape(longEntryCondition, title="Buy Signal", location=location.belowbar, color=color.green, style=shape.triangleup, size=size.small, offset=1)
plotshape(longExitCondition, title="Sell Signal", location=location.abovebar, color=color.red, style=shape.triangledown, size=size.small, offset=1)