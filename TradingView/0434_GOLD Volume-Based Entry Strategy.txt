//@version=5
strategy("Volume-Based Entry Strategy", overlay=true)

// Input parameters
ma_length = input.int(20, title="Volume MA Period")
target_move = input.float(5.0, title="Target Move (USD)")

// Calculate volume MA
vol_ma = ta.sma(volume, ma_length)

// Identify conditions for entry based on two consecutive green volume bars above MA
first_green_volume = volume[1] > vol_ma and close[1] > open[1] and volume[1] > vol_ma // First green volume bar must close above MA and be above MA
second_green_volume = volume > vol_ma and close > open and volume > volume[1] and volume > vol_ma // Second green volume bar must also close above MA, be higher than the first, and be above MA

// Entry signal: Two consecutive green volume bars above MA
entry_signal = first_green_volume and second_green_volume

// Execute trade on entry signal with adjustable profit target
if entry_signal
    strategy.entry("Buy", strategy.long)
    strategy.exit("Take Profit", from_entry="Buy", limit=close + target_move)

// Plot signals on the chart
plotshape(entry_signal, location=location.belowbar, color=color.green, style=shape.labelup, title="Buy Signal")

// Highlight green volume bars that trigger an entry
plot(entry_signal ? volume : na, title="Green Volume Above MA", style=plot.style_columns, color=color.green, transp=60)