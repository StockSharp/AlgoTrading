//@version=5
strategy("MACD Crossover Strategy", overlay=false)

// MACD parameters
fastLength = input(12, "Fast Length")
slowLength = input(26, "Slow Length")
signalLength = input(9, "Signal Length")

// Important zone parameters
lowerThreshold = input.float(-0.5, "Lower Threshold", step=0.1)
upperThreshold = input.float(0.5, "Upper Threshold", step=0.1)

// Calculate MACD
[macdLine, signalLine, _] = ta.macd(close, fastLength, slowLength, signalLength)

// Plot MACD lines
plot(macdLine, color=color.blue, title="MACD Line")
plot(signalLine, color=color.orange, title="Signal Line")
plot(0, color=color.white, title="Zero Line")
plot(upperThreshold, color=color.gray, style=plot.style_linebr, title="Upper Threshold")
plot(lowerThreshold, color=color.gray, style=plot.style_linebr, title="Lower Threshold")

// Define crossover conditions
crossOverUp = ta.crossover(macdLine, signalLine)
crossOverDown = ta.crossunder(macdLine, signalLine)

// Define important crossover zone
isImportantZone = macdLine >= lowerThreshold and macdLine <= upperThreshold

// Strategy entries
if (crossOverUp and isImportantZone)
    strategy.entry("Long", strategy.long)

if (crossOverDown and isImportantZone)
    strategy.entry("Short", strategy.short)

// Optional: Add exits based on opposite signals
if (crossOverDown)
    strategy.close("Long")

if (crossOverUp)
    strategy.close("Short")

// Plot buy/sell signals
plotshape(series=crossOverUp and isImportantZone, title="Buy Signal", location=location.bottom, color=color.green, style=shape.triangleup, size=size.small)
plotshape(series=crossOverDown and isImportantZone, title="Sell Signal", location=location.top, color=color.red, style=shape.triangledown, size=size.small)