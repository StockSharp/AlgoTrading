//@version=5
strategy("PulseWave Strategy Markking77", overlay=true)

// VWAP
vwap_val = ta.vwap(close)

// MACD
fastLength = input.int(12, title="MACD Fast Length")
slowLength = input.int(26, title="MACD Slow Length")
signalLength = input.int(9, title="MACD Signal Length")

[macdLine, signalLine, _] = ta.macd(close, fastLength, slowLength, signalLength)

// RSI
rsiLength = input.int(14, title="RSI Length")
rsi_val = ta.rsi(close, rsiLength)

// Strategy Conditions
buyCond = (close > vwap_val) and ta.crossover(macdLine, signalLine) and (rsi_val < 70)
sellCond = (close < vwap_val) and ta.crossunder(macdLine, signalLine) and (rsi_val > 30)

// Entries and Exits
if (buyCond)
    strategy.entry("Long", strategy.long)

if (sellCond)
    strategy.close("Long")

// Plot VWAP on price chart
plot(vwap_val, color=color.blue, title="VWAP", linewidth=2)

// Plot MACD and RSI in separate panes for reference (optional)
plot(macdLine, title="MACD Line", color=color.orange, display=display.none)
plot(signalLine, title="Signal Line", color=color.blue, display=display.none)
plot(rsi_val, title="RSI", color=color.purple, display=display.none)

// Add simple alerts on chart for buy/sell signals
plotshape(buyCond, title="Buy Signal", location=location.belowbar, color=color.green, style=shape.labelup, size=size.small)
plotshape(sellCond, title="Sell Signal", location=location.abovebar, color=color.red, style=shape.labeldown, size=size.small)