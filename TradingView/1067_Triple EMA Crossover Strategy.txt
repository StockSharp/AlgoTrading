//@version=5
strategy("Trend Following Triple MA Strategy", overlay=true)

// Define input parameters
sma1Period = input.int(9, title="SMA1 Period", minval=1)
sma2Period = input.int(21, title="SMA2 Period", minval=1)
sma3Period = input.int(55, title="SMA3 Period", minval=1)
stopLossTicks = input.int(200, title="Stop Loss in Ticks", minval=1)
takeProfitTicks = input.int(200, title="Take Profit in Ticks", minval=1)
adxPeriod = input.int(14, title="ADX Period", minval=1)
adxThreshold = input.int(25, title="ADX Threshold", minval=1)

// Calculate indicators
sma1 = ta.sma(close, sma1Period)
sma2 = ta.sma(close, sma2Period)
sma3 = ta.sma(close, sma3Period)
// adx = ta.adx(adxPeriod)

// Plot SMAs
plot(sma1, color=color.green, title="SMA1")
plot(sma2, color=color.orange, title="SMA2")
plot(sma3, color=color.red, title="SMA3")

// Define trend conditions
uptrend = sma1 > sma2 and sma2 > sma3
downtrend = sma1 < sma2 and sma2 < sma3

// Define entry conditions
longCondition = ta.crossover(sma1, sma2) and uptrend and  strategy.position_size == 0
shortCondition = ta.crossunder(sma1, sma2) and downtrend and strategy.position_size == 0

// Define exit conditions
exitLong = ta.crossunder(close, sma1) and strategy.position_size > 0
exitShort = ta.crossover(close, sma1) and strategy.position_size < 0

// Execute trades
if (longCondition)
    strategy.entry("Long", strategy.long)
    strategy.exit("Take Profit/Stop Loss", "Long", stop=close - stopLossTicks * syminfo.mintick, limit=close + takeProfitTicks * syminfo.mintick)

if (shortCondition)
    strategy.entry("Short", strategy.short)
    strategy.exit("Take Profit/Stop Loss", "Short", stop=close + stopLossTicks * syminfo.mintick, limit=close - takeProfitTicks * syminfo.mintick)

if (exitLong)
    strategy.close("Long")

if (exitShort)
    strategy.close("Short")

// Color bars based on position
// barcolor(strategy.position_size == 0 ? color.yellow : strategy.position_size > 0 ? color.green : color.red)