// Bitcoin Volatility Master Strategy
// This Pine Script™ code is subject to the terms of the Mozilla Public License 2.0 at https://mozilla.org/MPL/2.0/
// © exlux

//@version=5
strategy("Crypto Volatility Bitcoin Correlation Strategy", overlay=true)

// User Inputs for Flexibility
symbol = input.symbol("COINBASE:BTCUSD", title="Bitcoin Symbol")  // User can change the asset symbol here
symbol_volatility_index = input.symbol("BITMEX:BVOL7D", title="Bitcoin Volatility Index (7D)")  // The BVOL7D volatility index from BitMEX
VIXFixLength = input.int(22, title="VIX Fix Length")  // Customizable length for VIX Fix calculation
emaLength = input.int(50, title="EMA Length")  // Customizable length for EMA

// Requesting Security Data
close_ = request.security(symbol, timeframe.period, close)  // Fetch close price for selected asset
low_ = request.security(symbol, timeframe.period, low)  // Fetch low price for selected asset
bvol7d = request.security(symbol_volatility_index, timeframe.period, close)  // Fetch Bitcoin 7-day volatility

// VIXFix Calculation (Volatility Index for Crypto)
VIXFix = (ta.highest(close_, VIXFixLength) - low_) / (ta.highest(close_, VIXFixLength)) * 100

// ATR (Average True Range) Calculation
// atr = ta.atr(14)  // Default ATR period of 14

// EMA Calculation (Exponential Moving Average)
ema_out = ta.ema(close_, emaLength)  // Calculate the EMA of the close price

// Entry and Exit Conditions
longCondition = (VIXFix > VIXFix[1] and bvol7d > bvol7d[1]) and close_ > ema_out  // Go long when VIXFix and BVOL7D are rising, and price is above EMA
exitCondition = close_ < ema_out  // Exit long when the price drops below the EMA

// Strategy Execution
strategy.entry('Long Position', strategy.long, when=longCondition)  // Enter a long position when conditions are met
strategy.close("Long Position", when=exitCondition)  // Close the position when the exit condition is triggered

// Plotting for Visualization
// plot(close_, color=color.blue, linewidth=1, title="Price")  // Plot the close price for reference
// plot(ema_out, color=color.red, linewidth=2, title="EMA")  // Plot the EMA for visual guidance
// plot(VIXFix, color=color.orange, linewidth=2, title="VIX Fix")  // Plot the VIXFix for reference
// plot(bvol7d, color=color.green, linewidth=2, title="BVOL7D")  // Plot BVOL7D volatility index for reference
// hline(0, "Zero Line", color=color.gray)  // Add a zero line for better visibility

// Alerts for Traders
// alertcondition(longCondition, title="Long Entry Alert", message="Bitcoin Volatility Master Strategy: Long entry signal triggered!")
// alertcondition(exitCondition, title="Exit Long Position Alert", message="Bitcoin Volatility Master Strategy: Exit signal triggered!")