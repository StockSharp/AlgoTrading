//@version=5
strategy("VIX Futures Basis Strategy", overlay=false)

// Input for the user to specify the contango/backwardation threshold
threshold = input.float(0.1, title="Basis Threshold", step=0.01)

// Fetch VIX index data
vix = request.security("CBOE:VIX", "D", close)

// Fetch VIX futures data (assuming the user has access to this symbol, replace with actual symbol)
vix_futures_1 = request.security("CBOE:VX1!", "D", close)
vix_futures_2 = request.security("CBOE:VX2!", "D", close)

// Calculate basis for the front and second VIX futures contracts
basis1 = vix_futures_1 - vix
basis2 = vix_futures_2 - vix

// Determine if the market is in contango or backwardation
contango = basis1 > threshold and basis2 > threshold
backwardation = basis1 < -threshold and basis2 < -threshold

// Invert signals: long on contango, short on backwardation
long_signal = contango
short_signal = backwardation

// Execute trades based on signals
if (long_signal)
    strategy.entry("Long", strategy.long)

if (short_signal)
    strategy.close("Long")

// Plot signals
plotshape(series=long_signal, location=location.belowbar, color=color.green, style=shape.triangleup, title="Long Signal")
plotshape(series=short_signal, location=location.abovebar, color=color.red, style=shape.triangledown, title="Short Signal")

// Plot the VIX and futures prices for reference
plot(vix, color=color.blue, title="VIX Index")
plot(vix_futures_1, color=color.orange, title="VIX Futures 1")
plot(vix_futures_2, color=color.purple, title="VIX Futures 2")

// Display basis values for debugging
plot(basis1, color=color.gray, title="Basis 1")
plot(basis2, color=color.gray, title="Basis 2")