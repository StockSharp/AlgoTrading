// This Pine Script™ code is subject to the terms of the Mozilla Public License 2.0 at https://mozilla.org/MPL/2.0/
// © Botnet101

//@version=6
strategy('Turn around Tuesday on Steroids Strategy', overlay = true, default_qty_value = 100, default_qty_type = strategy.percent_of_equity, margin_long = 5, margin_short = 5, process_orders_on_close = true, precision = 4, calc_on_every_tick = true)

in_start_time = input.time(timestamp('1 Jan 2014'), title = 'Start Time', group = 'Time Settings')
in_end_time = input.time(timestamp('1 Jan 2099'), title = 'End Time', group = 'Time Settings')
in_window = time >= in_start_time and time <= in_end_time

startingDayInput = input.string(defval = 'Sunday', options = ['Sunday', 'Monday'], title = 'Starting Day', tooltip = 'For ETFs and Stocks, use Monday. For everything else, use Sunday')
useMaFilter = input.bool(defval = false, title = 'Use MA Filter')

isFirstDayOfWeek = startingDayInput == 'Sunday' ? dayofweek == dayofweek.sunday or dayofweek == dayofweek.monday : dayofweek == dayofweek.monday or dayofweek == dayofweek.tuesday

_ema = ta.sma(close, 200)
plot(_ema, color = color.red)

longCondition = isFirstDayOfWeek and close < close[1] and close[1] < close[2] and in_window
exitCondition = close > high[1]

if useMaFilter
    longCondition := longCondition and close > _ema

if longCondition
    strategy.entry('long', strategy.long)
if exitCondition
    strategy.close_all()