// This source code is subject to the terms of the Mozilla Public License 2.0 at https://mozilla.org/MPL/2.0/
// Â© EvoCrypto

//@version=4
study("Separated Moving Average - evo", shorttitle="Separated Moving Average", overlay=true)

// INPUT
Type            =   input("SMA",    title="Type",       options=["SMA", "EMA", "HMA"])
Length          =   input(20,       title="Length",     minval=1)

Heikin_Ashi     =   input(true,     title="Heikin Ashi Settings")
Display_Base    =   input(false,    title="Show Regular Moving Average")

// SETTING
Close           =   Heikin_Ashi ? security(heikinashi(syminfo.tickerid), timeframe.period, close)    : close
Open            =   Heikin_Ashi ? security(heikinashi(syminfo.tickerid), timeframe.period, open)     : open

Up              =   float(na), Up := Close > Open ? close : nz(Up[1])
Dn              =   float(na), Dn := Close < Open ? close : nz(Dn[1])

Avg_Up          =   Type == "SMA" ? sma(Up, Length)     : Type == "EMA" ? ema(Up, Length)    : Type == "HMA" ? hma(Up, Length)    : na
Avg_Dn          =   Type == "SMA" ? sma(Dn, Length)     : Type == "EMA" ? ema(Dn, Length)    : Type == "HMA" ? hma(Dn, Length)    : na
Avg             =   Type == "SMA" ? sma(close, Length)  : Type == "EMA" ? ema(close, Length) : Type == "HMA" ? hma(close, Length) : na

// PLOT
plot(Avg_Up,                    title="Average Up",     color=color.new(#ff9800, 0), linewidth=2)
plot(Avg_Dn,                    title="Average Down",   color=color.new(#b71c1c, 0), linewidth=2)
plot(Display_Base ? Avg : na,   title="Average",        color=color.new(#42a5f5, 0), linewidth=2)