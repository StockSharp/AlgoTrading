//@version=5
strategy("Touch Previous Candle Strategy", overlay=true, default_qty_type=strategy.percent_of_equity, default_qty_value=100)

// Define previous candle values
prevClose = ta.valuewhen(bar_index > bar_index[1], close[1], 0)
prevHigh = ta.valuewhen(bar_index > bar_index[1], high[1], 0)

// Define buy and sell conditions
buyCondition = low <= prevClose // Buy when the current candle touches the previous close
sellCondition = high >= prevHigh // Sell when the current candle touches the previous high

// Define take profit and stop loss levels
takeProfit = strategy.position_avg_price * 1.15 // 15% take profit
stopLoss = strategy.position_avg_price * 0.95  // 5% stop loss

// Execute buy order if the condition is met
if (buyCondition)
    strategy.entry("Buy", strategy.long)

// Execute sell order if the condition is met
if (sellCondition)
    strategy.close("Buy")

// Set stop loss and take profit
strategy.exit("TakeProfit", from_entry = "Buy", limit = takeProfit, stop = stopLoss)