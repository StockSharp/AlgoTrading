//@version=6
strategy("Day Trading Strategy (With Risk Management)", overlay=true, default_qty_type=strategy.percent_of_equity, default_qty_value=10)

// Inputs for EMAs
fastEMA = input.int(8, "Fast EMA")
slowEMA = input.int(21, "Slow EMA")

// Input for RSI filter
rsiLength = input.int(14, "RSI Length")
rsiOverbought = input.int(70, "RSI Overbought")
rsiOversold = input.int(30, "RSI Oversold")

// Calculate EMAs
emaFast = ta.ema(close, fastEMA)
emaSlow = ta.ema(close, slowEMA)

// Calculate RSI
rsi = ta.rsi(close, rsiLength)

// Buy and Sell signals based on EMA crossover and RSI filter
buySignal = ta.crossover(emaFast, emaSlow) and rsi < rsiOverbought
sellSignal = ta.crossunder(emaFast, emaSlow) and rsi > rsiOversold

// Plot EMAs
plot(emaFast, color=color.orange, title="Fast EMA")
plot(emaSlow, color=color.blue, title="Slow EMA")

// Plot Buy and Sell signals on chart
plotshape(buySignal, title="Buy Signal", location=location.belowbar, style=shape.labelup, text="BUY", size=size.small, color=color.green, textcolor=color.white)
plotshape(sellSignal, title="Sell Signal", location=location.abovebar, style=shape.labeldown, text="SELL", size=size.small, color=color.red, textcolor=color.white)

// Strategy entries with check to avoid multiple entries without exit
if (buySignal and strategy.position_size <= 0)
    strategy.entry("Long", strategy.long)
    strategy.exit("LongExit", "Long", stop=close * 0.99, limit=close * 1.01)

if (sellSignal and strategy.position_size >= 0)
    strategy.entry("Short", strategy.short)
    strategy.exit("ShortExit", "Short", stop=close * 1.01, limit=close * 0.99)

// Alerts for buy and sell signals
alertcondition(buySignal, title="Buy Alert", message="BUY Signal Triggered!")
alertcondition(sellSignal, title="Sell Alert", message="SELL Signal Triggered!")