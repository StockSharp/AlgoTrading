AIS2 Trading Robot


Номер выпуска: 20005
Дата  выпуска: 2009.03.25


Руководство пользователя


Содержание

1. Введение
2. Установка
3. Управление
4. Свойства
5. Заключение
Приложение 1
Приложение 2
Приложение 3


1. Введение

1.1. AIS2 Trading Robot представляет собой MQL4 программу для терминала MetaTrader 4.
1.2. Основные свойства:
     1.2.1. автоматическая торговля;
     1.2.2. автоматическое управление рисками;
     1.2.3. возможность изменения настроек без переинициализации;
     1.2.4. функция мониторинга.
1.3. Правильная работа AIS2 Trading Robot достигается при соблюдении следующих условий:
     1.3.1. в одном терминале допускается работа только одного экземпляра AIS2 Trading Robot;
     1.3.2. в терминале должны отсутствовать программы, способные удалять чужие глобальные переменные;
     1.3.3. на рабочем графике должны отсутствовать индикаторы, способные удалять чужие графические объекты.
1.4. AIS2 Trading Robot и AIS1 Trading Robot используют одну и ту же торговую стратегию.
1.5. AIS2 Trading Robot настроен на внутридневную торговлю и требует постоянной оптимизации параметров.


2. Установка

2.1. AIS2 Trading Robot это:
     2.1.1. "AIS2TR.MQ4" - файл с MQL4 кодом;
     2.1.2. "AIS2TR.EX4" - исполняемый файл.
2.2. Скачайте файл "AIS2TR.MQ4".
2.3. Найдите папку терминала MetaTrader 4, далее называемую "%MT4%".
2.4. В большинстве случаев терминал MetaTrader 4 находится в папке "C:/Program Files/MetaTrader 4".
2.5. Переместите файл "AIS2TR.MQ4" в папку "%MT4%/experts".
2.6. Запустите терминал MetaTrader 4, далее называемый "MetaTrader".
2.7. Нажмите <F4> для запуска MetaEditor.
2.8. В MetaEditor нажмите <Ctrl-O> для вызова окна "Открыть".
2.9. Откройте файл "AIS2TR.MQ4" в папке "%MT4%/experts".
2.10. Проверьте в строке 7 номер модификации.
2.11. Проверьте в строке 8 дату выпуска.
2.12. Нажмите <F5> для компиляции кода.
2.13. Нажмите <F4> для возврата в MetaTrader.
2.14. В MetaTrader нажмите <Ctrl-O> для вызова окна "Настройки".
2.15. На вкладке "Советника" окна "Настройки":
      2.15.1. поставьте галочку "Включить советники"="+";
      2.15.2. "Отключить советники при смене счета" оставьте без изменений;
      2.15.3. "Отключить советники при смене счета" оставьте без изменений;
      2.15.4. поставьте галочку "Разрешить советнику торговать"="+";
      2.15.5. снимите галочку с "Ручное подтверждение";
      2.15.6. остальные настройки оставьте без изменений.
2.16. Нажмите кнопку [OK] окна "Настройки".
2.17. Нажмите <Ctrl-N> для вызова окна "Навигатор".
2.18. Перейдите на вкладку "Общие" окна "Навигатор".
2.19. Откройте список "Советники".
2.20. Найдите "AIS2TR".
2.21. "AIS2TR" - это сокращенное имя исполняемого файла "AIS2TR.EX4".
2.22. Наложите ярлык "AIS2TR" на график "EURUSD".
2.23. Появится окно "AIS2TR" с вкладками "Общие" и "Входные параметры".
2.24. На вкладке "Общие" окна "AIS2TR":
      2.24.1. в группе "Общие":
              2.24.1.1. выберите "позиции"="Long & Short",
              2.24.1.1. остальные настройки оставьте без изменений;
      2.24.2. в группе "Автоматическая торговля":
              2.24.2.1. поставьте галочку "Разрешить советнику торговать"="+",
              2.24.2.2. снимите галочку с "Ручное подтверждение";
      2.24.3. в группе "Безопасность" оставьте все без изменений.
2.25. На вкладке "Входные параметры" окна "AIS2TR":
      2.25.1. проверьте, что значение переменной "aes.Symbol" совпадает с символом графика;
      2.25.2. проверьте значения других переменных.
2.26. Нажмите кнопку [OK] окна "AIS2TR".
2.27. В правом верхнем углу экрана появится улыбающийся значок "AIS2TR".
2.28. AIS2 Trading Robot работает.
2.29. Установка завершена.


3. Управление

3.1. Нажмите <F3> для вызова окна "Глобальные переменные".
3.2. В окне появятся 14	 элементов управления:
     3.2.1. "AIS20005.Setup.1.1.AccountReserve" управляет размером резерва депозита;
     3.2.2. "AIS20005.Setup.1.2.OrderReserve" управляет размером резерва на сделку;
     3.2.3. "AIS20005.Setup.2.1.Trading" разрешает и запрещает автоматическую торговлю:
             3.2.3.1. значение "1" разрешает автоматическую торговлю,
             3.2.3.2. значение "0" запрещает автоматическую торговлю;
     3.2.4. "AIS20005.Setup.2.2.Timeframe.1" управляет параметром торговой стратегии "Timeframe.1";
     3.2.5. "AIS20005.Setup.2.3.Timeframe.2" управляет параметром торговой стратегии "Timeframe.2";
     3.2.6. "AIS20005.Setup.2.4.TakeFactor" управляет параметром торговой стратегии "TakeFactor";
     3.2.7. "AIS20005.Setup.2.5.StopFactor" управляет параметром торговой стратегии "StopFactor;
     3.2.8. "AIS20005.Setup.2.6.TrailFactor" управляет параметром торговой стратегии "TrailFactor";
     3.2.9. "AIS20005.Setup.3.1.Monitor" разрешает и запрещает Функцию мониторинга;
             3.2.7.1. значение "1" разрешает Функцию мониторинга,
             3.2.7.2. значение "0" запрещает Функцию мониторинга;
     3.2.10. "AIS20005.Setup.3.2.FontSize" управляет размером шрифта панели мониторинга;
     3.2.11. "AIS20005.Setup.3.3.FontColor" управляет цветом шрифта панели мониторинга;
     3.2.12. "AIS20005.Setup.3.4.LineSpace" управляет межстрочным интервалом панели мониторинга;
     3.2.13. "AIS20005.Setup.3.5.PositionX" управляет положением панели мониторинга по горизонтали;
     3.2.14. "AIS20005.Setup.3.6.PositionY" управляет положением панели мониторинга по вертикали.


4. Свойства

4.1. Автоматическая торговля:
     4.1.1. автоматическая торговля ведется только по одному заданному торговому символу;
     4.1.2. рабочий торговый символ задается на вкладке "Входные параметры" окна "AIS2TR";
     4.1.3. AIS2 Trading Robot работает только с одним ордером;
     4.1.4. опознавательный номер ордера совпадает с номером модификации AIS2 Trading Robot;
     4.1.5. наличие на счете других ордеров с другими опознавательными номерами допускается.
4.2. Автоматическое управление рисками:
     4.2.1. автоматическое управление рисками защищает капитал инвестора от возможных потерь;
     4.2.2. настройка управления рисками заключается в определении значений набора двух следующих переменных:
            4.2.2.1. "aed.AccountReserve" - размер резерва депозита, строка 36 файла "AIS2TR.MQ4";
            4.2.2.1. "aed.OrderReserve"   - размер резерва на сделку, строка 37 файла "AIS2TR.MQ4";
     4.2.3. изменение настроек управления рисками производится тремя способами:
            4.2.3.1. на вкладке "Входные параметры" окна "AIS2TR" при первом запуске AIS2 Trading Robot,
            4.2.3.2. на той же вкладке при нажатии <F7> с последующей переинициализацией,
            4.2.3.3. посредством элементов управления из окна "Глобальные переменные" без переинициализации;
     4.2.4. переменная "aed.AccountReserve" означает размер резерва депозита на возможные потери;
     4.2.5. переменная "aed.AccountReserve" определяет предел снижения депозита "Relative drawdon";
     4.2.6. резерв депозита служит защитой капитала инвестора от рыночных рисков;
     4.2.7. переменная "aed.OrderReserve" означает размер резерва на возможные потери, выделяемого на каждую сделку;
     4.2.8. переменная "aed.OrderReserve" ограничивает размер принимаемых рыночных рисков на сделку;
     4.2.9. резерв на сделку служит защитой резерва депозита от рыночных рисков;
     4.2.10. назначение и порядок выбора размеров вышеуказанных резервов более подробно раскрывается в Приложении 1;
     4.2.11. стандартные настройки управления рисками:
             4.2.11.1. резерв депозита 20%,
             4.2.11.2. резерв на сделку 4%.
4.3. Управление настройками торговой стратегии:
     4.3.1. настройке и управлению подлежат 5 параметров:
            4.3.1.1. "aеi.Timeframe.1" - размерность основных таймфреймов,
            4.3.1.1. "aеi.Timeframe.2" - размерность вспомогательных таймфреймов,
            4.3.1.1. "aed.TakeFactor"  - коэффициент для вычисления дистанции TakeProfit,
            4.3.1.1. "aed.StopFactor"  - коэффициент для вычисления дистанции StopLoss,
            4.3.1.1. "aed.TrailFactor" - коэффициент для вычисления дистанции трейлинг-стоп;
     4.3.2. управление настройками торговой стратегии производится тремя способами:
            4.3.2.1. на вкладке "Входные параметры" окна "AIS2TR" при первом запуске AIS2 Trading Robot,
            4.3.2.2. на той же вкладке при нажатии <F7> с последующей переинициализацией,
            4.3.2.3. посредством элементов управления из окна "Глобальные переменные" без переинициализации;
     4.3.3. значения "aеi.Timeframe.1" и "aеi.Timeframe.2" определяют размерности рабочих таймфреймов:
            4.3.3.1. 1,
            4.3.3.2. 5,
            4.3.3.3. 15,
            4.3.3.4. 30,
            4.3.3.5. 60,
            4.3.3.6. 240,
            4.3.3.7. 1440,
            4.3.3.8. 10080,
            4.3.3.9. 43200;
     4.3.4. описание торговой стратегии приведено в Приложении 2;
     4.3.5. пример подбора параметров торговой стратегии приведен в Приложении 3.
4.4. Функция мониторинга:
     4.4.1. функция мониторинга обеспечивает отображение показателей работы AIS2 Trading Robot;
     4.4.2. панель мониторинга состоит из следующих частей:
            4.4.2.1. заголовок с номером модификации AIS2 Trading Robot;
            4.4.2.2. строка сообщений AIS2 Trading Robot в строке с заголовком;
            4.4.2.3. 6 кластеров данных:
                     4.4.2.3.1. кластер "Client-Server",
                     4.4.2.3.2. кластер "Balance",
                     4.4.2.3.3. кластер "Open Position",
                     4.4.2.3.4. кластер "Leverage/Contract";
                     4.4.2.3.5. кластер "Trading Strategy Rules",
                     4.4.2.3.6. кластер "Trading Strategy Preset",
     4.4.3. данные кластера "Client-Server":
            4.4.3.1. "Client Time":
                     4.4.3.1.1. локальное время AIS2 Trading Robot,
                     4.4.3.1.2. продолжительность работы AIS2 Trading Robot после последней инициализации,
                     4.4.3.1.3. количество открытых ордеров за период работы в формате "Buy+Sell=Total",
                     4.4.3.1.4. количество трейлинг-стопов за период работы;
            4.4.3.2. "Client Name" - имя владельца счета;
            4.4.3.3. "Server Name" - название сервера, на котором открыт счет;
            4.4.3.4. "Server Time":
                     4.4.3.4.1. время сервера,
                     4.4.3.4.2. длительность ожидания последнего прихода котировок,
                     4.4.3.4.3. количество запусков главной программы AIS2 Trading Robot,
                     4.4.3.4.4. количество попыток отправки ордера,
                     4.4.3.4.5. количество попыток трейлинга;
     4.4.4. данные кластера "Balance":
            4.4.4.1. "Capital":
                     4.4.4.1.1. величина капитала в валюте депозита,
                     4.4.4.1.2. величина капитала в процентах от пиковой величины средств на счете,
                     4.4.4.1.3. чистый прирост капитала за промежуток времени после последней инициализации,
                     4.4.4.1.4. относительный прирост капитала за промежуток времени после последней инициализации;
            4.4.4.2. "Reserve" - величина резерва депозита:
                     4.4.4.2.1. в валюте депозита,
                     4.4.4.2.2. в процентах от пикового значения резерва депозита;
            4.4.4.3. "Peak Equity" - пиковая величина средств на счете:
                     4.4.4.3.1. в валюте депозита,
                     4.4.4.3.2. всегда 100%,
                     4.4.4.3.3. интервал времени после последнего изменения пиковой величины средств на счете;
            4.4.4.4. "Drawdown" - текущее снижение средств на счете от пиковой величины средств на счете:
                     4.4.4.4.1. в валюте депозита,
                     4.4.4.4.2. в процентах от пиковой величины средств на счете;
            4.4.4.5. "Account Equity" - текущее значение суммы средств на счете:
                     4.4.4.5.1. в валюте депозита,
                     4.4.4.5.2. в процентах от пиковой величины средств на счете,
                     4.4.4.5.3. чистый прирост средств на счете за промежуток времени после последней инициализации,
                     4.4.4.5.4. относительный прирост средств на счете за промежуток времени после последней инициализации;
            4.4.4.6. "Free margin" - сведения о состоянии свободных средств:
                     4.4.4.6.1. текущее значение свободных от залога средств,
                     4.4.4.6.2. текущий уровень залога,
                     4.4.4.6.3. уровень "Stop Out" в денежных единицах,
                     4.4.4.6.4. уровень "Stop Out" в относительных единицах;
     4.4.5. данные кластера "Open Position":
            4.4.5.1. "Order" - данные об открытой позиции:
                     4.4.5.1.1. опознавательный номер ордера "magic number",
                     4.4.5.1.2. номер тикета,
                     4.4.5.1.3. тип ордера,
                     4.4.5.1.4. размер позиции в лотах,
                     4.4.5.1.5. стандартный размер лота,
                     4.4.5.1.6. размер залога в пунктах,
                     4.4.5.1.7	цена одного пункта котировки;
            4.4.5.2. "Profit":
                     4.4.5.2.1. прибыль в валюте депозита/пунктах,
                     4.4.5.2.2. интервал времени после открытия ордера;
            4.4.5.3. "Target" - дистанция от цены открытия до цены TakeProfit в валюте депозита/пунктах;
            4.4.5.4. "VAR"    - дистанция от цены открытия до цены StopLoss в валюте депозита/пунктах;
            4.4.5.5. "Limit"  - текущая величина резерва на сделку:
                     4.4.5.5.1. в валюте депозита,
                     4.4.5.5.2. в процентах от пиковой величины средств на счете;
     4.4.6. данные кластерa "Leverage/Contract":
            4.4.6.1. первая строка "Leverage":
                     4.4.6.1.1. размер кредитного плеча,
                     4.4.6.1.2. размер залога для стандартого контракта размером 1 лот,
                     4.4.6.1.3. размер залога в пунктах,
                     4.4.6.1.4. цена одного пункта для стандартого контракта размером 1 лот;
            4.4.6.2. вторая строка "Contract":
                     4.4.6.2.1. стандартный размер лота,
                     4.4.6.2.2. минимальный размер контракта в лотах,
                     4.4.6.2.3. шак размера контракта в лотах,
                     4.4.6.2.4. максимальный размер контракта в лотах;
     4.4.7. данные кластера "Trading Strategy Rules", см. Приложение 2:
            4.4.7.1. строка "Buy":
                     4.4.7.1.1. цена "Ask",
                     4.4.7.1.2. цена "ald.High.1 + avd.QuoteSpread",
                     4.4.7.1.3. цена "ald.Close.1 + avd.QuoteSpread",
                     4.4.7.1.4. цена "ald.Average.1 + avd.QuoteSpread";
            4.4.7.2. строка "Sell":
                     4.4.7.2.1. цена "Bid",
                     4.4.7.2.2. цена "ald.Low.1",
                     4.4.7.2.3. цена "ald.Close.1,
                     4.4.7.2.4. цена "ald.Average.1";
     4.4.8. данные кластерa "Trading Strategy Preset":
            4.4.8.1. первая строка числовый значений:
                     4.4.8.1.1. определитель основного рабочего таймфрейма "Index.1",
                     4.4.8.1.2. размерность основного рабочего таймфрейма,
                     4.4.8.1.3. значение параметра "aed.TakeFactor",
                     4.4.8.1.4. значение параметра "aed.StopFactor",
                     4.4.8.1.5. величина "ald.High.1 - ald.Low.1",
                     4.4.8.1.6. текущая расчетная дистанция TakeProfit,
                     4.4.8.1.7. текущая расчетная дистанция StopLoss;
            4.4.8.2. вторая строка числовый значений:
                     4.4.8.2.1. определитель вспомогательного рабочего таймфрейма "Index.2",
                     4.4.8.2.2. размерность вспомогательного рабочего таймфрейма,
                     4.4.8.2.3. значение параметра "aed.TrailFactor",
                     4.4.8.2.4. величина наименьшего шага трейлинг-стопа в единицах спреда,
                     4.4.8.2.5. величина "ald.High.2 - ald.Low.2",
                     4.4.8.2.6. текущий расчетный шаг трейлинг-стопа,
                     4.4.8.2.7. величина наименьшего шага трейлинг-стопа в пунктах.


5. Заключение

5.1. Всегда проверяйте, что Вы используете новейшую модификацию AIS2 Trading Robot.
5.2. Новейшие модификации находятся по ссылке http://codebase.mql4.com/5421.




Приложение 1. Пример переговоров с инвестором

1. Управляющий. Имеются две системы А1, А2. Вот их характеристики, вот демо-отчеты, вот отчеты реалов.
2. Инвестор. Ознакомился. Выбираю А1.
3. Управляющий. Выберите: 1) размер резерва депозита; 2) размер резерва на сделку.
4. Инвестор. Поясните.
5. Управляющий.
        5.1. Размеры резервов измеряются в процентах от размера депозита.
   5.2. Пусть Вы открываете депозит на $100000.
   5.3. Пусть Вы устанавливаете резерв депозита в размере 20%.
   5.4. Следовательно, Ваш капитал равен $80000, резерв депозита $20000.
   5.5. Пусть открыта торговая позиция.
   5.6. Пусть депозит вырос до $110000.
   5.7. Тогда Ваш капитал равен $88000, резерв депозита $22000.
   5.8. Пусть депозит снизился до $105000.
   5.9. Тогда Ваш капитал равен $88000, резерв депозита $17000.
   5.10. Пусть депозит вырос до $200000.
   5.11. Тогда Ваш капитал равен $160000, резерв депозита $40000.
   5.12. Пусть далее депозит только снижался.
   5.13. При сумме депозита $180000 Ваш капитал равен $160000, резерв депозита $20000.
   5.14. При сумме депозита $170000 Ваш капитал равен $160000, резерв депозита $10000.
   5.15. При сумме депозита $160000 Ваш капитал равен $160000, резерв депозита исчерпан, торговля остановлена.
   5.16. При остановке торговли по Вашему приказу резерв депозита восстанавливается.
   5.17. Сумма депозита при остановке становится Вашим капиталом.
   5.18. Пусть торговля остановлена при сумме депозита $170000, тогда Ваш капитал равен $170000.
   5.19. Таким образом, резерв депозита защищает Ваш капитал от возможных потерь.
   5.20. Все наши системы управляют резервами автоматически.
6. Инвестор. Понятно.
7. Управляющий.
   7.1. Резерв сделки защищает резерв депозита по вышеуказанной схеме.
   7.2. От размера резерва на сделку зависит ожидаемая продолжительность работы системы.
   7.3. Пусть Вы устанавливаете резерв на сделку 10% и резерв депозита в размере 20%.
   7.4. Тогда система А1 может выдержать последовательность примерно 2 убыточных сделок подряд.
   7.5. Из отчетов видно, что для системы А1 более длинные последовательности возникают примерно 4 раза в год.
   7.6. Пусть Вы устанавливаете резерв на сделку  5% и резерв депозита в размере 20%.
   7.7. Тогда система А1 может выдержать последовательность примерно 4 убыточных сделок подряд.
   7.8. Из отчетов видно, что для системы А1 более длинные последовательности возникают примерно 1 раз в год.
   7.9. От размера резерва сделки также зависят размеры сделок и, следовательно, суммы ожидаемых доходов от них.
   7.10. Порядок расчета размера сделки можно посмотреть здесь в строках 192-216.
8. Инвестор. Понятно. Я устанавливаю резерв депозита 20% и резерв на сделку 4%.
9. Управляющий. При данном размере резерва на сделку для системы А1 требуется депозит в размере от $50000.
10. Инвестор. Сервер *******, логин *******, пароль *******, сумма $100000, с другими условиями договора согласен.
11. Управляющий. Мастер-пароль будет изменен, Ваш инвест-пароль А1234.




Приложение 2. Торговая стратегия

1. Торговая стратегия AIS2 Trading Robot состоит из двух частей:
   1.1. принятие решения об открытии торговой позиции;
   1.2. управление рыночными рисками открытой торговой позиции способом "трейлинг-стоп".
2. При принятии решения об открытии торговой позиции используется 14 переменных:
   2.1. на входе - 10 переменных:
        2.1.1. "ald.QuoteAsk"    - текущая цена покупки Ask;
        2.1.2. "ald.QuoteBid"    - текущая цена продажи Bid;
        2.1.3. "avd.QuoteSpread" - текущий спред;
        2.1.4. "ald.Low.1"       - цена Low   таймфрейма номер 1 размерности "Timeframe.1";
        2.1.5. "ald.High.1"      - цена High  таймфрейма номер 1 размерности "Timeframe.1";
        2.1.6. "ald.Close.1"     - цена Close таймфрейма номер 1 размерности "Timeframe.1";
        2.1.7. "ald.Average.1"   - средняя цена таймфрейма номер 1 размерности "Timeframe.1";
        2.1.8. "ald.Range.1"     - дневной диапазон цен таймфрейма номер 1 размерности "Timeframe.1";
        2.1.9. "ald.QuoteTake"   - дистанция от текущей цены до ценового уровня TakeProfit;
        2.1.10. "ald.QuoteStop"  - дистанция от текущей цены до ценового уровня StopLoss;
   2.2. на выходе - 4 переменных:
        2.2.1. "ali.Command"   - вид торговой операции;
        2.2.2. "ald.Price"     - цена операции;
        2.2.3. "ald.Stop"      - ценовой уровень StopLoss;
        2.2.4. "ald.Take"      - ценовой уровень TakeProfit.
3. Правила покупки:
   3.1. цена закрытия "ald.Close.1"         больше средней цены "ald.Average.1";
   3.2. текущая цена покупки "ald.QuoteAsk" больше наибольшей цены "ald.High.1 + avd.QuoteSpread";
   3.3. при одновременном выполнении этих двух условий рассчитываются значения выходных переменных.
4. Правила продажи:
   4.1. цена закрытия "ald.Close.1"         меньше средней цены "ald.Average.1";
   4.2. текущая цена продажи "ald.QuoteBid" меньше наименьшей цены "ald.Low.1";
   4.3. при одновременном выполнении этих двух условий рассчитываются значения выходных переменных.
5. Для управления трейлинг-стопом используется 11 переменных:
   5.1. на входе - 10 переменных:
        5.1.1. "OrderType       ()" - вид открытой позиции;
        5.1.2. "OrderProfit     ()" - текущая прибыль открытой позиции;
        5.1.3. "OrderTakeProfit ()" - текущий ценовой уровень TakeProfit открытой позиции;
        5.1.4. "OrderStopLoss   ()" - текущий ценовой уровень StopLoss   открытой позиции;
        5.1.5. "ald.QuoteAsk"       - текущая цена покупки;
        5.1.6. "ald.QuoteBid"       - текущая цена продажи;
        5.1.7. "ald.QuoteStops"     - минимально допустимая дистанция до стоп-уровня;
        5.1.8. "ald.Range.2"        - диапазон цен таймфрейма номер 1 размерности "Timeframe.2";
        5.1.9. "ald.QuoteTrail"     - дистанция от текущей цены до нового ценового уровня StopLoss;
        5.1.10. "ald.TrailStep"     - минимально допустимый шаг трейлинг-стопа;
   5.2. на выходе - 1 переменная:
        5.2.1. "ald.Stop"           - новый ценовой уровень StopLoss.
6. Правила управления трейлинг-стопом:
   6.1. для открытой позиции Buy  - строки 420-430 файла "AIS2TR.MQ4";
   6.2. для открытой позиции Sell - строки 432-442 файла "AIS2TR.MQ4".
7. Сущность правил управления трейлинг-стопом:
   7.1. переменная "avd.Range.2" вычисляется как высота бара номер 1 таймфрейма размером "Timeframe.2";
   7.2. переменная "avd.QuoteTrail" вычисляется по формуле "avd.QuoteTrail = avd.Range.2 * aed.TrailFactor";
   7.3. текущая прибыль ордера сравнивается со значением "avd.QuoteTrail".
8. Попытка трейлинга производится в случае изменения значения выходной переменной "ald.Stop".




Приложение 3. Подбор параметров торговой стратегии

1. Подбор параметров торговой стратегии производитcя для каждой пары "Timeframe.1" и "Timeframe.2" отдельно.
2. Подбор параметров торговой стратегии заключается в определении лучшего набора значений трех следующих переменных:
   2.1. "aed.TakeFactor"  - коэффициент для вычисления дистанции TakeProfit;
   2.2. "aed.StopFactor"  - коэффициент для вычисления дистанции StopLoss;
   2.3. "aed.TrailFactor" - коэффициент для вычисления дистанции трейлинг-стоп.
3. Понятие "лучший" зависит от поставленных при настройке целей и используемых итоговых показателей.
4. Изложенный далее порядок настройки является одним их возможных.
5. Порядок настройки торговой стратегии:
   5.1. в окне тестера стратегий "Expert Properties/Testing" установить "Initial deposit = 100000 USD";
   5.2. увеличить размер резерва депозита установкой в строке 36 файла "AIS2TR.MQ4" "aed.AccountReserve = 0.99 ;";
   5.3. выключить трейлинг-стоп установкой в строке 49 значения "aed.TrailFactor = 0.0 ;";
   5.4. скомпилировать код;
   5.5. произвести одновременную оптимизацию значений переменных "aed.TakeFactor" и "aed.StopFactor";
   5.6. присвоить переменным "aed.TakeFactor" и "aed.StopFactor" выбранные значения;
   5.7. скомпилировать код;
   5.8. произвести оптимизацию значения переменной "aed.TrailFactor";
   5.9. присвоить переменной "aed.TrailFactor" выбранное значение;
   5.10. восстановить в строке 36 размер резерва депозита "double aed.AccountReserve = 0.20 ;";
   5.11. скомпилировать код.
6. Следует помнить, что смена значений параметров требует сброса настроек в окне "Входные параметры" тестера стратегий.
7. Настройка торговой стратегии завершена.
