# BITEX.ONE 做市策略

## 概述
**BitexOneMarketMakerStrategy** 是 MetaTrader 5 专家顾问 “BITEX.ONE MarketMaker” 的转换版本。策略会围绕参考价格维护对称的限价单阶梯，并根据目标头寸自动调节库存，使净头寸保持在预设值附近，适用于依赖点差与返佣收益的高频做市场景。

## 交易逻辑
1. 从交易标的或可选的领先标的中，根据所选盘口方向（买一、卖一或中间价）获取领先价格。
2. 使用 `PriceShift`（水平偏移系数）和 `VerticalShift`（垂直偏移系数）计算每个报价层级的目标价格。
3. 结合 `MaxVolumePerLevel`、当前 `Position` 与目标 `DesiredPosition` 计算每个层级需要挂出的量。
4. 针对每个层级提交或更新买入/卖出限价单，自动遵守品种的最小变动价位与最小交易量。
5. 持续监控盘口及订单状态变化，当价格或数量偏离目标超过半个最小步长时，即刻取消并重新挂单。
6. 如果剩余可用量小于最小成交量，策略会跳过该层级，等待库存恢复后再补挂。

## 参数说明
- **MaxVolumePerLevel**：每个报价层级允许的最大交易量，同时决定可在两侧分配的库存范围。
- **PriceShift**：相对于领先价格的水平偏移系数，例如 `0.001` 表示偏移 0.1%。
- **VerticalShift**：对领先价格的额外乘数，可整体上移或下移买卖报价。
- **LevelCount**：每一侧维护的报价层级数量。
- **DesiredPosition**：目标库存，正值偏向多头，负值偏向空头。
- **LeadSecurityId**：可选的领先标的代码，可用于引用指数价、标记价等。留空表示直接使用交易标的。
- **LeadPriceSide**：领先价格来源的盘口方向，可选 `Bid`、`Ask` 或 `Midpoint`。

## 数据订阅
策略默认订阅交易标的的委托簿数据。如果提供了 `LeadSecurityId`，还会额外订阅领先标的的盘口，用于获得领先价格。两种数据流都是报价计算所必需的。

## 订单管理
- 使用 `BuyLimit` 与 `SellLimit` 提交限价单。
- 当订单的价格或数量偏离目标阈值时，立即取消并在下一个周期重新挂单。
- 当订单成交、取消或被拒绝时，会立刻从内部管理列表中移除。

## 使用建议
- 确保标的提供完整的二级盘口数据以及正确的最小价位/交易量信息。
- 在连接建立并开始接收数据后再启动策略，以避免订阅失败。
- 依据风险限制与库存需求合理配置 `MaxVolumePerLevel` 和 `LevelCount`。
- 策略启动时会调用平台的保护模块，如需额外风险控制可自行添加止损或对冲逻辑。

