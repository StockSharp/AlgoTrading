# Стратегия Exp Cronex AO

Стратегия переносит советник MetaTrader **Exp_CronexAO** на высокоуровневый API StockSharp. Оригинальный робот торгует пересечения между двумя линиями индикатора Cronex Awesome Oscillator (AO). Версия для StockSharp подписывается на настраиваемую серию свечей, рассчитывает AO, дважды сглаживает его скользящими средними, чтобы восстановить линии Cronex, и открывает либо закрывает позиции при пересечении быстрой и медленной линий.

## Логика работы

1. Рассчитать Awesome Oscillator по выбранным свечам.
2. Выполнить двойное сглаживание простыми скользящими средними: первое сглаживание формирует «быструю» линию Cronex, второе — сигнальную линию.
3. Проанализировать `SignalBar` завершённых свечей назад и сравнить значения обеих линий на этой свече и на предыдущей.
4. **Покупка** выполняется, когда быстрая линия находится выше медленной и сделала восходящее пересечение на анализируемой свече. Стратегия по необходимости закрывает короткую позицию и, если разрешено, открывает длинную рыночную сделку.
5. **Продажа** происходит при зеркальных условиях: быстрая линия должна быть ниже медленной и пересечь её вниз на указанной свече. В этом случае стратегия может закрыть длинную позицию и, при разрешении, открыть короткую.
6. При каждом входе рассчитываются уровни стоп-лосса и тейк-профита в пунктах инструмента и привязываются к итоговой позиции.

Стратегия поддерживает только одну чистую позицию. При смене направления объём заявки объединяет количество, необходимое для закрытия противоположной позиции, и объём нового входа — аналогично поведению неттингового счёта MT5.

## Параметры

| Параметр | Описание |
|----------|----------|
| `CandleType` | Тип свечей для расчёта Cronex AO. По умолчанию используется таймфрейм 8 часов. |
| `FastPeriod` | Длина первого сглаживания Awesome Oscillator. |
| `SlowPeriod` | Длина второго сглаживания быстрой линии. |
| `SignalBar` | Количество завершённых свечей назад, на которых должен произойти сигнал пересечения. Дополнительно проверяется следующая свеча для подтверждения. |
| `BuyOpenEnabled` / `SellOpenEnabled` | Разрешение на открытие длинных или коротких позиций. |
| `BuyCloseEnabled` / `SellCloseEnabled` | Разрешение закрывать позиции при появлении противоположного сигнала. |
| `TakeProfit` | Уровень тейк-профита в пунктах, устанавливается после каждого входа, если больше нуля. |
| `StopLoss` | Уровень стоп-лосса в пунктах, устанавливается после каждого входа, если больше нуля. |

## Управление рисками

Стоп-лосс и тейк-профит повторяют точечные настройки MetaTrader. После каждого входа значения пересчитываются, чтобы защитные ордера соответствовали текущему размеру чистой позиции.

## Отличия от версии MetaTrader

- В реализации StockSharp оба этапа сглаживания Cronex выполняются простыми скользящими средними. В оригинальном классе XMA доступно больше методов, однако настройка по умолчанию соответствует здесь реализованной SMA.
- Не перенесены функции управления капиталом и проскальзыванием из библиотеки `TradeAlgorithms`. Размер позиции задаётся стандартным свойством `Volume`.
- Сделки выполняются в режиме неттинга StockSharp. При развороте направления отправляется единый рыночный ордер, который одновременно закрывает старую позицию и открывает новую, что соответствует логике MT5.

