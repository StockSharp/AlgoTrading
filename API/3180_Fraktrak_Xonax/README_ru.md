# Fraktrak XonaX Advanced Strategy

## Общее описание

Стратегия представляет собой перенос советника MetaTrader 5 **Fraktrak xonax.mq5** в среду StockSharp. Алгоритм отслеживает фракталы Билла Вильямса и открывает сделки при пробое последнего актуального уровня. При конвертации сохранены ключевые элементы оригинала: работа по свечам, гибкое управление позицией, а также режим реверса и закрытие встречных сделок.

## Логика торговли

1. **Определение фракталов.** Поддерживается окно из пяти свечей. Если средняя свеча имеет максимум выше соседних максимумов (или минимум ниже соседних минимумов), фиксируется новый верхний или нижний фрактал.
2. **Сигналы на вход.** После закрытия свечи проверяется пробой текущего фрактала:
   - Пробой верхнего фрактала → открытие покупки (или продажи при активном *Reverse Mode*).
   - Пробой нижнего фрактала → открытие продажи (или покупки при активном *Reverse Mode*).
3. **Сопровождение позиции.**
   - По желанию закрывается противоположная позиция перед входом в новую сделку.
   - Устанавливаются стартовые уровни стоп-лосса и тейк-профита в пипсах.
   - Трейлинг-стоп с шагом смещения двигает стоп после прохождения дополнительного расстояния.
4. **Управление капиталом.** Можно использовать фиксированный объем или процент риска от капитала. В режиме риска расчет объема учитывает стоимость шага цены и заданную дистанцию стоп-лосса.

## Параметры

| Параметр | Описание |
|----------|----------|
| `StopLossPips` | Дистанция стоп-лосса в пипсах. Ноль отключает защитный стоп. |
| `TakeProfitPips` | Дистанция тейк-профита в пипсах. Ноль отключает цель по прибыли. |
| `TrailingStopPips` | Базовая дистанция трейлинг-стопа (требуется положительный `TrailingStepPips`). |
| `TrailingStepPips` | Минимальное дополнительное движение цены для переноса трейлинг-стопа. |
| `ReverseMode` | Инверсия сигналов пробоя (продажа верхних и покупка нижних фракталов). |
| `CloseOpposite` | Закрывать противоположные позиции перед входом. |
| `ManagementMode` | Режим управления капиталом: `FixedLot` или `RiskPercent`. |
| `ManagementValue` | Значение параметра выбранного режима (лот или процент риска). |
| `CandleType` | Тип свечей, используемый для анализа и торговли. |

## Рекомендации по применению

- Размер пипса рассчитывается автоматически по шагу цены инструмента. Для инструментов с тремя или пятью знаками учитывается дробный пип (0.1 пипса).
- Трейлинг-стоп активируется только если оба параметра `TrailingStopPips` и `TrailingStepPips` больше нуля.
- При расчете объема в режиме риска используется стоимость шага цены. При отсутствии данных применяется запасной вариант на основе простой ценовой дистанции.
- Для имитации оригинального советника включите `CloseOpposite`, чтобы новые сигналы закрывали существующие позиции перед разворотом.

## Файлы

- `CS/FraktrakXonaxAdvancedStrategy.cs` — реализация стратегии.
- `README.md` — описание на английском языке.
- `README_ru.md` — данное описание на русском языке.
- `README_cn.md` — описание на китайском языке.
