# 突破波动率策略
[English](README.md) | [Русский](README_ru.md)

突破波动率策略专注于寻找蜡烛内部短暂的波动放大。当当前蜡烛的振幅比上一根更大，但仅比上一根高出两个经小数位调整后的点值时视为有效突破。如果蜡烛收盘价高于开盘价则做多，收盘价低于开盘价则做空。策略通过固定止损与止盈、可选的移动止损以及在亏损后自动反向开仓来管理风险与回撤。

## 交易逻辑

1. **振幅扩张过滤**
   - 计算当前蜡烛的振幅并与上一根蜡烛比较。
   - 要求当前振幅更大，但不能超过上一根振幅加上两个标准化点值。
   - 该条件意味着波动正在放大但仍受控制，适合捕捉刚刚起步的突破。
2. **方向选择**
   - 蜡烛收阳则开多单。
   - 蜡烛收阴则开空单。
   - `OnlyOnePositionPerBar` 参数可阻止在同一根蜡烛内重复入场。
3. **持仓管理**
   - 按点值设置固定止损和止盈距离。
   - 若启用移动止损，在价格向有利方向移动指定距离后上调保护价位，并根据 `TrailingStepPoints` 避免频繁调整。
   - 若平仓亏损且允许反向，策略会立即按相反方向重新入场；每次反向都会额外增加止盈距离，同时设置反向次数上限防止无限加码。

## 参数

| 名称 | 说明 | 默认值 | 可优化 |
| --- | --- | --- | --- |
| `TradeVolume` | 市价单基础手数。 | `0.1` | 是 |
| `StopLossPoints` | 止损距离（点）。 | `20` | 是 |
| `TakeProfitPoints` | 止盈距离（点）。 | `10` | 是 |
| `TrailingStopPoints` | 移动止损距离（点，`0` 为禁用）。 | `25` | 否 |
| `TrailingStepPoints` | 移动止损的最小调整步长。 | `5` | 否 |
| `OnlyOnePositionPerBar` | 是否限制每根蜡烛仅一次入场。 | `true` | 否 |
| `UseAutoDigits` | 针对 3/5 位小数品种自动放大 10 倍点值。 | `true` | 否 |
| `ReverseAfterStop` | 是否在亏损后反向开仓。 | `true` | 否 |
| `MaxReverseOrders` | 连续反向开仓的最大次数。 | `2` | 否 |
| `TakeProfitIncrease` | 每次反向额外增加的止盈点数。 | `100` | 否 |
| `CandleType` | 计算使用的蜡烛类型与周期。 | `TimeSpan.FromMinutes(1)` | 否 |

## 风险控制

- 止损与止盈距离通过标的的最小价格变动重新计算，自动识别小数位以保持点值一致。
- 移动止损仅在价格达到设定增幅后启动，并遵循最小步长以避免过度调整。
- 反向序列在获利平仓或达到最大次数后归零，防止滚雪球式放大风险。

## 使用建议

- 更适合点差较低、瞬时波动明显的外汇或差价合约品种。
- 可根据交易时段调整蜡烛周期；默认的 1 分钟适用于捕捉高频突破。
- 因为反向仓位会立即在亏损后启动，请确认账户保证金能承受连续交易。
