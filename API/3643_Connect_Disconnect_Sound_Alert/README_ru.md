# Стратегия Connect Disconnect Sound Alert

## Обзор
**Connect Disconnect Sound Alert Strategy** постоянно отслеживает состояние подключения коннектора стратегии и фиксирует каждое переключение между онлайн и офлайн режимами. В оригинальном советнике MQL5 воспроизводились звуковые файлы при подключении или отключении терминала MetaTrader. В C# версии сохранена основная логика — обнаружение изменения соединения — и добавлены расширенные журналы StockSharp, которые позволяют контролировать длительность каждого состояния. Стратегия подходит в качестве легкого «сторожа», информирующего оператора о проблемах связи без выставления заявок.

## Основные возможности
- Периодический опрос состояния коннектора с настраиваемым интервалом.
- Фиксация событий подключения и отключения с подробными сообщениями в логах.
- Опциональное отображение длительности пребывания в каждом состоянии.
- Пропуск звукового уведомления при первом запуске для соответствия поведению MQL-советника.

## Параметры
| Название | Значение по умолчанию | Описание |
| -------- | --------------------- | -------- |
| `CheckIntervalSeconds` | `1` | Интервал между проверками состояния соединения в секундах. Значение должно быть больше нуля. |
| `LogDurations` | `true` | При включении в лог записывается, сколько времени соединение оставалось в предыдущем состоянии. |

Параметры созданы через `StrategyParam<T>` и могут настраиваться из пользовательского интерфейса или в оптимизаторе.

## Принцип работы
1. При старте стратегия сохраняет текущее состояние коннектора и при необходимости выводит начальное сообщение.
2. `System.Threading.Timer` с заданной периодичностью вызывает обработчик, сравнивающий новое состояние с предыдущим.
3. При изменении состояния стратегия пишет событие в журнал. Первое уведомление помечается как «initial» и не инициирует звуковой сигнал, повторяя поведение MQL-версии.
4. По желанию пользователя выводится длительность предыдущего состояния, что помогает оценить стабильность соединения.
5. Таймер автоматически останавливается при остановке или сбросе стратегии, ресурсы освобождаются корректно.

## Рекомендации по использованию
- Запускайте стратегию вместе с любым терминалом StockSharp, в котором доступен коннектор. Торговых операций она не выполняет.
- Используйте значение интервала по умолчанию для оперативного мониторинга. Увеличивайте его только при необходимости уменьшить нагрузку.
- Уведомления выводятся через `LogInfo`, поэтому настройте подходящий слушатель логов или панель мониторинга.
- Для реального звукового оповещения подключите сервис уведомлений на стороне хоста и воспроизводите звуки при получении сообщений.

## Меры предосторожности
- Проверяется корректность интервала опроса, при неверном значении выбрасывается исключение.
- Метки времени берутся из `CurrentTime`, что обеспечивает корректные значения как в онлайне, так и при прогоне истории.
- Таймер уничтожается при остановке и сбросе стратегии, исключая «висящие» фоновые задачи.
