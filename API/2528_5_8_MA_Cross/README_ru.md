# Стратегия пересечения скользящих 5/8

## Общее описание
Стратегия «5/8 MA Cross» — это порт эксперта MetaTrader "5_8 MACross" на платформу StockSharp. Она сопоставляет быстрый экспоненциальный скользящий средний (EMA), рассчитанный по ценам закрытия, с более медленным EMA, построенным по ценам открытия. Сделки совершаются при пересечении этих средних, поэтому алгоритм подходит для любого инструмента и таймфрейма с классическими свечами.

## Индикаторы
- **Быстрый EMA** — настраиваемая длина (по умолчанию 5) и расчёт по ценам закрытия свечи.
- **Медленный EMA** — настраиваемая длина (по умолчанию 8) и расчёт по ценам открытия свечи.

## Логика торговли
1. Обрабатываются только полностью сформированные свечи, что исключает эффект перерисовки.
2. Сигнал на покупку появляется, когда быстрый EMA на предыдущей свече находился ниже либо равен медленному и на текущей свече пересекает его снизу вверх.
3. Сигнал на продажу возникает, когда быстрый EMA на предыдущей свече был выше либо равен медленному и на текущей свече пересекает его сверху вниз.
4. При появлении сигнала стратегия разворачивает позицию: закрывает текущий объём и отправляет рыночный ордер на `Volume` контрактов в новую сторону.

## Управление рисками
- **Тейк-профит** — необязательная цель в ценовых пунктах. Размер пункта определяется из минимального шага цены инструмента; для трёх- и пятизначных котировок автоматически применяется множитель 10, как в оригинальном советнике MetaTrader.
- **Стоп-лосс** — опциональная защита, выраженная в пунктах от цены входа. Значение 0 отключает стоп.
- **Трейлинг-стоп** — опциональное расстояние в пунктах. После открытия позиции стратегия отслеживает максимум (для лонга) или минимум (для шорта) и передвигает стоп только в прибыльную сторону. Если базовый стоп-лосс не задан, трейлинг всё равно активируется сразу после входа.
- При достижении уровня тейк-профита или (трейлинг-)стопа по цене закрытия позиция закрывается рыночным ордером.

## Параметры
| Параметр | Описание | Значение по умолчанию |
| --- | --- | --- |
| `FastLength` | Период быстрого EMA (по закрытию). | 5 |
| `SlowLength` | Период медленного EMA (по открытию). | 8 |
| `TakeProfitPoints` | Расстояние до тейк-профита в пунктах. | 40 |
| `StopLossPoints` | Расстояние до стоп-лосса в пунктах (0 — отключён). | 0 |
| `TrailingStopPoints` | Дистанция трейлинг-стопа в пунктах (0 — отключён). | 0 |
| `CandleType` | Тип/таймфрейм свечей для расчёта. | Свечи 1 минута |
| `Volume` | Объём заявки из базового класса `Strategy`. | 0.1 |

## Отличия от версии на MQL
- Проверки режима хеджирования и обращения к данным счёта не используются: StockSharp имеет собственную модель учёта позиций.
- Сигналы оцениваются на закрытых свечах, тогда как оригинал срабатывал на первом тике новой свечи, что повышает стабильность в событийной среде.
- Для продвижения трейлинг-стопа применяются максимум/минимум свечи, а не текущие bid/ask, что делает поведение детерминированным в истории.

## Рекомендации по использованию
- Установите параметр `Volume` в соответствии с требуемым торговым объёмом.
- При необходимости подключайте дополнительные защитные механизмы StockSharp или фильтры для портфельного контроля риска.
- Стратегия работает только с рыночными ордерами; лимитные заявки не выставляются, все действия определяются логикой пересечения EMA и блоком управления рисками.
