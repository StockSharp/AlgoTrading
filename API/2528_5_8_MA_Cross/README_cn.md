# 5/8 均线交叉策略

## 概述
5/8 均线交叉策略是 MetaTrader 专家顾问「5_8 MACross」在 StockSharp 平台上的移植版本。策略比较基于收盘价的快速指数移动平均线（EMA）与基于开盘价的慢速 EMA，当两条均线发生交叉时采取操作，适用于所有提供标准时间周期 K 线的数据。

## 指标
- **快速 EMA** —— 可配置周期（默认 5），使用 K 线收盘价计算。
- **慢速 EMA** —— 可配置周期（默认 8），使用 K 线开盘价计算。

## 交易逻辑
1. 策略仅处理已经收盘的 K 线，以避免未完成数据导致的重绘。
2. 当上一根 K 线中快速 EMA 位于慢速 EMA 之下或相等，而当前 K 线快速 EMA 向上穿越慢速 EMA 时，生成做多信号。
3. 当上一根 K 线中快速 EMA 位于慢速 EMA 之上或相等，而当前 K 线快速 EMA 向下跌破慢速 EMA 时，生成做空信号。
4. 出现信号时策略会反向持仓：先平掉当前仓位，再以设定的 `Volume` 数量在新方向上发送市价单。

## 风险管理
- **止盈** —— 以价格点数为单位的可选目标。点值根据标的的最小价格变动自动计算，对于三位和五位报价会额外乘以 10，以模拟 MetaTrader 对“点/点差”的处理方式。
- **止损** —— 可选的保护性止损，同样以距离开仓价的点数表示，0 表示不启用。
- **移动止损** —— 以点数表示的可选距离。开仓后策略会跟踪多头情况下的最高价或空头情况下的最低价，只在有利方向移动止损。如果未设置初始止损，移动止损也会在建仓后立即提供保护。
- 当收盘价触及止盈或（移动）止损水平时，策略以市价立即平仓。

## 参数
| 名称 | 说明 | 默认值 |
| --- | --- | --- |
| `FastLength` | 快速 EMA（收盘价）的周期。 | 5 |
| `SlowLength` | 慢速 EMA（开盘价）的周期。 | 8 |
| `TakeProfitPoints` | 止盈距离（点数）。 | 40 |
| `StopLossPoints` | 止损距离（点数，0 表示关闭）。 | 0 |
| `TrailingStopPoints` | 移动止损距离（点数，0 表示关闭）。 | 0 |
| `CandleType` | 用于计算的 K 线类型/周期。 | 1 分钟 K 线 |
| `Volume` | 来自基础 `Strategy` 类的下单手数。 | 0.1 |

## 与 MQL 版本的差异
- 省略了 MetaTrader 特有的对冲账户检查和账户信息调用，StockSharp 在持仓处理上采用不同机制。
- 在本移植中，信号基于完全收盘的 K 线计算，而原始脚本在新 K 线的首个报价上触发，这样做能提升事件驱动环境下的稳定性。
- 移动止损使用 K 线的最高价/最低价推进，而不是即时买卖价，从而在历史回测中保持确定性。

## 使用说明
- 在策略属性中设置 `Volume`，以匹配所需的下单手数。
- 如需账户层面的风险控制，可结合 StockSharp 的保护模块或额外的过滤策略。
- 策略仅使用市价单，不挂出任何挂单；所有进出场都由均线交叉和风控逻辑驱动。
