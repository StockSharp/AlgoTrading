# Стратегия Market Predictor

## Обзор
Стратегия Market Predictor представляет собой адаптацию советника MarketPredictor из MetaTrader для платформы StockSharp. Логика ориентирована на постоянную переоценку ожидаемого движения цены через Монте-Карло прогноз и адаптивные статистические параметры, собранные по последним свечам. Подписка оформляется на свечи выбранного таймфрейма, а обработка выполняется только для завершённых баров.

## Основные идеи
- **Адаптивное среднее (`mu`):** Значение поддерживается с помощью простой скользящей средней, что соответствует шагу оптимизации параметров из оригинального советника.
- **Амплитуда по волатильности:** Показатель ATR управляет коэффициентом амплитуды (`alpha`), позволяя стратегии реагировать на всплески волатильности.
- **Прогноз Монте-Карло:** После закрытия каждой свечи стратегия выполняет заданное количество случайных симуляций, чтобы оценить ожидаемую цену (`P_t1`).
- **Направленное решение:** Рыночные приказы отправляются, когда прогноз отличается от цены закрытия более чем на порог `sigma`. Позиция переворачивается только после полной фиксации предыдущего направления.

## Торговые правила
1. Дождаться завершения свечи и убедиться, что индикаторы сформированы.
2. Обновить `mu` по значению SMA и `alpha` по ATR.
3. Выполнить Монте-Карло симуляции вокруг текущей цены закрытия.
4. Если средняя смоделированная цена превышает `Close + sigma`, открыть длинную позицию рыночным ордером при отсутствии позиции.
5. Если средняя смоделированная цена ниже `Close - sigma`, открыть короткую позицию рыночным ордером при отсутствии позиции.
6. Удерживать позицию до появления противоположного сигнала.

## Параметры
- **InitialAlpha** – Базовая амплитуда, применяемая до формирования ATR.
- **InitialBeta** – Сохранённый коэффициент из оригинального советника (в расчётах не используется, но задокументирован).
- **InitialGamma** – Сохранённый демпфирующий коэффициент (не используется напрямую).
- **Kappa** – Параметр чувствительности гипотетической сигмоидальной компоненты, сохранён для потенциальных расширений.
- **InitialMu** – Исходное среднее значение до формирования SMA.
- **Sigma** – Порог отклонения прогноза от текущей цены для генерации сигналов.
- **MonteCarloSimulations** – Количество симуляций для оценки следующей цены.
- **CandleType** – Таймфрейм свечной серии.

## Примечания
- Используется высокоуровневый API StockSharp с привязкой индикаторов и рыночными ордерами.
- Комментарии в коде даны на английском языке.
- Python-версия и соответствующая папка намеренно не создавались.
