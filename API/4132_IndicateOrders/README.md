# Indicate Orders Strategy

## Overview
The Indicate Orders strategy is a StockSharp conversion of the MetaTrader indicator *q_indicate_orders*. The original MQL script
rendered text labels on the chart summarising how many buy and sell tickets were currently open, their combined volume and the
floating profit of each ticket. The StockSharp version delivers the same information as structured log entries so it can be used
inside the terminal, strategy visualiser or backtesting reports.

The strategy does not place any trades by itself. Instead, it observes the trades generated by the hosting strategy (or by
manual order entry when the strategy is attached to a portfolio) and rebuilds two internal lists: one for active long tickets and
another for active short tickets. Whenever a trade is executed or a new reference price becomes available, the lists are used to
produce an aggregated snapshot that mirrors the text layout of the original indicator.

## Event processing pipeline
1. **Startup** – the strategy clears any cached state and immediately prints the initial message "No open orders." so the operator
   knows the tracker is running.
2. **Price updates** – the `PriceDataType` subscription delivers closed candles. The strategy stores the candle close as the latest
   reference price used to calculate floating profit for every open ticket.
3. **Trade handling** – `OnNewMyTrade` receives fills produced by the hosting strategy. Buy trades reduce any outstanding short
   exposure before creating a new long ticket, while sell trades reduce long exposure before creating a new short ticket. This
   reproduces how the original indicator displayed hedged positions while respecting StockSharp's netting behaviour.
4. **Summary logging** – after each state change the strategy rebuilds the log message. Buy and sell sections contain a header line
   with total ticket count, combined volume and floating profit followed by one line per ticket (up to `MaxOrdersToShow`). If nothing
   is open, the message falls back to "No open orders.". Duplicate summaries are suppressed to avoid log spam.

## Parameters
| Name | Type | Default | Description |
| --- | --- | --- | --- |
| `MaxOrdersToShow` | `int` | `25` | Maximum number of ticket detail lines printed per side. Remaining tickets are summarised as `... N more`. |
| `PriceDataType` | `DataType` | 1-minute time frame | Candle or other market-data subscription used to obtain the latest reference price for floating profit calculations. |

## Log format
Each snapshot reproduces the MetaTrader indicator layout using plain text:

```
BUYS | <count> | <total volume> | <floating PnL>
#<order id>: <volume> @ <entry price> | <entry time> | <floating PnL>
...
SELLS | <count> | <total volume> | <floating PnL>
#<order id>: <volume> @ <entry price> | <entry time> | <floating PnL>
```

- Floating profit is shown with a leading `+` when positive. When no price data has been received yet the field displays `N/A`.
- Entry times are converted to the local time zone for readability.
- When the number of open tickets exceeds `MaxOrdersToShow`, the remaining count is displayed as the final line `... N more`.

## Differences from the original MetaTrader indicator
- MetaTrader draws on-chart labels; the StockSharp port writes to the strategy log so the information becomes available in automated
  workflows and during backtests.
- The conversion assumes netting behaviour when matching opposing trades. This matches StockSharp's execution model while still
  allowing simultaneous long and short tickets through the internal queues.
- Colour settings, font sizes and label offsets from the MQL script have no equivalent in the log-based implementation and were
  therefore removed.
- Profit is recalculated from the latest candle close instead of relying on the broker-side floating profit reported by MetaTrader.

## Usage tips
- Add the tracker as a child strategy to any algorithm that actively places orders. The log will then document how exposure evolves
  over time without modifying the trading logic.
- Select a `PriceDataType` that updates frequently enough for your trading horizon. For example, scalping systems should use ticks
  or very short candles to keep the floating profit accurate.
- Increase or decrease `MaxOrdersToShow` depending on the expected number of simultaneous tickets. Larger values produce longer log
  entries but preserve more detail when grids or averaging tactics are used.

## Limitations
- The strategy only sees trades routed through the hosting `Strategy`. External manual trades that bypass StockSharp will not appear
  in the log until they generate a `MyTrade` event for this strategy.
- Floating profit is recalculated using the last candle close from `PriceDataType`; if market data is delayed or missing the log will
  display `N/A` for profit and may lag behind the actual account statement.
- The conversion does not replicate the visual customisation (fonts and colours) of the original indicator because StockSharp
  strategies focus on programmatic outputs.

## Indicators
The strategy does not employ analytical indicators. It only subscribes to a market data series defined by `PriceDataType` to obtain
prices for the floating profit calculation.
