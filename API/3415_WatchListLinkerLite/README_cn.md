# Watch List Linker Lite 策略

**Watch List Linker Lite Strategy** 是 MetaTrader 4 专家顾问 “VR Watch List and Linker Lite” 的 StockSharp 移植版本。原始 EA 在交易者把 Market Watch 窗口中的品种拖放到任意图表时被触发，随后立即把所有其他打开的图表切换到同一个品种，同时保留各自的时间周期。由于 StockSharp 无法直接控制可视化图表窗口，移植版本通过同时维护多条蜡烛图订阅来还原核心行为：为用户指定的每个时间周期创建独立的订阅，并把它们全部绑定到策略的主要证券上。策略启动时解析周期列表，创建订阅，并在日志中确认所有关联的时间周期都已跟随同一标的。

## 行为流程

1. 解析逗号分隔的 `LinkedTimeFrames` 参数。每个元素都可以使用 `00:15:00`、`15m`、`M15`、`1H` 或者纯数字（视为分钟数）等格式。无法识别的文本会通过 `LogWarning` 提示。
2. 如果没有任何有效周期，策略会自动添加 1 分钟周期并记录替换信息。
3. 对每个解析出的周期调用高级 API `SubscribeCandles` 创建订阅并立即启动，模拟 MetaTrader 中为所有图表附加新符号的过程。
4. 对每个时间周期写入日志，包含证券标识与最终解析出的周期。日志记录替代了原始 EA 中的图表重绘。

该策略不下单也不管理持仓，只维护同步的蜡烛流，非常适合在仪表盘或分析面板中让多个图表观察同一标的。

## 参数

| 名称 | 默认值 | 说明 |
| --- | --- | --- |
| `LinkedTimeFrames` | `"00:15:00,00:30:00,01:00:00"` | 需要跟随主证券的时间周期列表。支持 `hh:mm:ss`、后缀（`15m`）、前缀（`M15`）以及纯数字（分钟）等格式。 |

## 实现说明

- 采用高层的蜡烛订阅 API，而不是尝试操作底层窗口句柄，完全符合 `AGENTS.md` 中的建议。
- 周期解析由辅助方法完成，可识别多种常见写法（前缀、后缀以及 `hh:mm:ss` 格式）。不支持的条目会被跳过并记录日志，方便快速修正。
- `GetWorkingSecurities` 返回所有需要的数据类型组合，使设计器能够提前了解策略的数据需求。
- 由于无法直接切换图表窗口，策略通过日志消息和活跃订阅来驱动前端刷新，这是在 StockSharp 环境中同步多个图表的惯用方式。

## 使用步骤

1. 在启动前为策略指定 `Security`。
2. 保留默认的 `LinkedTimeFrames` 列表或自定义所需的周期，例如 `"M1,M5,H1"`。
3. 启动策略。日志窗口会显示每个周期已绑定到所选证券的提示信息。
4. 如需同步另一组图表，可调整参数后重新启动策略。

## 与 MetaTrader 版本的差异

- MetaTrader 版本会自动遍历所有打开的图表；StockSharp 版本由于无法访问窗口集合，因此改为通过 `LinkedTimeFrames` 明确配置时间周期。
- 拖放操作被常规的参数管理所取代，联动过程在 `OnStarted` 中完成，而不是响应界面事件。
- 图表重绘被日志输出和活跃数据订阅替代，它们是 StockSharp 中驱动仪表盘的标准方式。
