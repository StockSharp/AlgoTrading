# Стратегия Watch List Linker Lite

**Watch List Linker Lite Strategy** — это перенос советника MetaTrader 4 «VR Watch List and Linker Lite» на платформу StockSharp. В оригинале пользователь перетаскивает инструмент из окна Market Watch на любой график, после чего советник мгновенно переключает все остальные открытые окна на этот же символ, сохраняя их таймфреймы. В StockSharp нет прямого доступа к визуальным окнам графиков, поэтому порт воспроизводит ключевую функциональность через подписки на свечи: для каждого указанного таймфрейма создаётся отдельная подписка, привязанная к основной бумаге стратегии. При запуске стратегия разбирает список периодов, создаёт подписки и пишет в лог подтверждение, что все связанные таймфреймы следуют за одним инструментом.

## Логика работы

1. Разобрать параметр `LinkedTimeFrames`, содержащий список таймфреймов через запятую. Допустимы форматы `00:15:00`, `15m`, `M15`, `1H` и простые числа, трактуемые как количество минут. Ошибочные элементы фиксируются через `LogWarning`.
2. Если корректных значений нет, стратегия автоматически добавляет минутный график и сообщает о подстановке.
3. Для каждого распознанного таймфрейма вызывается высокоуровневый метод `SubscribeCandles`, после чего подписка запускается. Это эквивалентно «подключению» нового символа ко всем графикам в MetaTrader.
4. Для каждого таймфрейма в лог пишется сообщение с идентификатором инструмента и итоговым периодом. Эти записи заменяют визуальное обновление окон в оригинале.

Стратегия не совершает сделок и не управляет позициями. Её задача — поддерживать синхронные свечные потоки, что удобно для дашбордов с несколькими аналитическими графиками одного инструмента.

## Параметры

| Название | Значение по умолчанию | Описание |
| --- | --- | --- |
| `LinkedTimeFrames` | `"00:15:00,00:30:00,01:00:00"` | Список таймфреймов через запятую, которые должны отслеживать основную бумагу. Поддерживаются форматы `hh:mm:ss`, суффикс (`15m`), префикс (`M15`) и числа (в минутах). |

## Особенности реализации

- Используется высокоуровневое API подписки на свечи, а не низкоуровневое управление окнами. Это соответствует требованиям из `AGENTS.md`.
- Парсинг таймфреймов вынесен в вспомогательные методы, которые понимают популярные обозначения (префикс, суффикс, формат `hh:mm:ss`). Ошибочные значения игнорируются, но фиксируются в логе для быстрого исправления.
- Метод `GetWorkingSecurities` возвращает все требуемые комбинации инструмент–таймфрейм, чтобы дизайнер заранее понимал потребности стратегии в данных.
- Поскольку StockSharp не может переключать реальные окна графиков, стратегия ограничивается логами и активными подписками — это стандартный способ синхронизации визуализации в рамках платформы.

## Как использовать

1. Заранее назначьте стратегии нужный `Security`.
2. Оставьте параметр `LinkedTimeFrames` по умолчанию либо задайте собственный список, например `"M1,M5,H1"`.
3. Запустите стратегию. В логе появятся сообщения о привязке каждого таймфрейма к выбранному инструменту.
4. При необходимости обновите список таймфреймов и перезапустите стратегию, чтобы синхронизировать другую группу графиков.

## Отличия от версии MetaTrader

- В MetaTrader советник сам проходил по всем открытым графикам. В StockSharp список таймфреймов задаётся явно, потому что коллекция окон недоступна из кода стратегии.
- Drag-and-drop заменён управлением параметрами стратегии. Привязка выполняется в `OnStarted`, а не по событию пользовательского интерфейса.
- Вместо перерисовки окон стратегия формирует лог-записи и поддерживает активные подписки, что соответствует идеологии StockSharp.
