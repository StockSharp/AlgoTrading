# Стратегия прорыва канала MALR

Стратегия торгует прорывы кастомного канала MALR (Moving Average Linear Regression). Индикатор MALR комбинирует простую и линейно-взвешенную скользящие средние для формирования центральной линии. Стандартное отклонение цены относительно этой линии задаёт внешние границы канала.

Длинная позиция открывается, когда верхняя граница канала пересекает цену закрытия сверху вниз, что указывает на прорыв вверх. Короткая позиция открывается, когда нижняя граница канала пересекает цену снизу вверх, сигнализируя о прорыве вниз.

## Параметры

- `MaPeriod` – период скользящих средних и стандартного отклонения.
- `ChannelReversal` – ширина внутреннего канала MALR в стандартных отклонениях.
- `ChannelBreakout` – дополнительная ширина для внешнего канала прорыва.
- `CandleType` – тип свечей для расчётов.

## Логика работы

1. Рассчитываются SMA и LWMA цены закрытия.
2. Вычисляется линия MALR `FF = 3 * LWMA - 2 * SMA`.
3. Измеряется стандартное отклонение `close - FF` за тот же период.
4. Получаются границы прорыва: `FF ± StdDev * (ChannelReversal + ChannelBreakout)`.
5. Открытие лонга при пересечении верхней границы сверху вниз.
6. Открытие шорта при пересечении нижней границы снизу вверх.

Перед открытием новой позиции стратегия всегда закрывает противоположную.

