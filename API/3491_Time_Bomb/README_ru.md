# Стратегия Time Bomb
[English](README.md) | [中文](README_cn.md)

Time Bomb воспроизводит одноимённого советника MetaTrader, который открывает единственную сделку, когда цена резко проходит
заданное количество пунктов за короткий промежуток времени. Стратегия отслеживает лучшие цены спроса и предложения в реальном
времени и измеряет число пунктов между последней сохранённой ценой и текущей котировкой. Если нужная дистанция преодолена
достаточно быстро, стратегия отправляет рыночный ордер в сторону импульса и сразу рассчитывает скрытые уровни стоп-лосса и тейк-
профита в пунктах.

Реализация работает только при отсутствии открытых позиций, повторяя логику исходного конструктора блоков, который запрещал
перекрывающиеся сделки. Опорные цены перезаписываются сразу после появления сигнала либо когда истекает окно наблюдения, поэтому
каждый всплеск волатильности может породить не более одной сделки на сторону. Стопы и тейк-профиты ведутся внутренне и
контролируются кодом стратегии, поскольку StockSharp не создаёт защитные заявки автоматически при рыночном входе.

## Детали

- **Условия входа**:
  - **Покупка**: Лучшая цена ask выросла как минимум на `BuyPipsInTime` пунктов относительно сохранённой цены, и это произошло за
    время не больше `BuyTimeToWait` секунд. После выполнения условий отправляется ордер объёмом `BuyVolume`.
  - **Продажа**: Лучшая цена bid снизилась как минимум на `SellPipsInTime` пунктов относительно сохранённой цены, и это произошло
    за время не больше `SellTimeToWait` секунд. После выполнения условий отправляется ордер объёмом `SellVolume`.
- **Направление торговли**: Возможны длинные и короткие позиции, но одновременно разрешена только одна позиция.
- **Условия выхода**:
  - **Покупка**: Позиция закрывается, когда лучшая цена bid достигает рассчитанного стоп-лосса или тейк-профита.
  - **Продажа**: Позиция закрывается, когда лучшая цена ask достигает стоп-лосса или лучшая цена bid достигает тейк-профита.
- **Стопы**: Защитные уровни скрытые и поддерживаются внутри стратегии. Расстояния задаются в пунктах и переводятся в цены через
  текущий шаг цены инструмента.
- **Параметры по умолчанию**:
  - `SellPipsInTime` = 5 пунктов, `SellTimeToWait` = 10 секунд, `SellVolume` = 0.01 лота.
  - `SellStopLossPips` = 20 пунктов, `SellTakeProfitPips` = 20 пунктов.
  - `BuyPipsInTime` = 5 пунктов, `BuyTimeToWait` = 10 секунд, `BuyVolume` = 0.01 лота.
  - `BuyStopLossPips` = 20 пунктов, `BuyTakeProfitPips` = 20 пунктов.
- **Фильтры**:
  - Категория: Прорыв/моментум.
  - Направление: Симметричная торговля (лонг и шорт).
  - Индикаторы: Только чистое ценовое движение без осцилляторов.
  - Стопы: Да (фиксированные дистанции в пунктах для каждой стороны).
  - Сложность: Низкая — один детектор импульса и простое хранение состояний.
  - Таймфрейм: Внутридневный, реагирует на тики не реже одного раза в секунду.
  - Сезонность: Нет.
  - Нейросети: Нет.
  - Дивергенции: Нет.
  - Уровень риска: Зависит от выбранных расстояний в пунктах; значения по умолчанию соответствуют среднему риску на мажорных FX
    парах.

## Параметры

| Название | Описание |
| --- | --- |
| `SellPipsInTime` | Минимальное падение цены в пунктах перед открытием короткой позиции. |
| `SellTimeToWait` | Сколько секунд отводится на движение вниз. |
| `SellVolume` | Объём сделки при продаже. |
| `SellStopLossPips` | Стоп-лосс для коротких позиций в пунктах. |
| `SellTakeProfitPips` | Тейк-профит для коротких позиций в пунктах. |
| `BuyPipsInTime` | Минимальный подъём цены в пунктах перед открытием длинной позиции. |
| `BuyTimeToWait` | Сколько секунд отводится на движение вверх. |
| `BuyVolume` | Объём сделки при покупке. |
| `BuyStopLossPips` | Стоп-лосс для длинных позиций в пунктах. |
| `BuyTakeProfitPips` | Тейк-профит для длинных позиций в пунктах. |

## Примечания

- Стратегия зависит от обновлений лучшего bid/ask, поэтому необходим поток котировок уровня Level I с актуальными значениями.
- Если задать нулевые дистанции или временные окна, соответствующий сигнал будет отключён, потому что опорная цена будет
  перезаписываться без открытия сделки.
- Поскольку защитные уровни обслуживаются внутри стратегии, неожиданные разрывы связи могут оставить позицию без жёстких стопов.
  Для живой торговли рекомендуется дополнительно включать внешние механизмы управления риском.
