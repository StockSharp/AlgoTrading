# AddOn Trailing Stop
[English](README.md) | [中文](README_cn.md)

Порт советника MetaTrader **AddOn_TrailingStop**. Стратегия не открывает сделки самостоятельно и лишь сопровождает трейлинг-стоп для уже существующей позиции.

## Как это работает

- Подписывается на поток Level1 и отслеживает лучшие цены bid/ask.
- Определяет размер пункта по количеству знаков в инструменте, чтобы параметры вели себя как в MetaTrader (4/5 знаков = 0.0001, 2/3 знака = 0.01).
- При наличии длинной позиции и росте цены bid на `TrailingStartPips` пунктов внутренняя линия стопа переносится на `Bid - TrailingStartPips` пунктов.
- Длинный стоп сдвигается только тогда, когда новое значение минимум на `TrailingStepPips` пунктов выше предыдущего.
- При наличии короткой позиции и снижении цены ask на `TrailingStartPips` пунктов внутренняя линия стопа переносится на `Ask + TrailingStartPips` пунктов.
- Короткий стоп сдвигается только тогда, когда новое значение минимум на `TrailingStepPips` пунктов ниже предыдущего.
- Если текущая котировка пересекает трейлинг-стоп, стратегия закрывает позицию рыночным ордером и сбрасывает состояние.

## Параметры

- `EnableTrailing` (по умолчанию **true**) – включает или выключает сопровождение трейлинг-стопа.
- `TrailingStartPips` (по умолчанию **15**) – прибыль в пунктах, необходимая для запуска трейлинга.
- `TrailingStepPips` (по умолчанию **5**) – дополнительная прибыль в пунктах для очередного сдвига стопа.
- `MagicNumber` (по умолчанию **0**) – идентификатор, сохранённый для совместимости с MQL-версией. Носит информативный характер, поскольку StockSharp управляет позициями текущей стратегии.

## Примечания

- Требуются настроенные `Security`, `Portfolio` и поток Level1.
- Предназначена для совместной работы с другими стратегиями, которые отвечают за входы.
- Все параметры представлены через `StrategyParam<T>`, поэтому их можно оптимизировать и отображать в интерфейсе.
- При срабатывании трейлинг-стопа отправляет ордера `BuyMarket`/`SellMarket`, а дальнейшую обработку защитных заявок выполняет сам StockSharp.
