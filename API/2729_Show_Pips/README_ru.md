# Стратегия Show Pips

## Краткое описание
- **Источник**: конвертация индикатора MetaTrader 5 `Show Pips.mq5` (TPSproTrading, 2017).
- **Назначение**: визуальный мониторинг плавающей прибыли по текущему инструменту, спреда и времени до закрытия свечи.
- **Тип**: информационная стратегия, сделки не открывает.

## Как работает
1. Подписывается на выбранный таймфрейм свечей для отслеживания момента закрытия текущего бара.
2. Получает поток Level1, чтобы иметь последнюю цену сделки, бид и аск для расчёта спреда.
3. Рассчитывает:
   - Прибыль открытой позиции в **пунктах**, **валюте счёта** и **процентах от стоимости портфеля**.
   - Текущий **спред** в тиках (либо в единицах цены, если шаг цены не задан).
   - Обратный отсчёт до закрытия следующей свечи исходя из выбранного таймфрейма.
4. Формирует строку состояния и выводит её на график либо в лог стратегии согласно выбранному режиму.

Все действия выполняются через высокоуровневый API StockSharp: дополнительные коллекции не создаются, работа ведётся только по готовым свечам.

## Параметры
| Имя | Описание | Значение по умолчанию |
|-----|----------|-----------------------|
| `ShowType` | Режим вывода: рядом с ценой, в лог или как подпись в углу графика. | `FollowPrice` |
| `ShowProfit` | Добавлять прибыль в валюте счёта. | `false` |
| `ShowPercent` | Добавлять прибыль в процентах от стоимости портфеля. | `false` |
| `ShowSpread` | Показывать текущий спред. | `true` |
| `ShowTime` | Показывать время до закрытия следующей свечи. | `true` |
| `Separator` | Разделитель между блоками текста. | `<code> | </code>` |
| `CandleType` | Тип свечей для расчёта длительности бара. | `TimeFrame(1m)` |
| `PipSize` | Цена одного пункта для выбранного инструмента. | `0.0001` |

## Режимы отображения
- **FollowPrice** – подпись рядом с текущей ценой на графике (обновляется при каждом событии).
- **AsComment** – вывод строки состояния в лог стратегии (повторяющиеся значения игнорируются).
- **CornerLabel** – подпись чуть выше текущей цены, что имитирует закреплённую надпись в углу.

## Дополнительные замечания
- Знак прибыли в пунктах соответствует направлению позиции (положительный — когда сделка в профите).
- Процент прибыли рассчитывается от `Portfolio.CurrentValue`; убедитесь, что коннектор возвращает эту величину.
- При отсутствии позиции стратегия продолжает показывать спред и таймер, а блок прибыли принимает значение `0.0 pips`.
- Стратегия не генерирует торговых заявок.

## Ссылки на оригинал
Индикатор MetaTrader рисовал текст на графике или использовал комментарий графика. В StockSharp реализация использует методы рисования на графике и данные Level1, сохраняя логику исходного решения.
