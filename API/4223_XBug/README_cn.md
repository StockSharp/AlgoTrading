# X Bug 策略

## 概述
**X Bug 策略** 源自同名的 MQL4 智能交易系统，是一套基于移动平均线交叉的趋势跟随方案。策略使用蜡烛图的中价来计算快、慢两条简单移动平均线，当快线向上或向下穿越慢线时，按照交叉方向建立仓位。本实现保留了原版 EA 的核心特性，包括信号反向、反向信号时自动平仓以及以点（pip）为单位的风控设置。

## 交易逻辑
1. 订阅设定的蜡烛类型（默认 1 分钟），计算两条简单移动平均线，并应用参数中的指标位移。
2. 当当前快线值高于慢线、且前两个柱子的快线值低于慢线时认定为看多交叉；反之则为看空交叉。
3. 启用 **ReverseSignals** 参数时，策略会反向执行交易信号。
4. 若启用 **CloseOnSignal**，在新的反向信号出现时会立即平掉当前反向持仓，然后再执行新交易。
5. 仅在仓位为空或方向一致时开仓，避免同方向叠加仓位。

## 风险控制
- **StopLossPips**：设置以点为单位的止损距离。对于五位或三位小数报价，会根据品种的最小报价单位自动换算。
- **TakeProfitPips**：设置以点为单位的止盈目标。
- **TrailingStopPips**：启用 **UseTrailingStop** 时，在持仓盈利后按照该距离启动移动止损，移动步长与距离相同，以模拟原始 EA 的行为。
- 所有保护性订单通过 `StartProtection` 管理，并以市价执行，确保与 MQL4 版本一致。

## 参数
| 参数 | 说明 | 默认值 |
|------|------|--------|
| `OrderVolume` | 每次入场使用的基础手数。 | `0.1` |
| `StopLossPips` | 止损距离（点）。设为 `0` 可禁用。 | `70` |
| `TakeProfitPips` | 止盈距离（点）。设为 `0` 可禁用。 | `5000` |
| `UseTrailingStop` | 是否启用移动止损。 | `true` |
| `TrailingStopPips` | 移动止损距离（点）。 | `90` |
| `FastPeriod` | 快速移动平均线周期。 | `1` |
| `FastShift` | 快速移动平均线的位移（柱数）。 | `0` |
| `SlowPeriod` | 慢速移动平均线周期。 | `14` |
| `SlowShift` | 慢速移动平均线的位移（柱数）。 | `10` |
| `CloseOnSignal` | 新信号出现时是否强制平掉反向仓位。 | `true` |
| `ReverseSignals` | 是否反向执行交易信号。 | `false` |
| `AppliedPrice` | 指标使用的价格类型。 | `Median` |
| `CandleType` | 生成信号使用的蜡烛类型。 | 1 分钟时间框架 |

## 备注
- 对于 5 位或 3 位小数报价，策略会将价格步长乘以 10 以获得 1 个点的大小，从而与原版 EA 保持一致。
- 本目录仅提供 C# 实现，暂不包含 Python 版本。
- 将任意点距参数设为 `0` 即可关闭对应的止损、止盈或移动止损功能。
