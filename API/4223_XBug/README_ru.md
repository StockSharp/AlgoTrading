# Стратегия X Bug

## Обзор
**X Bug** — это стратегия пересечения скользящих средних, перенесённая с советника MQL4. Она вычисляет две простые скользящие средние по медианной цене свечи и открывает позицию, когда быстрая средняя пересекает медленную. Реализация сохраняет ключевые особенности оригинала: разворот сигналов, принудительное закрытие позиции при противоположном сигнале и управление защитными заявками в пипсах.

## Логика работы
1. Подписка на выбранный тип свечей (по умолчанию минутные) и расчёт двух простых скользящих средних — быстрой и медленной. Параметры сдвига учитываются при получении значений индикаторов.
2. Бычий сигнал фиксируется, когда текущее значение быстрой средней находится выше медленной, а два бара назад — ниже. Медвежий сигнал определяется зеркально.
3. Параметр **ReverseSignals** позволяет инвертировать направление сделок и торговать против направления пересечения.
4. При активированном **CloseOnSignal** стратегия немедленно закрывает противоположную позицию перед открытием новой.
5. Входы совершаются рыночными ордерами: покупка при бычьем пересечении и продажа при медвежьем. Стратегия не накапливает однонаправленные позиции, торгует только при отсутствии открытых сделок или при совпадении направления.

## Управление рисками
- **StopLossPips** — фиксирует защитный стоп в пипсах. При котировках с 5 или 3 знаками после запятой величина пипса автоматически корректируется по шагу цены инструмента.
- **TakeProfitPips** — задаёт расстояние до тейк-профита в пипсах.
- **TrailingStopPips** — при включённом **UseTrailingStop** активирует трейлинг с заданным расстоянием. Шаг трейлинга равен самому расстоянию, что соответствует логике советника.
- Все защитные ордера запускаются через `StartProtection` с рыночным исполнением для точного соответствия MQL-версии.

## Параметры
| Параметр | Описание | Значение по умолчанию |
|----------|----------|-----------------------|
| `OrderVolume` | Базовый объём сделки. | `0.1` |
| `StopLossPips` | Стоп-лосс в пипсах (0 отключает). | `70` |
| `TakeProfitPips` | Тейк-профит в пипсах (0 отключает). | `5000` |
| `UseTrailingStop` | Включает/выключает трейлинг. | `true` |
| `TrailingStopPips` | Дистанция трейлинга в пипсах. | `90` |
| `FastPeriod` | Период быстрой скользящей средней. | `1` |
| `FastShift` | Сдвиг быстрой средней в барах. | `0` |
| `SlowPeriod` | Период медленной скользящей средней. | `14` |
| `SlowShift` | Сдвиг медленной средней в барах. | `10` |
| `CloseOnSignal` | Закрывать противоположную позицию при новом сигнале. | `true` |
| `ReverseSignals` | Инвертировать направление сигналов. | `false` |
| `AppliedPrice` | Тип цены свечи для расчёта индикаторов. | `Median` |
| `CandleType` | Тип свечей для сигналов. | Таймфрейм 1 минута |

## Примечания
- Значение пипса вычисляется как шаг цены, умноженный на 10 для инструментов с 5 или 3 десятичными знаками, что повторяет оригинальный советник.
- Версия на Python не предоставляется; в каталоге находится только реализация на C#.
- Чтобы отключить стопы или трейлинг, установите соответствующие параметры в `0`.
