# Стратегия Martingail Expert

## Обзор
Martingail Expert — это маржинальная стратегия, которая использует осциллятор Stochastic для определения направления новой серии сделок. После появления сигнала стратегия открывает серию рыночных заявок, управляя прибылью через динамическую цель и геометрическое наращивание объема.

## Логика торговли
- Рассчитывается осциллятор Stochastic на выбранном таймфрейме. Финальные значения линий %K и %D сохраняются для принятия решений.
- Новая длинная серия запускается, если `%K (предыдущее) > %D (предыдущее)` и `%D (предыдущее)` выше порога `BuyLevel`.
- Новая короткая серия запускается, если `%K (предыдущее) < %D (предыдущее)` и `%D (предыдущее)` ниже порога `SellLevel`.
- После входа каждые `ProfitFactor × количество_ордеров` пунктов в прибыльном направлении добавляется новый ордер базовым объемом.
- Каждые `StepPoints` пунктов против позиции объем последнего ордера умножается на `Multiplier`, и отправляется усредняющий ордер в том же направлении.

## Правила выхода
- Вся позиция закрывается, как только цена последнего исполнения достигает динамической цели `ProfitFactor × количество_ордеров` пунктов в прибыльную сторону.
- Состояние мартингейла сбрасывается при возврате суммарной позиции к нулю.

## Управление рисками
Мартингейл быстро увеличивает нагрузку при движении рынка против позиции. Подбирайте `Multiplier`, `StepPoints` и `ProfitFactor` в соответствии с размером счета и волатильностью инструмента.

## Параметры
| Имя | Описание |
| --- | --- |
| `Volume` | Базовый объем рыночной заявки, используемый при первом входе и при добавлениях по тренду. |
| `Multiplier` | Множитель объема для усреднения при неблагоприятном движении. |
| `StepPoints` | Шаг в пунктах, при достижении которого отправляется усредняющий ордер. |
| `ProfitFactor` | Цель прибыли на ордер в пунктах. Фактическая дистанция равна `ProfitFactor × количество_ордеров`. |
| `KPeriod` | Длина окна для линии %K. |
| `DPeriod` | Длина сглаживания для линии %D. |
| `Slowing` | Дополнительное сглаживание %K перед сравнением с %D. |
| `BuyLevel` | Минимальное значение %D для разрешения длинной серии. |
| `SellLevel` | Максимальное значение %D для разрешения короткой серии. |
| `CandleType` | Тип свечей для расчета индикаторов (по умолчанию — 5 минут). |

## Примечания
- Наилучшие результаты достигаются на ликвидных валютных парах с мелким шагом цены и объема.
- Требуется достаточная маржа для выдерживания нескольких шагов мартингейла.
