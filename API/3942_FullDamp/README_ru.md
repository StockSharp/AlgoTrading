# Стратегия Full Damp

## Общее описание

Full Damp — это контртрендовая стратегия, использующая три набора полос Боллинджера и фильтр на основе RSI. Система ищет выбросы цены за пределы самых широких полос, чтобы обнаружить возможное истощение движения. После фиксации экстремума проверяется, попадал ли RSI в зону перепроданности или перекупленности в пределах последних `LookbackBars` свечей. Вход осуществляется, когда цена возвращается внутрь средней полосы. Управление позицией включает частичную фиксацию прибыли, перенос стоп-ордера и выход по сигналу полос Боллинджера.

## Торговая логика

1. **Определение сигнала**
   * Лонг сигнал формируется, когда минимум свечи закрывается ниже нижней полосы Боллинджера с шириной 3. Шорт сигнал возникает при закрытии максимума выше верхней полосы того же набора.
   * В течение последних `LookbackBars` завершённых свечей RSI должен достигнуть значения ниже 30 (для покупки) или выше 70 (для продажи). Каждый новый экстремум обновляет таймер.
2. **Точка входа**
   * Покупка выполняется после закрытия цены выше нижней полосы набора с шириной 2 и при отсутствии открытой длинной позиции.
   * Продажа инициируется, когда цена закрывается ниже верхней полосы среднего набора.
   * Начальный стоп-лосс устанавливается на минимуме (для покупок) или максимуме (для продаж), зарегистрированном после появления сигнальной свечи, и расширяется на заданное количество пунктов.
3. **Сопровождение позиции**
   * При достижении прибыли, равной первоначальному риску, половина позиции закрывается, а стоп переносится в точку входа.
   * Оставшаяся часть закрывается, если максимум (для покупок) или минимум (для продаж) пересекает среднюю полосу Боллинджера в противоположную сторону.
   * Если цена раньше доходит до стоп-уровня, позиция закрывается полностью.

## Параметры

| Параметр | Описание | Значение по умолчанию |
|----------|----------|-----------------------|
| `CandleType` | Тип свечей, используемых для расчётов и торговли. | Часовые свечи |
| `BollingerPeriod1` | Период узких полос Боллинджера (ширина = 1). | 20 |
| `BollingerPeriod2` | Период средних полос Боллинджера (ширина = 2). | 20 |
| `BollingerPeriod3` | Период широких полос Боллинджера (ширина = 3). | 20 |
| `RsiPeriod` | Период RSI для фильтрации сигналов. | 14 |
| `LookbackBars` | Количество свечей для поиска экстремальных значений RSI. | 6 |
| `StopOffsetPoints` | Дополнительный зазор в пунктах для расчёта стоп-лосса. | 10 |
| `Volume` | Объём заявки, задаётся базовым классом. | 1 |

## Примечания

* Пороговые значения RSI фиксированы на уровнях 30 и 70, чтобы соответствовать оригинальному советнику MQL.
* Стратегия использует высокоуровневый API StockSharp: индикаторы подключаются через `Bind`, ордера исполняются по рынку, логика стопов и частичных выходов управляется внутри стратегии.
* Все решения принимаются по закрытию свечи, что исключает реакции на незавершённые данные.
