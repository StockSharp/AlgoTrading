# Full Damp 策略

## 概述

Full Damp 是一套基于三重布林带并配合 RSI 过滤器的反转策略。策略首先观察价格是否突破最宽的布林带，用来定位可能的超跌或超买行为；随后检查在最近的 `LookbackBars` 根 K 线中 RSI 是否进入极值区域。如果条件满足，在价格重新返回到中等宽度的布林带内部时开仓。入场后，策略通过分批止盈、动态调整止损以及布林带退出规则进行头寸管理。

## 交易逻辑

1. **信号检测**
   * 当 K 线最低价跌破宽度为 3 的布林带下轨时产生多头信号；当最高价触及同一布林带的上轨时产生空头信号。
   * 在最近 `LookbackBars` 根完成的 K 线中，RSI 必须出现低于 30（多头）或高于 70（空头）的读数。每当 RSI 再次触发极值，倒计时会被刷新。
2. **入场触发**
   * 当价格重新收在宽度为 2 的布林带下轨之上时开多，前提是当前没有多头仓位。
   * 当价格收在宽度为 2 的布林带上轨之下时开空。
   * 初始止损设在信号出现以来的最低价（多头）或最高价（空头）基础上，加上可配置的点数缓冲。
3. **仓位管理**
   * 当浮动盈利达到初始风险幅度时，平掉一半仓位，并把止损移动到开仓价。
   * 余下仓位在价格反向突破中等宽度布林带时全部平仓。
   * 如果价格在达到目标前回落到止损位置，整体头寸立即止损离场。

## 参数

| 参数 | 说明 | 默认值 |
|------|------|--------|
| `CandleType` | 用于分析与执行的 K 线类型。 | 1 小时 K 线 |
| `BollingerPeriod1` | 宽度为 1 的布林带周期。 | 20 |
| `BollingerPeriod2` | 宽度为 2 的布林带周期。 | 20 |
| `BollingerPeriod3` | 宽度为 3 的布林带周期。 | 20 |
| `RsiPeriod` | RSI 过滤器的周期。 | 14 |
| `LookbackBars` | 检查 RSI 极值的历史 K 线数量。 | 6 |
| `StopOffsetPoints` | 初始止损额外增加的点数缓冲。 | 10 |
| `Volume` | 基类策略中设置的下单手数。 | 1 |

## 说明

* RSI 阈值固定为 30/70，以贴近原始 MQL 实现。
* 策略完全基于 StockSharp 高级 API：指标准备通过 `Bind` 完成，交易以市价单执行，止损与分批逻辑在策略内部维护。
* 所有决策均在 K 线收盘时执行，避免在未完成的数据上产生噪声信号。
