# MT45 策略

## 概览
MT45 策略是原始 MetaTrader 专家顾问的完整移植版本。系统在每根收盘的 K 线后交替开多单和空单，并使用与 MQL 版本相同的固定止盈和止损距离保护头寸。仓位管理遵循马丁式加仓逻辑：只有在上一笔交易亏损时才放大下一次的下单数量，并在达到上限后回落到基础手数。

## 交易逻辑
1. 策略根据 **Candle Type** 参数订阅一组蜡烛图数据，只在蜡烛收盘后处理信号，以过滤掉盘中噪音。
2. 当没有持仓且上一笔进场订单已经处理完毕时，策略按照轮换顺序提交市价单（先买、后卖，再买……）。
3. 只有在订单真正成交后才切换下一次的方向，从而保持与原始 MQL 专家顾问相同的交替节奏。
4. 通过 `StartProtection` 自动附加的止盈止损单控制风险，一旦达到任一距离就离场。

## 仓位管理
* **Base Volume** 设定基础手数，并在盈利或持平时恢复该值。
* 如果上一笔交易亏损，下一笔订单的数量会乘以 **Martingale Multiplier**。若结果超过 **Max Volume**，则退回到基础手数以避免风险失控。
* 通过比较出场价格与记录的入场价格来计算每笔交易的盈亏，完整复现了原来 `Lot()` 函数的行为。

## 风险控制
* **Stop Points** 与 **Take Points** 以价格步长为单位，等同于 MetaTrader 中的 `_Point`。策略会结合标的物的 `PriceStep` 将其转换为绝对价格距离，再交由 `StartProtection` 执行。
* 每笔多单与空单都会自动挂出对称的止盈和止损订单，确保风险始终被限定。

## 参数
| 名称 | 说明 | 默认值 |
| --- | --- | --- |
| Stop Points | 止损距离（价格步长）。 | 600 |
| Take Points | 止盈距离（价格步长）。 | 700 |
| Base Volume | 盈利后恢复的基础手数。 | 0.01 |
| Martingale Multiplier | 亏损后放大的倍数。 | 2 |
| Max Volume | 马丁加仓允许的最大手数。 | 10 |
| Candle Type | 触发信号所用的蜡烛类型（默认 1 分钟）。 | 1 分钟 |

## 使用建议
* 请选择与原策略相同的蜡烛时间框架，因为该逻辑只在蜡烛收盘时运作。
* 当有持仓或挂单尚未完成时，策略不会发送新的进场订单，始终等待现有头寸通过止盈或止损离场。
* 根据项目要求，目前未提供 Python 版本，也未创建相应的目录。
