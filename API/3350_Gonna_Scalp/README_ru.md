# Стратегия Gonna Scalp

## Общее описание

Gonna Scalp — порт популярного MetaTrader-советника на платформу StockSharp с использованием высокоуровневого API. Стратегия работает на коротком таймфрейме, ищет быстрые возвраты к среднему и одновременно учитывает преобладающий тренд. Прежде чем открыть сделку, голосующий механизм анализирует сигналы от индикаторов Momentum, CCI, ATR, стохастика и MACD. В любой момент времени удерживается не более одной позиции; каждая сделка защищена фиксированными уровнями стоп-лосса и тейк-профита (в пунктах MetaTrader).

## Логика торговли

1. **Подготовка индикаторов**
   - Быстрая и медленная WMA по типичной цене.
   - Индикатор Momentum (период 14), преобразованный в абсолютное отклонение от нейтрального уровня 100.
   - Индикаторы CCI (период 20) и ATR (период 12) выполняют роль фильтров направления.
   - Стохастик %K/%D (5/3/3) и MACD (12/26/9) рассчитываются по той же серии свечей.
2. **Голосование сигналов**
   - Каждый индикатор отдает голос в сторону покупки или продажи в зависимости от условий исходного эксперта.
   - Стратегия хранит три последних значения отклонения Momentum и требует, чтобы хотя бы одно превышало заданный порог.
   - Дополнительный фильтр по структуре требует: для покупок минимум свечи два бара назад должен быть ниже максимума предыдущей свечи (для продаж условие зеркальное).
3. **Исполнение сделок**
   - При превосходстве бычьих голосов и выполнении всех фильтров стратегия открывает длинную позицию базовым объемом.
   - При доминировании медвежьих голосов и подтверждении Momentum открывается короткая позиция.
4. **Управление рисками**
   - Для каждой позиции рассчитываются уровни стоп-лосса и тейк-профита в пунктах и конвертируются в реальные шаги цены.
   - При касании любого уровня на текущей свече позиция закрывается немедленно.

## Основные параметры

| Параметр | Описание | Значение по умолчанию |
| -------- | -------- | --------------------- |
| `TradeVolume` | Базовый торговый объем (в лотах) после выравнивания. | `0.01` |
| `FastMaPeriod` | Период быстрой WMA. | `1` |
| `SlowMaPeriod` | Период медленной WMA. | `5` |
| `MomentumPeriod` | Период индикатора Momentum. | `14` |
| `MomentumBuyThreshold` | Минимальное отклонение Momentum для покупок. | `0.3` |
| `MomentumSellThreshold` | Минимальное отклонение Momentum для продаж. | `0.3` |
| `StopLossSteps` | Дистанция стоп-лосса в пунктах MetaTrader. | `200` |
| `TakeProfitSteps` | Дистанция тейк-профита в пунктах MetaTrader. | `200` |
| `CandleType` | Таймфрейм свечей (по умолчанию 5 минут). | `M5` |

## Рекомендации по использованию

- Подберите `TradeVolume` в соответствии с требованиями инструмента — стратегия автоматически приводит объем к биржевому шагу.
- Параметры стоп-лосса и тейк-профита задаются в пунктах MetaTrader и далее переводятся в денежные шаги согласно точности инструмента.
- Для формирования сигналов требуется как минимум три завершенные свечи, чтобы заполнить буфер истории Momentum.
- Пирамидинг отсутствует: новая позиция не открывается, пока предыдущая полностью не закрыта.
- Подключите стратегию к графикам StockSharp для визуализации WMA, стохастика и MACD при проверке сигналов.
