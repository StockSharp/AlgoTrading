# Стратегия Doji Trader
[English](README.md) | [中文](README_cn.md)

Стратегия повторяет логику классического советника **Doji Trader**.
Она анализирует завершённые свечи, ищет компактные доджи и открывает
позицию при закрытии следующей свечи за пределами диапазона доджи.

## Логика работы

1. Обрабатываются только закрытые свечи. По умолчанию используется
   часовой таймфрейм, его можно изменить параметром `CandleType`.
2. Торговля разрешена, только если время закрытия последней свечи попадает
   в торговое окно `[StartHour, EndHour)` по времени площадки.
3. Алгоритм хранит три последних закрытых бара. Текущий бар сравнивается
   с двумя предыдущими (смещения `-2` и `-3`).
4. Свеча считается доджи, если модуль разницы между ценами открытия и закрытия
   меньше `MaximumDojiHeight * pip`, где pip вычисляется из шага цены инструмента.
   Для котировок с 3 или 5 знаками после запятой значение автоматически умножается на 10.
5. Если последняя свеча закрылась **выше** максимума найденного доджи, открывается (или
   переворачивается) длинная позиция. Закрытие **ниже** минимума доджи запускает короткую
   сделку. Пока цена остаётся внутри диапазона доджи, сигнал отсутствует.
6. Объём позиций берётся из свойства `Volume`. При смене сигнала стратегия отправляет
   объём, достаточный для закрытия прежнего направления и открытия позиции нужного размера
   в новом направлении, чтобы в рынке оставалась только одна нетто-позиция.

## Управление рисками

- Дистанции стоп-лосса и тейк-профита задаются в пунктах параметрами `StopLossPips` и
  `TakeProfitPips`. Нулевое значение отключает соответствующий защитный ордер.
- Метод `StartProtection` запускается один раз при старте и использует рыночные заявки,
  что воспроизводит поведение MQL-версии, где позиции закрывались и открывались напрямую.

## Параметры

| Имя | Описание | Значение по умолчанию |
| --- | --- | --- |
| `CandleType` | Таймфрейм анализируемых свечей. | 1 час |
| `StartHour` | Включительная граница начала торгового окна. | 8 |
| `EndHour` | Исключительная граница окончания торгового окна. | 17 |
| `MaximumDojiHeight` | Максимальная высота тела доджи в пунктах. | 1 |
| `StopLossPips` | Дистанция стоп-лосса в пунктах. | 50 |
| `TakeProfitPips` | Дистанция тейк-профита в пунктах. | 50 |

### Дополнительные замечания

- Стратегия рассчитана на неттинговый учёт позиций. Для инструментов с дробными пунктами
  (5- или 3-знаковые котировки) размер pip автоматически умножается на 10.
- Перед запуском установите желаемый торговый объём в свойство `Volume`.
- Дополнительные индикаторы не требуются: логика основана исключительно на свечных данных.
- По запросу заказчика Python-реализация отсутствует, доступна только версия на C#.
