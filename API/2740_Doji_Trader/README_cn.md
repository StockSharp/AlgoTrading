# Doji Trader 策略
[English](README.md) | [Русский](README_ru.md)

该策略复刻经典 **Doji Trader** EA 的核心思想。
它在每根 K 线收盘后检查是否出现小实体的十字星，一旦下一根 K 线收盘
突破十字星区间，就沿突破方向入场。

## 交易逻辑

1. 只处理已经收盘的 K 线。默认使用 1 小时周期，可通过参数 `CandleType`
   调整。
2. 只有当最新 K 线的收盘时间落在交易窗口 `[StartHour, EndHour)` 内时才允许
   下单，时间基于交易所时区。
3. 算法保存最近三根收盘 K 线。当前 K 线与之前两根 K 线（倒数第二和第三根）
   进行比较。
4. 当实体高度小于 `MaximumDojiHeight * pip` 时，该 K 线被视为十字星。pip 值由
   品种的最小报价步长计算而来，若为 3 或 5 位小数报价会自动放大 10 倍。
5. 若最新一根 K 线收盘价 **高于** 最近的十字星最高价，则建立或反手做多；
   若收盘价 **低于** 十字星最低价，则建立或反手做空；价格保持在区间内时
   不产生信号。
6. 下单手数取自策略的 `Volume` 属性。当出现反向信号时，算法会发送足够的
   数量来平掉旧仓位并建立目标持仓，确保始终只有一个净持仓。

## 风险控制

- `StopLossPips` 与 `TakeProfitPips` 以点（pip）为单位设置止损和止盈距离，
  设为 0 则关闭相应保护订单。
- 启动时调用一次 `StartProtection`，并使用市价单退出，以复现 MQL 版本中
  直接平仓再开仓的行为。

## 参数说明

| 名称 | 说明 | 默认值 |
| --- | --- | --- |
| `CandleType` | 参与计算的 K 线周期。 | 1 小时 |
| `StartHour` | 交易窗口起始小时（含）。 | 8 |
| `EndHour` | 交易窗口结束小时（不含）。 | 17 |
| `MaximumDojiHeight` | 判定十字星的最大实体高度（pip）。 | 1 |
| `StopLossPips` | 止损距离（pip）。 | 50 |
| `TakeProfitPips` | 止盈距离（pip）。 | 50 |

### 额外说明

- 策略以净仓模型为前提。对于 3 或 5 位小数报价的品种，pip 大小会自动乘以 10。
- 启动前请在 `Volume` 属性中设置期望的交易手数。
- 策略不依赖额外指标，只使用原始 K 线数据。
- 按要求目前仅提供 C# 版本，暂不包含 Python 实现。
