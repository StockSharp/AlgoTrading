# Стратегия Exp Slow Stoch Duplex

Эта стратегия представляет собой перенос MetaTrader 5 эксперта **Exp_Slow-Stoch_Duplex** на высокоуровневый API StockSharp. Используются два медленных стохастика на разных таймфреймах, которые синхронно формируют сигналы на открытие и закрытие длинных и коротких позиций. Защитные ордера реализуют те же стоп-лосс и тейк-профит, что и оригинальный советник.

## Правила торговли

- **Длинный модуль**
  - Стохастик рассчитывается на таймфрейме `LongCandleType`.
  - Значения %K и %D дополнительно сглаживаются выбранным методом и сдвигаются на `LongSignalBar` баров назад.
  - Позиция покупается, когда %K пересекает %D снизу вверх (`previousK <= previousD` и `currentK > currentD`).
  - Длинная позиция закрывается, если %K вновь опускается ниже %D (`currentK < currentD`).
- **Короткий модуль**
  - Стохастик рассчитывается на таймфрейме `ShortCandleType`.
  - Короткая позиция открывается при пересечении %K выше %D вниз (`previousK >= previousD` и `currentK < currentD`).
  - Короткая позиция закрывается, когда %K возвращается выше %D (`currentK > currentD`).
- Все заявки отправляются по рынку. Объём равен `TradeVolume` плюс абсолютное значение текущей позиции, поэтому при разворотах старая позиция закрывается полностью.
- Команда `StartProtection` добавляет тейк-профит и стоп-лосс в пунктах, как в MT5.

## Параметры

| Параметр | Тип | Значение по умолчанию | Описание |
|----------|-----|-----------------------|----------|
| `LongCandleType` | `DataType` | Свечи H8 | Таймфрейм длинного стохастика. |
| `LongKPeriod` | `int` | 5 | Период расчёта %K для длинного стохастика. |
| `LongDPeriod` | `int` | 3 | Период сглаживания %D для длинного стохастика. |
| `LongSlowing` | `int` | 3 | Дополнительное внутреннее сглаживание стохастика. |
| `LongSignalBar` | `int` | 1 | Количество закрытых баров, используемых для поиска пересечений. |
| `LongSmoothingMethod` | `SmoothingMethod` | `Smoothed` | Вторичное сглаживание %K и %D (None, Simple, Exponential, Smoothed, Weighted). |
| `LongSmoothingLength` | `int` | 5 | Длина вторичного сглаживания длинного стохастика. |
| `LongEnableOpen` | `bool` | `true` | Разрешение на открытие длинных позиций. |
| `LongEnableClose` | `bool` | `true` | Разрешение на закрытие длинных позиций. |
| `ShortCandleType` | `DataType` | Свечи H8 | Таймфрейм короткого стохастика. |
| `ShortKPeriod` | `int` | 5 | Период расчёта %K для короткого стохастика. |
| `ShortDPeriod` | `int` | 3 | Период сглаживания %D для короткого стохастика. |
| `ShortSlowing` | `int` | 3 | Дополнительное внутреннее сглаживание стохастика. |
| `ShortSignalBar` | `int` | 1 | Количество баров для анализа короткого пересечения. |
| `ShortSmoothingMethod` | `SmoothingMethod` | `Smoothed` | Вторичное сглаживание %K и %D короткого стохастика. |
| `ShortSmoothingLength` | `int` | 5 | Длина вторичного сглаживания короткого стохастика. |
| `ShortEnableOpen` | `bool` | `true` | Разрешение на открытие коротких позиций. |
| `ShortEnableClose` | `bool` | `true` | Разрешение на закрытие коротких позиций. |
| `TradeVolume` | `decimal` | 0.1 | Базовый объём ордеров. |
| `TakeProfitPoints` | `decimal` | 2000 | Дистанция тейк-профита в пунктах. |
| `StopLossPoints` | `decimal` | 1000 | Дистанция стоп-лосса в пунктах. |

## Особенности

- Параметр `SmoothingMethod` использует стандартные средние StockSharp и служит приближением оригинального JJMA. При необходимости вторичное сглаживание можно отключить, выбрав `None`.
- Длинный и короткий модули независимы и включаются/отключаются собственными флагами.
- В StockSharp применяется неттинг, поэтому при смене направления противоположные позиции закрываются автоматически.
