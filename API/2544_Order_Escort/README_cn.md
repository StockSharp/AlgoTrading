# Order Escort Trailing Manager
[English](README.md) | [Русский](README_ru.md)

该策略是 MQL「Order Escort」管理型 EA 的移植版本。本身不会开仓，而是监控已存在的持仓，并在每根完成的 K 线后逐步移动止损（以及可选的止盈）。随着统计的 K 线数量增加，跟踪距离会按照设定的曲线（线性、抛物线或指数）扩展，直到达到指定的最大条数。

## 详情

- **入场条件**：无。假设头寸由人工或其他系统打开。
- **方向**：多空皆可。
- **离场条件**：
  - 价格触及动态止损。
  - 价格触及被陪同移动的止盈。
  - 达到 `CloseBar` 指定的条数后强制平仓。
- **止损机制**：基于条数的自动追踪止损。
- **默认参数**：
  - `TargetBar` = 35
  - `DeltaPoints` = 80
  - `TrailingMode` = Linear
  - `Exponent` = 0.5
  - `EBase` = 2.718
  - `EscortTakeProfit` = true
  - `CloseBar` = 15
  - `CandleType` = 1 分钟周期
- **筛选标签**：
  - 分类：头寸管理
  - 方向：双向
  - 指标：无
  - 止损：追踪止损 + 可选止盈护航
  - 复杂度：中等
  - 周期：可配置
  - 季节性：无
  - 神经网络：无
  - 背离：无
  - 风险水平：取决于初始保护单

## 工作流程

1. 订阅所选 K 线并统计自启动以来完成的数量。
2. 使用三种模式之一计算累计追踪距离：
   - **线性**：每根 K 线增加 `DeltaPoints / TargetBar` 的距离。
   - **抛物线**：按照 `Exponent` 指定的幂曲线增长。
   - **指数**：基于自定义底数 `EBase` 指数增长。
3. 检测到持仓后，记录第一根完成 K 线的收盘价作为止损和止盈锚点。
4. 每根完成 K 线将追踪距离转换为价格（根据 `Security.PriceStep`），更新止损与止盈目标。
5. 价格触发任一目标则以市价平仓；当达到 `CloseBar` 时无条件平仓。

## 备注

- 适合与人工决策或其他信号结合，用作仓位保护模块。
- 初始止损/止盈越接近预期防护区，追踪效果越平滑，因为逻辑是在锚点基础上平移。
- 若 `Security.PriceStep` 未提供，将默认使用步长 1。
