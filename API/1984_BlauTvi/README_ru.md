# Стратегия Blau TVI

Данная стратегия представляет собой конвертацию MQL5‑советника `Exp_BlauTVI` на платформу StockSharp. В основе лежит индикатор **Blau True Volume Index (TVI)**, который отслеживает соотношение объёма покупок и продаж и помогает находить развороты.

## Идея

True Volume Index разделяет объём на восходящие и нисходящие тики и последовательно сглаживает их тремя экспоненциальными средними. Итоговое значение находится в диапазоне от −100 до +100 и показывает, какая сторона доминирует. Стратегия открывает длинную позицию, когда индикатор разворачивается вверх после снижения, и короткую позицию, когда индикатор разворачивается вниз после роста. Противоположные позиции закрываются.

## Параметры

- `Length1` – первый период сглаживания для объёма покупок и продаж.
- `Length2` – второй период сглаживания.
- `Length3` – финальное сглаживание TVI.
- `CandleType` – тип свечей для расчёта (по умолчанию 4‑часовой таймфрейм).
- `Allow Buy Open` – разрешить открытие длинных позиций.
- `Allow Sell Open` – разрешить открытие коротких позиций.
- `Allow Buy Close` – разрешить закрытие длинных позиций при появлении сигнала на продажу.
- `Allow Sell Close` – разрешить закрытие коротких позиций при появлении сигнала на покупку.
- `Enable Stop Loss` – использовать защитный стоп в пунктах.
- `Stop Loss` – величина стоп‑лосса в пунктах.
- `Enable Take Profit` – использовать тейк‑профит в пунктах.
- `Take Profit` – величина тейк‑профита в пунктах.
- `Volume` – объём заявки в лотах.

## Сигналы

1. **Покупка** – предыдущий TVI меньше значения двумя барами назад, а текущий TVI выше предыдущего. При необходимости закрываются открытые короткие позиции.
2. **Продажа** – предыдущий TVI больше значения двумя барами назад, а текущий TVI ниже предыдущего. При необходимости закрываются открытые длинные позиции.

Обрабатываются только завершённые свечи, расчёт выполняется по тиковому объёму. Стоп‑лосс и тейк‑профит необязательны и задаются в ценовых пунктах.

## Примечания

Стратегия использует высокоуровневый API: производится подписка на свечи, внутренний расчёт индикатора через `ExponentialMovingAverage` и управление позициями методами `BuyMarket` и `SellMarket`. На графике отображается TVI вместе со сделками стратегии.
