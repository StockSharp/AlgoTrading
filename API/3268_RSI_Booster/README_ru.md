# RsiBoosterStrategy

## Обзор

`RsiBoosterStrategy` — порт советника MetaTrader *RSI booster* на платформу StockSharp. Стратегия сравнивает значение «быстрого» RSI на текущей свече с отложенным RSI, рассчитанным по предыдущей свече. Если разница превышает заданный порог, открывается рыночная позиция. Далее сделка сопровождается фиксированным стоп-лоссом, тейк-профитом, при необходимости трейлинг-стопом и цепочкой обратных заявок для отработки убытков.

Реализация использует высокоуровневый API StockSharp: подписывается на один поток свечей, применяет встроенные индикаторы `RelativeStrengthIndex` и оформляет все настройки через систему параметров, что позволяет оптимизировать стратегию в Designer.

## Логика торговли

1. На каждой завершённой свече обновляются два RSI.
   * Быстрый RSI использует параметры `FirstRsiPeriod` и `FirstRsiPrice` и отражает текущее значение.
   * Отложенный RSI использует `SecondRsiPeriod` и `SecondRsiPrice`, но стратегия хранит предыдущее значение, обеспечивая задержку на одну свечу.
2. Если `быстрый RSI – отложенный RSI` больше `Ratio`, стратегия покупает (если нет открытого лонга). Если разница меньше `-Ratio`, открывается шорт (при отсутствии короткой позиции).
3. Параметр `OnlyOnePositionPerBar` запрещает более одного входа в каждом направлении в рамках одной свечи.
4. После закрытия каждой свечи проверяются условия стоп-лосса, тейк-профита и трейлинг-стопа. При срабатывании позиция закрывается немедленно.
5. При фиксации убытка и включённой функции восстановления стратегия может открыть обратную позицию тем же объёмом. Количество таких попыток ограничено `ReturnOrdersMax`.

## Управление рисками

* **Стоп-лосс** — задаётся в пунктах через `StopLossPips`; при достижении уровня позиция закрывается.
* **Тейк-профит** — задаётся через `TakeProfitPips`.
* **Трейлинг-стоп** — активируется, если `TrailingStopPips` больше нуля; перемещается при улучшении цены не менее чем на `TrailingStepPips`.
* **Обратные сделки** — включаются параметром `ReturnOrderEnabled`. После убыточного закрытия стратегия немедленно отправляет встречный ордер и считает количество восстановительных сделок.

## Параметры

| Параметр | Описание |
|----------|----------|
| `Volume` | Торговый объём каждой рыночной заявки (лоты или контракты). |
| `Ratio` | Минимальная разница между RSI для открытия позиции. |
| `StopLossPips` | Размер стоп-лосса в пунктах. |
| `TakeProfitPips` | Размер тейк-профита в пунктах. |
| `TrailingStopPips` | Дистанция трейлинг-стопа в пунктах. |
| `TrailingStepPips` | Минимальное улучшение перед переносом трейлинг-стопа. |
| `OnlyOnePositionPerBar` | Ограничивает количество входов на одну свечу. |
| `ReturnOrderEnabled` | Включает логику обратных ордеров после убытка. |
| `ReturnOrdersMax` | Максимальное число подряд идущих восстановительных сделок. |
| `FirstRsiPeriod` | Период быстрого RSI. |
| `FirstRsiPrice` | Тип цены для быстрого RSI (соответствует режимам MetaTrader). |
| `SecondRsiPeriod` | Период отложенного RSI. |
| `SecondRsiPrice` | Тип цены для отложенного RSI. |
| `CandleType` | Тип свечей, по которым ведётся анализ. |

## Дополнительно

* Конвертация пунктов в цену использует `PriceStep` инструмента, а при его отсутствии применяется запасное значение `0.0001`.
* Счётчик цепочки восстановительных сделок сбрасывается при прибыльной сделке или при достижении лимита `ReturnOrdersMax`.
* На графике отображаются обе линии RSI и совершённые сделки для визуального контроля.
