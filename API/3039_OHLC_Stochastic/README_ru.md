# Стратегия OHLC Stochastic
[English](README.md) | [中文](README_cn.md)

Стратегия следования за импульсом, использующая классический стохастик %K/%D на OHLC-свечах.
Алгоритм реагирует на пересечения в зонах перекупленности/перепроданности и защищает сделки наращиваемым трейлинг-стопом в ценовых шагах.

## Подробности

- **Основная идея**: использовать смену импульса, когда %K пересекает %D в экстремальных зонах.
- **Условия входа**:
  - **Лонг**:
    - %K пересекает %D снизу вверх, и хотя бы одна линия находится ниже порога `LevelDown`.
    - Если открыта короткая позиция, она закрывается и сразу переворачивается в лонг.
  - **Шорт**:
    - %K пересекает %D сверху вниз, и хотя бы одна линия выше порога `LevelUp`.
    - Если открыта длинная позиция, она закрывается и переворачивается в шорт.
- **Условия выхода**:
  - Срабатывание трейлинг-стопа (использует расстояние `TrailingStopSteps` и требование улучшения `TrailingStepSteps`).
  - Появление противоположного сигнала, запускающего разворот позиции.
- **Логика трейлинга**:
  - Расстояние и шаг домножаются на `PriceStep` инструмента для перевода пипсов/шагов в абсолютную цену.
  - Стоп подтягивается только после того, как цена уйдёт дальше, чем `TrailingStopSteps + TrailingStepSteps` от входа.
  - Отдельная обработка трейлинга для длинной и короткой стороны.
- **Индикаторы**:
  - [StochasticOscillator](https://doc.stocksharp.com/html/T_StockSharp_Algo_Indicators_StochasticOscillator.htm) с параметрами `KPeriod`, `DPeriod` и `Slowing`.
- **Направление**: Лонг и шорт.
- **Стопы**: Только трейлинг (фиксированных SL/TP нет).
- **Размер позиции**: Используется параметр `Volume`; при развороте отправляется объём `Volume + |Position|`.
- **Параметры по умолчанию**:
  - `CandleType` = `TimeSpan.FromHours(12).TimeFrame()`
  - `KPeriod` = 5
  - `DPeriod` = 3
  - `Slowing` = 3
  - `LevelUp` = 70
  - `LevelDown` = 30
  - `TrailingStopSteps` = 5 (ценовых шага)
  - `TrailingStepSteps` = 2 (ценовых шага)
- **Визуализация**:
  - При наличии графиков отображаются свечи, стохастик и сделки.

## Рекомендации по использованию

1. Перед запуском задайте нужный инструмент и таймфрейм.
2. Подгоняйте `TrailingStopSteps` под шаг цены инструмента, чтобы соответствовать реальным пипсам.
3. Метод `StartProtection()` позволяет добавлять внешние правила управления риском.
4. Наиболее эффективна на трендовых участках, где стохастик заранее показывает разворот импульса.
5. Для внутридневных инструментов стоит уменьшать расстояние трейлинга, чтобы избежать преждевременных выходов.
