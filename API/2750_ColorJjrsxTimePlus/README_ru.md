# Стратегия Color JJRSX Time Plus
[English](README.md) | [中文](README_cn.md)

Конвертированная версия эксперта MetaTrader5 `Exp_ColorJJRSX_Tm_Plus`. Стратегия анализирует развороты индикатора Color JJRSX (воспроизведённого через RSI с фильтром Jurik) и дополнительно контролирует время нахождения в позиции, как и оригинальный робот.

## Описание

- **Идея**: отслеживать изменение наклона осциллятора Color JJRSX. При переходе наклона вверх закрываются шорты и при необходимости открываются лонги, при переходе вниз — наоборот.
- **Инструмент**: любой актив, подключённый в `Security` стратегии.
- **Таймфрейм**: задаётся параметром, по умолчанию четырёхчасовые свечи (как в исходном советнике).
- **Направление**: торговля в обе стороны, каждое направление можно отключить.
- **Тип заявок**: рыночные (`BuyMarket()` / `SellMarket()`).

## Индикаторы

1. **RSI** — базовый моментум-осциллятор с периодом `RSI Length` (аналог параметра `JurXPeriod`).
2. **Jurik Moving Average** — сглаживает значения RSI по длине `Smoothing Length` (аналог `JMAPeriod`). Параметр фазы JMA из MQL отсутствует в StockSharp и не используется.
3. **Signal Shift** — реализует смещение `SignalBar`: сигналы рассчитываются по значениям, взятым на `Signal Shift` баров назад и по двум ещё более ранним значениям.

## Логика торговли

### Управление длинными позициями
- **Вход**: при включённом `Enable Long Entries` стратегия проверяет, что осциллятор два бара назад падал, на прошлом баре развернулся вверх (`previous < older`), а текущее значение продолжает рост (`current > previous`). Разрешено, если стратегия без позиции либо в шорте.
- **Выход**: опция `Exit Long on Downturn` закрывает лонг при появлении нисходящего наклона (`previous > older`).

### Управление короткими позициями
- **Вход**: при включённом `Enable Short Entries` требуется разворот вниз (`previous > older`) и подтверждение текущим баром (`current < previous`). Допустимо, если стратегия без позиции либо в лонге.
- **Выход**: опция `Exit Short on Upturn` закрывает шорт при появлении восходящего наклона (`previous < older`).

### Временной фильтр
- `Enable Time Exit` ликвидирует позицию по истечении `Holding Minutes`, полностью повторяя поведение параметра `nTime` в MQL.

### Управление рисками
- `Stop Loss (pts)` и `Take Profit (pts)` переводятся в защитные уровни через `StartProtection` с типом `UnitTypes.PriceStep`.

## Параметры

| Параметр | Описание | Значение по умолчанию |
|----------|----------|-----------------------|
| `Indicator Timeframe` | Таймфрейм свечей для расчёта индикаторов. | 4 часа |
| `RSI Length` | Период RSI (JurX). | 8 |
| `Smoothing Length` | Длина сглаживания Jurik (JMA). | 3 |
| `Signal Shift` | Смещение сигнала (`SignalBar`). | 1 |
| `Enable Long Entries` / `Enable Short Entries` | Разрешение входов в лонг / шорт. | true |
| `Exit Long on Downturn` / `Exit Short on Upturn` | Разрешение закрытий по наклону осциллятора. | true |
| `Enable Time Exit` | Включение выхода по времени. | true |
| `Holding Minutes` | Максимальное время удержания позиции (мин). | 240 |
| `Stop Loss (pts)` | Стоп-лосс в шагах цены. | 1000 |
| `Take Profit (pts)` | Тейк-профит в шагах цены. | 2000 |

## Особенности конверсии

- Гистограмма JJRSX заменена связкой RSI + Jurik. Стратегия использует только направление наклона, поэтому абсолютные значения индикатора не критичны.
- Параметры ММ (`MM`, `MMMode`, `Deviation`) не переносятся. Управление объёмом следует настраивать через `Strategy.Volume` или настройки портфеля.
- Глобальные переменные MQL для предотвращения повторных входов не нужны, так как стратегия реагирует только на сформированные свечи.
- Все комментарии и документация оставлены на английском языке в соответствии с правилами репозитория.
