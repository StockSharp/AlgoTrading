# 5Mins Envelopes
[English](README.md) | [中文](README_cn.md)

**5Mins Envelopes** повторяет оригинального советника MetaTrader, торгующего пятиминутные свечи относительно конвертов на основе линейно-взвешенной скользящей средней.
Стратегия ищет экстремальные выбросы цены за пределы полос и входит в направлении возврата к среднему значению.
Фильтр по спреду, фиксированный стоп-лосс, необязательный тейк-профит и трейлинг-стоп соответствуют исходной логике управления капиталом.

## Торговая логика
- **Индикатор**: линейно-взвешенная скользящая средняя (LWMA) по медианной цене (high+low)/2 с периодом 3.
- **Ширина конвертов**: отклонение 0.05% от значения LWMA вверх и вниз.
- **Формирование сигналов** (оценка предыдущей завершённой свечи и текущего бида):
  - **Покупка**: минимум предыдущей свечи находится более чем на `DistancePoints` ниже нижней полосы **и** текущий бид также ниже на это расстояние.
  - **Продажа**: максимум предыдущей свечи находится более чем на `DistancePoints` выше верхней полосы **и** текущий бид также выше на это расстояние.
- **Фильтры**:
  - Одновременно допускается только одна позиция (для входа необходимо отсутствие открытых позиций).
  - Если `MaxSpreadPoints` больше нуля, величина спреда должна быть меньше этого порога.

## Управление рисками
- **Объём**: параметр `TradeVolume` задаёт размер рыночной заявки.
- **Стоп-лосс**: `StopLossPoints` переводится в абсолютное значение через размер тика инструмента.
- **Тейк-профит**: необязательный `TakeProfitPoints`; значение 0 отключает целевой уровень.
- **Трейлинг-стоп**: необязательный `TrailingStopPoints`; значение 0 отключает сопровождение.
- **Защита**: помощник `StartProtection` применяет все выходы рыночными заявками, как и в MetaTrader.

## Параметры
- `TradeVolume = 1m`
- `DistancePoints = 140`
- `EnvelopePeriod = 3`
- `EnvelopeDeviationPercent = 0.05m`
- `StopLossPoints = 250`
- `TakeProfitPoints = 0`
- `TrailingStopPoints = 120`
- `MaxSpreadPoints = 25`
- `CandleType = TimeFrame(5 minutes)`

## Теги
- Категория: Mean Reversion
- Направление: Обе стороны
- Индикаторы: WeightedMovingAverage
- Стопы: Да (фиксированный + трейлинг)
- Таймфрейм: Внутридневной (M5)
- Сложность: Начальный уровень
- Риск: Средний
- Сезонность: Нет
- Нейросети: Нет
- Дивергенция: Нет
