# Стратегия PricerEA

## Обзор

**PricerEA Strategy** переносит логику советника MetaTrader 4 «PricerEA v1.0» на платформу StockSharp. Стратегия размещает до
четырёх отложенных ордеров по заданным ценам (Buy Stop, Sell Stop, Buy Limit, Sell Limit). После исполнения любого из ордеров
автоматически добавляются защитные стоп-лосс и тейк-профит, а также, при необходимости, включается трейлинг-стоп и перевод в
безубыток.

## Как работает стратегия

1. **Отложенные ордера** – уровни цен задаются пользователем и отправляются один раз при старте. При необходимости задаётся
   время жизни ордеров в минутах.
2. **Выбор объёма** – можно использовать фиксированный лот либо автоматический расчёт, основанный на балансе портфеля и аналоге
   параметра Risk Factor из MT4.
3. **Защитные заявки** – после открытия позиции стратегия выставляет стоп-лосс и тейк-профит на выбранном расстоянии (в шагах
   цены). При совместном включении трейлинга и безубытка стоп переносится только после прохождения расстояния, равного сумме
   триггера безубытка и первоначального стопа, как в оригинальном советнике.
4. **Сопровождение ордеров** – отложенные заявки автоматически снимаются по истечении срока жизни или при остановке стратегии.

## Параметры

| Параметр | Описание |
|----------|----------|
| `BuyStopPrice`, `SellStopPrice`, `BuyLimitPrice`, `SellLimitPrice` | Абсолютные цены размещения соответствующих отложенных ордеров. Значение `0` отключает ордер. |
| `TakeProfitPoints` | Расстояние до тейк-профита в шагах цены (`Security.PriceStep`). |
| `StopLossPoints` | Расстояние до стоп-лосса в шагах цены. |
| `EnableTrailingStop` | Включает трейлинг-стоп. |
| `TrailingStepPoints` | Минимальное улучшение цены (в шагах), необходимое для переноса трейлинга. |
| `EnableBreakEven` | Включает перевод стопа в безубыток. |
| `BreakEvenTriggerPoints` | Дополнительная прибыль (в шагах), после которой стоп переносится в безубыток. |
| `PendingExpiryMinutes` | Время жизни отложенных ордеров в минутах. Значение `0` оставляет их активными до исполнения или ручной отмены. |
| `VolumeMode` | Режим выбора объёма: ручной или автоматический. |
| `RiskFactor` | Множитель риска для автоматического расчёта объёма. |
| `ManualVolume` | Фиксированный лот, используемый в ручном режиме. |

## Отличия от версии MT4

- Автоматический расчёт объёма использует баланс портфеля StockSharp и множитель контракта инструмента, поэтому величина может
  немного отличаться от MetaTrader.
- Защитные заявки выставляются через стандартные методы StockSharp и учитывают шаг объёма, минимальный и максимальный лот
  торговой площадки.
- Срок действия ордеров контролируется самой стратегией, тогда как в MT4 используется серверная экспирация.

## Рекомендации по использованию

- Перед запуском задайте уровни цен. Нулевые значения отключают соответствующий ордер.
- Параметры в пунктах рассчитываются через `Security.PriceStep`, что соответствует логике «Digits» в MT4.
- Используйте возможности мониторинга портфеля и журналов StockSharp для контроля отложенных заявок и защитных приказов.
