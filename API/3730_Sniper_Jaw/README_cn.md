# Sniper Jaw 策略

**Sniper Jaw Strategy** 将 MetaTrader 4 专家顾问 `SniperJawEA.mq4` 移植到 StockSharp 的高级策略 API。系统在每根 K 线的中值价格上重建比尔·威廉姆斯的鳄鱼（Alligator）指标。当三条平滑移动平均线（下颚、牙齿、嘴唇）严格按照多头或空头顺序排列，并且相对于上一根收盘 K 线继续朝同一方向运动时，策略才会触发交易。

## 交易逻辑

1. **鳄鱼指标重建** – 使用三个 `SmoothedMovingAverage` 指标对 `(High + Low) / 2` 的中值价格求均线，分别表示下颚、牙齿和嘴唇，并按照各自的参数向前平移指定的 K 线数量，以匹配 MetaTrader 的缓冲区。
2. **趋势确认** – 多头信号要求满足 `jaw < teeth < lips`，并且三条线的当前值都高于上一根完成的 K 线。空头信号则需要 `jaw > teeth > lips`，同时三条线的当前值低于上一根 K 线。
3. **入场管理** – 策略一次只持有一个方向的仓位。若开启 `UseEntryToExit`，当出现反向信号时会先平掉当前仓位，下一次信号再考虑开立新单。
4. **保护性离场** – 止损和止盈以点（pip）表示，并依据标的物的 `PriceStep` 换算成价格水平。每根完成的 K 线都会检查价格是否触及这些阈值，一旦触及立即以市价单平仓。
5. **信号节流** – 原始 EA 会记录上一次下单所处的 K 线时间，防止同一根 K 线重复进场。移植版本同样保存最后一次信号的时间戳，并在同一根 K 线上忽略额外信号。

## 参数

| 参数 | 默认值 | 说明 |
|------|--------|------|
| `OrderVolume` | `0.1` | 下单手数或合约数量，传递给 `BuyMarket`/`SellMarket`。 |
| `EnableTrading` | `true` | 主开关，用于暂时停止新的进场信号，同时继续监控风控条件。 |
| `UseEntryToExit` | `true` | 在触发反向信号前先平掉现有仓位，对应 EA 的 “Entry to Exit” 选项。 |
| `StopLossPips` | `20` | 距离开仓价的止损点数，设置为 0 可禁用。 |
| `TakeProfitPips` | `50` | 距离开仓价的止盈点数，设置为 0 可禁用。 |
| `MinimumBars` | `60` | 在开始计算信号前必须积累的完成 K 线数量。 |
| `JawPeriod` / `TeethPeriod` / `LipsPeriod` | `13 / 8 / 5` | 鳄鱼三条平滑移动平均线的周期。 |
| `JawShift` / `TeethShift` / `LipsShift` | `8 / 5 / 3` | 每条均线向前平移的 K 线数，确保与 MetaTrader 一致。 |
| `CandleType` | `1 小时时间框架` | 主信号使用的 K 线数据类型，可根据需要调整为其它周期。 |

## 使用说明

- 只处理 `CandleStates.Finished` 的完成 K 线，以避免半成品数据带来的噪音。
- 止损和止盈完全由策略内部追踪，一旦触发会立即发送对冲方向的市价单以平仓。
- 点值换算遵循常见外汇规则：对于 5 位或 3 位小数的报价，一个点等于 10 个价格最小变动单位。
- 将策略与连接器、投资组合和标的物一起加入方案后，可在图表区域看到 K 线以及重建的鳄鱼三条线，方便与 MetaTrader 模板对比。
