# Locker
[English](README.md) | [中文](README_cn.md)

Сеточная хеджирующая стратегия, которая чередует рыночные покупки и продажи, чтобы фиксировать просадки и забирать небольшую прибыль в процентах от капитала.

## Логика торговли
* Открывает первую длинную позицию стартовым объёмом сразу после закрытия первого бара.
* Отслеживает каждую последующую сделку и ведёт внутренний учёт длинных и коротких ног, чтобы оценивать суммарный нереализованный и реализованный результат.
* Если количество активных ног достигает восьми, стратегия закрывает самую раннюю пару покупка/продажа, чтобы ограничить нагрузку ещё до выполнения другой логики на этом баре.
* Когда суммарная прибыль превышает целевой процент от стоимости портфеля, закрывает все оставшиеся позиции и обнуляет внутреннее состояние.
* Когда суммарная прибыль опускается ниже отрицательного порога, измеряет расстояние между ценой последней сделки и текущим рынком. Если цена выросла на заданный шаг, добавляется короткая нога; если упала на тот же шаг — открывается дополнительная длинная позиция.
* Каждое закрытие отправляет рыночную сделку в противоположном направлении от записанной ноги, чтобы моментально снять хедж.

## Параметры
* **Profit %** – процент от текущей стоимости портфеля, который нужно зафиксировать перед полным закрытием.
* **Start Volume** – объём первой длинной позиции, создающей сетку.
* **Step Volume** – объём каждой хеджирующей сделки после срабатывания порога убытка.
* **Step Points** – количество шагов цены между уровнями сетки; умножается на минимальный шаг цены инструмента для получения фактического расстояния.
* **Enable Automation** – общий переключатель, который при выключении останавливает торговую логику.
* **Candle Type** – серия свечей, по закрытию которых выполняется принятие решений.

Конвертация повторяет оригинальный алгоритм MetaTrader, но использует высокоуровневый API StockSharp и собственное хранение сделок внутри стратегии, чтобы расчёт прибыли оставался согласованным с MQL-версией.
