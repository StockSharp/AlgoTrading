# 锁仓网格（Locker）
[English](README.md) | [Русский](README_ru.md)

基于网格的对冲策略，通过交替建立买入和卖出市价单来锁定浮亏，并在账户余额上获取一小部分百分比收益。

## 交易逻辑
* 第一个完成的K线收盘后，立即按照起始手数开出第一笔多单来启动网格。
* 记录之后的每一笔交易，在策略内部维护多空腿列表，以估算总体的未实现盈亏与已实现盈亏。
* 当活跃腿数达到八笔时，优先关闭最早的一对买卖腿，在继续处理本根K线的其他逻辑之前先降低敞口。
* 当综合利润高于账户价值目标百分比时，平掉所有剩余仓位并重置内部状态。
* 当综合利润跌破目标的负值时，比较最近开仓价与当前市场价：若价格上行超过设定步长，补充一笔空单；若价格下行超过同样的距离，则加仓多单。
* 平仓时总是发送与记录腿方向相反的市价单，从而立即解除锁仓。

## 参数
* **Profit %** – 达到该百分比（基于当前账户价值）即锁定利润并全部平仓。
* **Start Volume** – 启动网格时首笔多单使用的手数。
* **Step Volume** – 触发亏损阈值后，每笔对冲单使用的手数。
* **Step Points** – 网格层级之间的价格步数，会与品种的最小报价步长相乘得到实际价格距离。
* **Enable Automation** – 全局开关，关闭后暂停所有交易逻辑。
* **Candle Type** – 用于驱动策略的K线类型，只有在K线收盘后才会做出决策。

该移植版本保留了原始 MetaTrader 专家的思路，同时利用 StockSharp 的高级 API 下单，并在策略内部保存详细的交易状态，从而保持盈亏计算与 MQL 程序一致。
