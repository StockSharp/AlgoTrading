# Стратегия Timer EA
[English](README.md) | [中文](README_cn.md)

Стратегия переносит советник TimerEA из MetaTrader на StockSharp. Основная задача — открыть и закрыть позицию в заранее
заданные даты/время, при необходимости используя отложенные ордера, трейлинг и переход в безубыток.

## Логика торговли

- **Расписание**
  - `OpenTime` активирует постановку ордера, когда завершённая свеча достигает заданной минуты.
  - `CloseTime` принудительно закрывает позицию и при необходимости отменяет активные отложенные заявки.
- **Типы ордеров**
  - Можно выбрать рыночный вход, стоп или лимит. Для отложенных заявок задаётся расстояние в шагах цены и время истечения.
- **Направления**
  - Отдельные флаги включают покупки и продажи. За один запуск стратегия отправляет по одной заявке каждого разрешённого типа.
- **Управление риском**
  - Реализованы фиксированный объём и режим «баланс × `RiskFactor`», повторяющий расчёт лота оригинала.
  - Стоп-лосс и тейк-профит задаются в шагах цены и пересчитываются при каждом входе.
  - Трейлинг-стоп поддерживает фиксированный отступ от цены, когда прибыль превышает буфер `BreakEvenSteps`; сдвиг стопа
    происходит только после прохождения дополнительного `TrailingStep`.
- **Защита позиций**
  - Порог безубытка запрещает трейлинг, пока прибыль меньше требуемого значения.
  - Отложенные заявки автоматически снимаются по истечении срока действия.

## Параметры по умолчанию

- Режим ордеров: Market.
- Покупки и продажи: отключены.
- Тейк-профит / стоп-лосс: по 10 шагов.
- Трейлинг и безубыток: отключены.
- Расстояние для отложенных заявок: 10 шагов, истечение — 60 минут.
- Размер позиции: Manual volume = 1.0 (RiskFactor = 1.0 в режиме баланса).
- Таймфрейм свечей: 1 минута.

## Особенности

- Обработка идёт только по завершённым свечам, поэтому задержка может достигать одной свечи.
- В StockSharp используется неттинговый учёт, одновременные длинная и короткая позиции невозможны даже при включённых обоих
  направлениях.
- Расстояния рассчитываются через `Security.PriceStep`. Если шаг цены не задан, значения воспринимаются как абсолютные цены.
