# Стратегия AK-47 Scalper

## Обзор
**AK-47 Scalper** — это конвертированная в StockSharp версия советника "AK-47 Scalper EA" для MetaTrader 4. Стратегия постоянно держит на рынке один отложенный ордер: sell stop ниже текущей цены или buy stop выше неё. Цена активации находится на половине расстояния стоп-лосса от текущего бид/аск, поэтому ордер следует за спредом и реагирует на импульсные движения во время активных сессий.

## Логика торговли
1. Подписка на выбранный тип свечей (по умолчанию минутные) и получение лучших цен bid/ask из стакана.
2. В течение торгового окна стратегия поддерживает один отложенный ордер выбранного направления. Расстояние до рынка всегда равно половине стоп-лосса, что повторяет оригинальную логику EA.
3. После исполнения ордера моментально создаются защитный стоп и, при необходимости, тейк-профит. По мере движения цены стоп подтягивается, сохраняя заданное количество пунктов.
4. Если торговое время закончилось или спред превысил порог, активные отложенные ордера отменяются. Когда условия снова подходят, ордер выставляется повторно.

## Управление рисками
- **StopLossPips** – размер стоп-лосса в пунктах. Эта же величина определяет смещение отложенного ордера и используется в трейлинг-логике.
- **TakeProfitPips** – необязательный тейк-профит в пунктах. Значение `0` отключает тейк-профит при сохранении стоп-лосса.
- **UseRiskPercent / RiskPercent / FixedVolume** – воспроизводят расчёт объёма из исходного советника. При включённом `UseRiskPercent` лот рассчитывается на основании свободных средств и процента риска; иначе используется фиксированный объём `FixedVolume`.
- **MaxSpreadPoints** – запрещает новые входы, когда спред (в пунктах цены) превышает допустимый порог. Пересчёт в деньги выполняется с учётом шага цены инструмента.
- Все защитные заявки пересоздаются после частичных сделок, чтобы позиция оставалась полностью покрытой.

## Параметры
| Параметр | Описание | Значение по умолчанию |
|----------|----------|-----------------------|
| `Direction` | Направление отложенного ордера: sell stop или buy stop. | `SellStop` |
| `UseRiskPercent` | Использовать расчёт объёма по проценту риска. | `true` |
| `RiskPercent` | Процент свободных средств, участвующий в расчёте. | `3` |
| `FixedVolume` | Базовый объём при отключённом процентном риске. | `0.01` |
| `StopLossPips` | Стоп-лосс и смещение ордера (в пунктах). | `3.5` |
| `TakeProfitPips` | Тейк-профит (в пунктах), `0` — отключён. | `7` |
| `MaxSpreadPoints` | Максимально допустимый спред в пунктах. | `5` |
| `UseTimeFilter` | Включение фильтра торгового времени. | `true` |
| `StartHour` / `StartMinute` | Начало торгового окна (временная зона площадки). | `02:30` |
| `EndHour` / `EndMinute` | Конец торгового окна. | `21:00` |
| `CandleType` | Тип свечей, управляющих логикой. | Таймфрейм 1 минута |

## Примечания
- Для инструментов с 5 или 3 знаками после запятой размер пункта определяется как шаг цены, умноженный на десять, что соответствует MetaTrader.
- Для корректной работы требуется поток заявок/котировок, обеспечивающий лучшие цены bid/ask.
- В каталоге присутствует только реализация на C#, версия на Python не создавалась.
