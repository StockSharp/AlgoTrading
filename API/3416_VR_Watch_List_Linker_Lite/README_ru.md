# VR Watch List Linker Lite

## Обзор
VR Watch List Linker Lite воспроизводит утилиту MetaTrader, которая синхронизировала все открытые графики с активным инструментом и таймфреймом. Порт для StockSharp поддерживает заданный список инструментов, выравнивая их по мастер-графику, привязанному к стратегии. Все связанные инструменты подписываются на одну и ту же серию свечей, используют общий таймфрейм и автоматически перезапускаются при рассинхронизации. Компонент полезен, когда несколько панелей мониторинга должны всегда показывать один и тот же инструмент без ручного вмешательства.

Стратегия изначально не совершает сделок. Она занимается исключительно координацией маркет-данных: подписки запускаются и контролируются, но заявки не отправляются.

## Логика синхронизации
### Процесс связывания
* При старте стратегия формирует список инструментов, за которыми нужно следить. Основной инструмент необязателен, но при включении становится мастер-графиком, чьи свечи выступают эталонным временем.
* Каждый связанный инструмент (включая мастер при необходимости) подписывается на заданный свечной `DataType`. Все успешные привязки протоколируются в журнале.
* При поступлении свечей запоминается время открытия для каждого инструмента. Время мастера становится эталонным для остальных.

### Обнаружение и устранение дрейфа
* Как только связанный инструмент получает завершённую свечу, её временная метка сравнивается с эталонным временем мастера.
* Если метки не совпадают, стратегия либо немедленно перезапускает подписку, либо ограничивается сообщением о расхождении — в зависимости от параметра `Restart On Mismatch`.
* Перезапуск закрывает текущую подписку и создаёт новую с теми же настройками, принудительно синхронизируя поток данных с мастер-графиком.

## Параметры
| Параметр | Описание | Значение по умолчанию |
| --- | --- | --- |
| `Candle Type` | Свечной `DataType`, общий для мастер-графика и всех связанных инструментов. Поддерживаются только типы на основе `TimeFrameCandleMessage`. | таймфрейм M1 |
| `Linked Securities` | Дополнительные инструменты, которые должны следовать за мастер-графиком. Оставьте пустым, чтобы контролировать только основной инструмент. | пусто |
| `Include Primary` | При включении инструмент стратегии становится мастер-графиком. Отключите, чтобы синхронизировать только внешний список. | `true` |
| `Restart On Mismatch` | Автоматически перезапускает подписку связанного инструмента, если его свечи выходят из синхронизации с эталонным временем. | `true` |

## Использование
1. Назначьте стратегии нужный инструмент (при активном **Include Primary** он станет мастер-графиком).
2. Заполните **Linked Securities** дополнительными инструментами, которые должны копировать мастер-график. Дубликаты и пустые элементы игнорируются.
3. Выберите общий таймфрейм в параметре **Candle Type**. Допускаются произвольные интервалы на базе `TimeFrameCandleMessage`.
4. Запустите стратегию. Журнал подтвердит привязку каждого инструмента и будет сообщать о повторных подписках или расхождениях.

Остановка или сброс стратегии освобождают все подписки, чтобы избежать зависших каналов данных. Повторный запуск пересоздаёт их заново.

## Дополнительные замечания
* Стратегия не отправляет ордера; она предназначена для задач выравнивания данных, дашбордов и аналитических наложений.
* При ручном изменении таймфрейма или списка инструментов требуется перезапуск, чтобы пересоздать подписки.
* Python-реализация отсутствует. В пакет API входит только версия на C#.
