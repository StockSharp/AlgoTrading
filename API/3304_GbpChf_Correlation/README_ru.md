# Стратегия корреляции GBPCHF
[English](README.md) | [中文](README_cn.md)

**Стратегия корреляции GBPCHF** воспроизводит советник MetaTrader «GbpChf 4» на высокоуровневом API StockSharp. Она отслеживает взаимосвязь пар GBPUSD и USDCHF на часовом таймфрейме и открывает позиции по выбранному инструменту (обычно GBPCHF), когда обе валютные ноги демонстрируют согласованный импульс.

## Логика работы
- Строятся два индикатора MACD (12/26/9) по GBPUSD и USDCHF на часовых свечах.
- Оцениваются как гистограмма MACD (моментум), так и сигнальная линия (подтверждение тренда).
- Сигнал на покупку появляется, если обе гистограммы выше нуля, гистограмма GBPUSD слабее USDCHF, а сигнальная линия GBPUSD располагается выше сигнальной линии USDCHF.
- Сигнал на продажу требует, чтобы обе гистограммы были ниже нуля, гистограмма GBPUSD показывала более сильный нисходящий импульс, а сигнальная линия GBPUSD находилась ниже сигнальной линии USDCHF.
- На каждой свече допускается только один ордер в каждом направлении. Дополнительный параметр может запрещать новые сделки до закрытия текущей позиции.

## Управление рисками
- Расстояния стоп-лосса и тейк-профита задаются в пунктах и переводятся в абсолютную цену через `PriceStep` торгуемого инструмента.
- Метод `StartProtection` активирует защитные заявки на стороне брокера/сервера, поэтому выходы будут исполнены даже при отключении стратегии.

## Параметры
- `Volume` – Объём сделки по сигналу. Значение по умолчанию `0.01`.
- `StopLossPips` – Размер стоп-лосса в пунктах. Значение по умолчанию `90`.
- `TakeProfitPips` – Размер тейк-профита в пунктах. Значение по умолчанию `45`.
- `OnlyOnePosition` – При `true` стратегия открывает новую сделку только после выхода в ноль по текущей позиции.
- `FastPeriod` – Период быстрой EMA для MACD. Значение по умолчанию `12`.
- `SlowPeriod` – Период медленной EMA для MACD. Значение по умолчанию `26`.
- `SignalPeriod` – Период скользящей сигнальной линии MACD. Значение по умолчанию `9`.
- `CandleType` – Таймфрейм свечей. По умолчанию `1` час.
- `GbpUsdSymbol` – Идентификатор инструмента GBPUSD.
- `UsdChfSymbol` – Идентификатор инструмента USDCHF.

## Практические советы
- Наилучшие результаты достигаются при синхронизированных потоках данных GBPUSD и USDCHF без пропусков часовых свечей.
- Журнал стратегии фиксирует отмены и исполнения заявок, что позволяет отслеживать поведение корреляции.
- Перед выставлением рыночной заявки стратегия отменяет активные ордера, что упрощает реверс позиции.
- Необходимо, чтобы соединитель умел находить инструменты GBPUSD и USDCHF (через мэппинг символов или запрос к провайдеру).

## Сводка по умолчанию
- **Таймфрейм**: Часовые свечи.
- **Направление**: Покупка и продажа.
- **Инструменты**: Торгует выбранный `Security` (обычно GBPCHF), анализирует GBPUSD и USDCHF.
- **Стопы**: Да (фиксированные расстояния в пунктах).
- **Индикаторы**: Гистограмма и сигнальная линия MACD на GBPUSD и USDCHF.
- **Сложность**: Средняя (корреляционная логика с несколькими инструментами и управлением стопами).
