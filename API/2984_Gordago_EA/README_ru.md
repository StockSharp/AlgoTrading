# Стратегия Gordago EA
[English](README.md) | [中文](README_cn.md)

Порт классического эксперта "Gordago EA" с платформы MetaTrader 5. Стратегия ведёт расчёт на базовом таймфрейме (по умолчанию M3), но подтверждает сигналы через MACD на старшем внутридневном графике и стохастик на часовом графике. Все изначальные параметры стопов, тейк-профитов и трейлинг-стопа сохранены, реализация построена на высокоуровневом API StockSharp.

## Логика стратегии

- **Потоки данных**
  - Основные свечи исполнения: настраиваемые, по умолчанию трёхминутные.
  - Свечи для MACD: настраиваемые, по умолчанию двенадцатиминутные.
  - Свечи для стохастика: настраиваемые, по умолчанию часовые.
- **Индикаторы**
  - MACD с периодами 12/26/9, рассчитывается на выделенном таймфрейме.
  - Стохастик с длиной 5, сглаживанием %K = 3 и %D = 3, рассчитывается на часовом таймфрейме.
- **Условия входа**
  - **Покупка**: текущее значение MACD выше предыдущего, предыдущее значение ниже нуля; %K стохастика ниже порога покупки (по умолчанию 37) и растёт относительно предыдущего значения.
  - **Продажа**: текущее значение MACD ниже предыдущего, предыдущее значение выше нуля; %K стохастика выше порога продажи (по умолчанию 96) и снижается относительно предыдущего значения.
- **Открытие позиции**
  - Объём фиксированный; смена направления автоматически перекрывает противоположную позицию.
  - Для длинных и коротких сделок задаются отдельные расстояния стоп-лосса и тейк-профита (по умолчанию 40/70 пипсов для лонга и 10/40 пипсов для шорта).
- **Выход из позиции**
  - Уровни стоп-лосса и тейк-профита проверяются на закрытии каждой базовой свечи.
  - Трейлинг активируется, когда прибыль превышает сумму расстояния трейлинга и шага; после активации стоп подтягивается на расстояние трейлинга.
  - Трейлинг может поставить защитный стоп даже при нулевом исходном стопе, как и в оригинальном советнике.

## Параметры

- `OrderVolume` – торговый объём в лотах.
- `StopLossBuyPips` / `TakeProfitBuyPips` – расстояния стоп-лосса и тейк-профита для лонгов в пипсах.
- `StopLossSellPips` / `TakeProfitSellPips` – расстояния стоп-лосса и тейк-профита для шортов в пипсах.
- `TrailingStopPips` – дистанция трейлинг-стопа в пипсах (0 отключает).
- `TrailingStepPips` – минимальный дополнительный профит (в пипсах) для сдвига трейлинга.
- `StochasticBuyLevel` / `StochasticSellLevel` – пороговые значения стохастика для входа в лонг и шорт.
- `CandleType` – рабочий таймфрейм стратегии.
- `MacdCandleType` – таймфрейм для расчёта MACD.
- `StochasticCandleType` – таймфрейм для расчёта стохастика.
- `MacdFastPeriod`, `MacdSlowPeriod`, `MacdSignalPeriod` – периоды MACD.
- `StochasticLength`, `StochasticSignalPeriod`, `StochasticSmoothing` – параметры стохастика.

## Особенности реализации

- Преобразование пипсов в цену выполняется через `PriceStep`. Если шаг цены содержит три или пять знаков после запятой, значение умножается на десять – аналогично корректировке в MQL-версии для пятизначных и трёхзначных котировок.
- При включённом трейлинг-стопе с нулевым шагом трейлинг игнорируется, а в журнал отправляется предупреждение.
- Из-за обработки по закрытию свечей защитные условия проверяются раз в свечу, а не на каждом тике, однако логика закрытий соответствует исходному советнику.
- По запросу представлена только C#-версия; папка и код на Python не создавались.
