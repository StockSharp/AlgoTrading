# Yesterday Today 策略
[English](README.md) | [Русский](README_ru.md)

Yesterday Today 策略复制了经典的 MetaTrader 突破思路：将当前价格与昨天的最高价、最低价进行比较。当价格突破昨日区间时，策略立即执行方向交易。若需要反手，会先平掉当前持仓再开新仓，始终保持单一方向。

## 概览

- 保存上一根已完成的日线蜡烛，记录其最高价与最低价。
- 订阅默认 15 分钟的信号蜡烛，实时监控收盘价是否突破昨日区间。
- 收盘价高于昨日高点时做多，收盘价低于昨日低点时做空。
- 止损与止盈采用固定点数（pip）距离，自动根据 3 位或 5 位小数的外汇报价进行转换。
- 每根完成的信号蜡烛都会检查最高/最低价是否触及止损或止盈。
- 在 `OnStarted` 中调用 `StartProtection`，以便保持账户的统一风险保护。

## 工作流程

1. 订阅日线数据并保存最近一根完成日线的高低点。
2. 订阅信号时间框的蜡烛（默认 15 分钟）。
3. 对每根完成的信号蜡烛执行以下步骤：
   - 先检测是否触发当前仓位的止损或止盈。
   - 如果收盘价突破昨日高点且没有多单，则市价买入；若持有空单则同时平仓反手。
   - 如果收盘价跌破昨日低点且没有空单，则市价卖出；若持有多单则同时平仓反手。
4. 当新的日线收盘后，用该日线更新“昨日区间”数据。

## 参数

- `TradeVolume` —— 新仓位的手数。在反手时会自动增加对冲量以先平旧仓。
- `StopLossPips` —— 止损距离（pip）。设置为 `0` 表示不启用止损。
- `TakeProfitPips` —— 止盈距离（pip）。设置为 `0` 表示不启用止盈。
- `SignalCandleType` —— 用于信号判断的蜡烛类型（默认 15 分钟）。

## 细节

- **入场条件**：信号蜡烛收盘价高于昨日高点（做多）或低于昨日低点（做空）。
- **交易方向**：双向。
- **离场条件**：信号蜡烛的最高/最低价触发止损或止盈。
- **是否使用止损**：是，固定点数。
- **默认参数**：
  - `TradeVolume` = 1
  - `StopLossPips` = 50
  - `TakeProfitPips` = 50
  - `SignalCandleType` = `TimeSpan.FromMinutes(15).TimeFrame()`
- **过滤标签**：
  - 类型：突破
  - 方向：双向
  - 指标：价格行为
  - 止损：启用
  - 复杂度：基础
  - 时间框架：日线背景 + 内盘执行
  - 季节性：否
  - 神经网络：否
  - 背离：否
  - 风险等级：中等

## 说明

- 策略只针对单一标的运行，启动前需设置 `Security` 与 `Portfolio`。
- Pip 大小依据 `Security.PriceStep` 计算，并针对 3/5 位报价进行调整，以匹配原 MQL 策略的行为。
- 因为使用了 `StartProtection`，在策略交易时仍可继承平台层面的风险保护。
