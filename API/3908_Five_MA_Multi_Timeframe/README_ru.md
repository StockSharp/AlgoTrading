# Стратегия Five MA Multi-Timeframe

## Обзор
**Five MA Multi-Timeframe Strategy** — реализация советника MT4 «5matf» на платформе StockSharp. Стратегия анализирует пять простых скользящих средних на трёх таймфреймах (основной, средний и медленный) и дополняет их показания индикатором Accelerator Oscillator. Комбинированная оценка показывает степень доминирования покупателей или продавцов и определяет моменты открытия или закрытия позиций.

## Индикаторы и данные
- **Простые скользящие средние (SMA)**: периоды 5, 8, 13, 21 и 34 на каждом таймфрейме.
- **Accelerator Oscillator (AC)**: используется на основном и самом медленном таймфреймах для оценки ускорения импульса.
- **Таймфреймы**: по умолчанию 15 минут (сигналы), 60 минут (подтверждение) и 240 минут (долгосрочный тренд). Все интервалы настраиваются параметрами.

## Логика сигналов
1. Для каждой SMA сравниваются значения текущей и предыдущей свечи, чтобы определить направление наклона.
2. Индикатор AC анализирует последовательность из четырёх последних значений и выявляет ускорение вверх или вниз.
3. Результаты переводятся в процентные оценки для каждого таймфрейма.
4. Если на всех трёх таймфреймах оценки выше 50% в сторону покупок — формируется сигнал **BUY**. Превышение 75% усиливает сигнал.
5. Аналогичные пороги в сторону продавцов генерируют сигнал **SELL**.
6. Открытые позиции закрываются, когда встречный сигнал превышает заданный уровень закрытия. Новые сделки открываются только при отсутствии позиции, как и в исходном советнике.

## Параметры
| Название | Значение по умолчанию | Описание |
| --- | --- | --- |
| `CandleType` | 15-минутные свечи | Основной таймфрейм для торговых сигналов. |
| `HigherTimeframe1` | 60-минутные свечи | Первый старший таймфрейм для подтверждения. |
| `HigherTimeframe2` | 240-минутные свечи | Второй старший таймфрейм для фильтрации тренда. |
| `FirstPeriod` – `FifthPeriod` | 5, 8, 13, 21, 34 | Периоды SMA для каждого таймфрейма. |
| `OpenLevel` | 0 | Минимальная сила сигнала для открытия позиции. |
| `CloseLevel` | 1 | Сила встречного сигнала для закрытия позиции. |

## Практические рекомендации
- Стратегия использует рыночные ордера и не разворачивает позицию в рамках одной свечи — сначала закрывает, затем ждёт нового сигнала.
- Убедитесь, что исторические данные доступны по всем выбранным таймфреймам, чтобы избежать рассинхронизации индикаторов.
- При работе с другими инструментами можно оптимизировать периоды SMA и чувствительность AC.

## Примечания по конверсии
Реализация полностью сохраняет логику MT4-советника «5matf», но использует высокоуровневые подписки и индикаторы StockSharp. Для активизации сигналов требуется накопить четыре завершённые свечи для Accelerator Oscillator, как и в оригинале.
