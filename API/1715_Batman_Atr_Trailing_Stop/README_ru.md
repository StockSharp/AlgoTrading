# Стратегия Batman ATR Trailing Stop

Данная стратегия основана на советнике "Batman" и использует **ATR (Average True Range)** для построения динамических уровней поддержки и сопротивления. Сделки открываются при пробое этих уровней ценой.

## Логика

1. Вычисляется ATR с заданным периодом.
2. Рассчитываются уровни:
   - `support = price - ATR * factor`
   - `resistance = price + ATR * factor`
3. В зависимости от текущего направления тренда сохраняется ближайший уровень.
4. При пробое ценой уровня сопротивления открывается **покупка**.
5. При пробое ценой уровня поддержки открывается **продажа**.

В качестве цены может использоваться закрытие либо типичная цена `(high + low + close) / 3`.

## Параметры

| Имя | Описание |
|-----|----------|
| `ATR Period` | Период индикатора ATR. |
| `ATR Factor` | Множитель ATR для построения линий. |
| `Use Typical Price` | Если включено, применяется `(High+Low+Close)/3`. |
| `Candle Type` | Тип свечей для расчётов. |

## Примечания

- Используется высокоуровневый API (`SubscribeCandles`, `Bind`).
- Метод `StartProtection()` вызывается при запуске.
- Торговля осуществляется только по завершённым свечам.
