# RSI 趋势交易策略

## 概览
该策略将 MetaTrader 中的 *"RSI trader v0.15"* 智能交易系统迁移到 StockSharp 高级 API。通过比较价格均线和经过平滑处理的 RSI 趋势，判断市场方向。默认使用一小时 K 线，但可以通过 `CandleType` 参数修改。

## 交易逻辑
1. 以设定周期计算标准 RSI。
2. 使用两条简单移动平均线对 RSI 进行平滑处理：一条快速信号均线和一条慢速确认均线。
3. 对收盘价应用两条移动平均线：短周期简单移动平均和长周期加权移动平均，对应原 MQL 程序中的 SMA 与 LWMA 组合。
4. 在每根完成的 K 线上评估趋势状态：
   - **多头共振**：短周期价格均线高于长周期价格均线，且快速 RSI 均线高于慢速 RSI 均线。
   - **空头共振**：短周期价格均线低于长周期价格均线，且快速 RSI 均线低于慢速 RSI 均线。
   - **盘整/分歧**：价格与 RSI 均线方向相反，表示没有清晰趋势。
5. 根据状态执行操作：
   - 出现多头共振且当前没有持仓时开多。
   - 出现空头共振且当前没有持仓时开空。
   - 一旦检测到盘整状态，立即平掉所有持仓，这与原始 EA 的保护逻辑一致。
6. 启用 `Reverse` 时会反转买卖方向，可用于构建反趋势策略。

策略仅在 K 线收盘后行动，并启用 StockSharp 的保护机制以处理异常情况。

## 参数
| 参数 | 说明 | 默认值 |
|------|------|--------|
| `RsiPeriod` | RSI 计算周期。 | 14 |
| `ShortRsiMaPeriod` | 作用于 RSI 的快速 SMA 周期。 | 9 |
| `LongRsiMaPeriod` | 作用于 RSI 的慢速 SMA 周期。 | 45 |
| `ShortPriceMaPeriod` | 价格短周期 SMA 周期。 | 9 |
| `LongPriceMaPeriod` | 价格长周期加权移动平均周期。 | 45 |
| `Reverse` | 为 `true` 时反转买卖方向。 | `false` |
| `CandleType` | 使用的 K 线数据类型，默认 1 小时。 | `1h` |

所有整数参数都预设了优化范围，便于在 StockSharp 优化器中快速迭代。

## 风险管理
- 当价格与 RSI 趋势出现分歧时立即平仓，以复制原 EA 的“横盘退出”保护。
- 在启动时调用 `StartProtection()`，结合 StockSharp 的防护框架。

## 其他说明
- 策略使用基类 `Volume` 属性作为下单手数。
- 仅处理已完成的 K 线，忽略未收盘数据，防止提前触发信号。
- 长周期价格均线使用加权移动平均，以匹配 MQL 中的 LWMA 计算方式。
