# Стратегия пересечения быстрых и медленных средних

## Обзор

**Стратегия Fast Slow MA Crossover** воспроизводит логику советника MetaTrader 4 `_HPCS_FastSlowMACrosssover_MT4_EA_V01_WE`. Она подписывается на выбранный поток свечей и сравнивает две экспоненциальные скользящие средние (EMA). Когда быстрая EMA пересекает медленную EMA в пределах допустимого внутридневного окна, стратегия открывает позицию. Уровни фиксации прибыли и ограничения убытков задаются в пунктах (pip), что повторяет масштабирование цен в исходном коде MQL.

## Логика торговли

1. Подписаться на выбранный тип свечей (по умолчанию — минутные свечи).
2. Рассчитать две EMA:
   - Период быстрой EMA (значение по умолчанию **14**).
   - Период медленной EMA (значение по умолчанию **21**).
3. Для каждой завершённой свечи выполнить:
   - Проверку, что время закрытия свечи лежит внутри торгового окна.
   - Поиск **бычьего пересечения**, когда быстрая EMA поднимается выше медленной.
   - Поиск **медвежьего пересечения**, когда быстрая EMA опускается ниже медленной.
4. Обработка сигналов:
   - Закрыть противоположную позицию, если она существует.
   - Открыть рыночную сделку объёмом, заданным параметром **Trade Volume**.
   - Сохранить цену закрытия свечи как базовую точку для расчёта стопов и целей.
5. Управление открытой позицией с помощью максимумов и минимумов свечи:
   - Закрыть длинную позицию, если цена уходит на величину **Stop Loss (pips)** ниже входа.
   - Закрыть длинную позицию, если цена достигает **Take Profit (pips)** выше входа.
   - Для коротких позиций применяется симметричная логика (стоп выше входа, цель ниже входа).

## Параметры

| Параметр | Описание |
|----------|----------|
| **Fast MA Period** | Период быстрой EMA, используемой для определения пересечения. |
| **Slow MA Period** | Период медленной EMA. |
| **Take Profit (pips)** | Дистанция до цели в пунктах для длинных и коротких позиций. |
| **Stop Loss (pips)** | Дистанция защитного стопа в пунктах. |
| **Start Time** | Начало дневного торгового окна (включительно). |
| **Stop Time** | Конец дневного торгового окна (включительно). |
| **Candle Type** | Тип свечей, на которых строятся индикаторы. |
| **Trade Volume** | Объём каждой рыночной заявки. |

## Примечания

- Размер пункта вычисляется из шага цены инструмента и количества знаков после запятой. Для пяти- и трёхзначных котировок шаг умножается на **10**, что соответствует расчётам MetaTrader.
- Фильтр времени поддерживает торговлю через полночь. Если **Start Time** больше **Stop Time**, стратегия работает до полуночи и продолжает работу с полуночи до времени остановки.
- На одну свечу приходится не более одного сигнала. Это отражает защиту в оригинальном советнике, который допускал только одну заявку на бар.
- Стопы и цели исполняются логикой стратегии, а не выставляются отдельными заявками на биржу, что соответствует оригинальному подходу, где уровни задавались при отправке ордера.
