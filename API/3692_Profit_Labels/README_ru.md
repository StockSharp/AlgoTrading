# Стратегия Profit Labels

## Обзор

**Profit Labels Strategy** — это конвертация советника MetaTrader 5 *Profit Labels (54352)* на высокоуровневый API StockSharp. Стратегия отслеживает пересечения Triple Exponential Moving Average (TEMA), чтобы открывать позиции, и рисует подписи с прибылью на графике после закрытия сделки. При смене тренда вверх открывается длинная позиция, при смене вниз — короткая. Если уже есть противоположная позиция, она сначала закрывается, после чего на графике отображается прибыль.

Свечи поступают через подписку `SubscribeCandles`, индикатор подключается через `Bind`, что позволяет обойтись без низкоуровневого доступа к буферам.

## Правила торговли

1. **Бычье пересечение**: текущее значение TEMA поднимается выше предыдущего, а старые значения показывают нисходящий уклон — открываем покупку, если длинная позиция отсутствует.
2. **Медвежье пересечение**: TEMA разворачивается вниз по той же схеме — открываем продажу при отсутствии короткой позиции.
3. **Реверс позиции**: при появлении сигнала, противоположного текущей позиции, стратегия сначала закрывает её и только затем открывает новую.
4. **Подписи прибыли**: после полного закрытия позиции рассчитывается реализованный PnL и выводится на график методом `DrawText`.

## Параметры

| Имя | Значение по умолчанию | Описание |
| --- | --------------------- | -------- |
| `CandleType` | `TimeSpan.FromMinutes(1).TimeFrame()` | Таймфрейм свечей для подписки. |
| `TemaPeriod` | `6` | Период Triple EMA. |
| `TradeVolume` | `0.1` | Объём заявки при открытии позиции. |
| `PlacingTrade` | `false` | Включает или отключает регистрацию реальных заявок. |
| `LabelOffset` | `0` | Вертикальное смещение подписи прибыли относительно цены сделки. |

## Примечания

- Используются только завершённые свечи, доступ к значениям индикатора осуществляется через биндинг.
- Стоп-лосс и тейк-профит из версии MQL не перенесены; позиции переворачиваются при появлении противоположного сигнала.
- Подписи пытаются выводить символ валюты инструмента, при его отсутствии отображается чистое числовое значение.
