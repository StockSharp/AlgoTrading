# Profit Labels 策略

## 概述

**Profit Labels Strategy** 将 MetaTrader 5 顾问 *Profit Labels (54352)* 移植到 StockSharp 的高级 API。策略监控三重指数移动平均线（TEMA）的交叉来开仓，并在仓位平仓后在图表上绘制收益标签。当趋势向上反转时开多单，趋势向下反转时开空单；如果存在相反方向的仓位，会先平仓再根据新信号操作，并立即显示实现收益。

蜡烛数据通过 `SubscribeCandles` 订阅，指标准备后使用 `Bind` 绑定，整个实现保持在高级 API 层完成，无需直接访问指标缓冲区。

## 交易规则

1. **看涨交叉**：当前 TEMA 值上穿前值，同时更早的数值呈下降走势时，若没有持有多单则开多。
2. **看跌交叉**：当前 TEMA 值下穿前值，且更早的数值呈上升走势时，若没有持有空单则开空。
3. **仓位反转**：若出现与当前仓位相反的信号，会先平掉已有仓位，再根据新方向建立仓位。
4. **收益标签**：仓位完全平掉后，计算已实现盈亏并通过 `DrawText` 在图表上显示。

## 参数

| 名称 | 默认值 | 描述 |
| ---- | ------ | ---- |
| `CandleType` | `TimeSpan.FromMinutes(1).TimeFrame()` | 订阅所用的蜡烛周期。 |
| `TemaPeriod` | `6` | 三重 EMA 的周期长度。 |
| `TradeVolume` | `0.1` | 每次下单的数量。 |
| `PlacingTrade` | `false` | 是否实际发送订单。 |
| `LabelOffset` | `0` | 收益标签相对于成交价的垂直偏移量。 |

## 说明

- 只处理已经完成的蜡烛，指标数值来自绑定回调，不直接读取缓冲。
- MQL 版本中的止损和止盈未移植；策略在出现反向信号时平仓或反手。
- 标签会尽量显示标的货币符号，若无法获取则直接显示数值。
