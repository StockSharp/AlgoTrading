# Стратегия Quick Trade Keys

## Обзор
**Quick Trade Keys Strategy** — это компактный помощник для ручной торговли, воспроизводящий поведение скрипта MetaTrader «QuickTradeKeys123». В оригинале трейдер нажимал клавиши 1–3, чтобы немедленно отправить рыночные ордера на покупку или продажу либо закрыть все позиции, открытые скриптом. В версии для StockSharp эти действия реализованы в виде булевых параметров стратегии, что позволяет вызывать их из интерфейса, оптимизатора или внешних сценариев без потери детерминированности при тестировании.

## Логика торговли
1. **Опрос команд по таймеру** — стратегия не зависит от рыночных данных. Вместо этого она запускает внутренний таймер с периодом 200 миллисекунд. Каждый тик таймера вызывает метод, проверяющий значения трёх управляющих параметров.
2. **Исполнение ручных команд** — при установке любого из параметров в `true` выполняется соответствующее действие:
   - `BuyRequest` отправляет рыночную заявку на покупку объёмом `OrderVolume`.
   - `SellRequest` отправляет рыночную заявку на продажу тем же объёмом.
   - `CloseAllRequest` закрывает суммарную позицию противоположной рыночной заявкой.
   После выполнения команда сбрасывается обратно в `false`, что гарантирует одноразовое срабатывание каждой установки.
3. **Проверка готовности подключения** — перед отправкой заявок стратегия убеждается, что соединение активно (`IsOnline == true`), а также заданы `Security` и `Portfolio`. Эти проверки отражают требование оригинального скрипта, согласно которому торговые функции доступны только при готовности окружения.
4. **Управление позицией** — команда закрытия использует агрегированную позицию, предоставляемую базовым классом `Strategy`. Это соответствует MQL-скрипту, который закрывал только собственные позиции (определяемые по magic number).

## Параметры
| Параметр | Описание |
|----------|----------|
| `OrderVolume` | Объём рыночных ордеров, отправляемых командами покупки и продажи. |
| `BuyRequest` | Установите `true`, чтобы сразу отправить рыночную заявку на покупку (после выполнения сбрасывается). |
| `SellRequest` | Установите `true`, чтобы сразу отправить рыночную заявку на продажу (после выполнения сбрасывается). |
| `CloseAllRequest` | Установите `true`, чтобы закрыть текущую суммарную позицию (после выполнения сбрасывается). |

## Отличия от версии MQL
- Горячие клавиши заменены явными параметрами, поэтому команды можно подавать из любого совместимого с StockSharp интерфейса или скрипта.
- Вместо обхода отдельных тикетов MetaTrader используется агрегированная позиция StockSharp, что даёт идентичный результат при работе только со сделками стратегии.
- Все действия выполняются рыночными ордерами, что обеспечивает повторяемость в тестах и упрощает инфраструктуру.
- Нет обработчиков событий графика — быстрый отклик достигается за счёт таймера с малым интервалом.

## Рекомендации по использованию
- Перед запуском стратегии обязательно назначьте `Security` и `Portfolio`; иначе будет сгенерировано исключение с подсказкой.
- Таймер гарантирует выполнение команд даже в спокойном рынке, когда нет новых котировок.
- Для имитации клавиатурного управления можно связать параметры с кнопками, горячими клавишами или автоматическими сценариями в пользовательском интерфейсе StockSharp.
