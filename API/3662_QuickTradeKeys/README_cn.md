# Quick Trade Keys 策略

## 概述
**Quick Trade Keys Strategy** 是一个轻量级的手动交易助手，用于在 StockSharp 中重现 MetaTrader 脚本「QuickTradeKeys123」的逻辑。原始脚本允许交易员通过按下键盘数字键快速发送买入、卖出或全部平仓的市价单。移植版本将这些操作暴露为布尔型参数，可以从 StockSharp 的界面、自动化脚本或外部工具中触发，并保持可回测的一致性。

## 交易逻辑
1. **基于计时器的命令轮询** —— 策略不依赖任何行情数据，而是在启动时创建一个 200 毫秒周期的内部计时器。每次计时器触发都会检查三个手动命令参数。
2. **手动命令执行** —— 当任意参数被设置为 `true` 时，就会执行相应操作：
   - `BuyRequest` 使用设定的 `OrderVolume` 发送市价买单。
   - `SellRequest` 使用相同的 `OrderVolume` 发送市价卖单。
   - `CloseAllRequest` 根据当前持仓方向发送反向市价单，从而平掉净头寸。
   每个命令执行后都会立即把触发参数重置为 `false`，确保一次触发只执行一次动作。
3. **连接安全检查** —— 在下单之前策略会确认自身在线 (`IsOnline == true`)，并且 `Security` 与 `Portfolio` 均已设置。这一点与原始 MQL 脚本需要在交易环境可用时才能操作的要求一致。
4. **持仓管理** —— 平仓命令依赖于 `Strategy` 基类提供的汇总持仓信息，与通过 magic number 识别并关闭脚本自身订单的原始实现相一致。

## 参数
| 参数 | 说明 |
|------|------|
| `OrderVolume` | 买入和卖出命令使用的市价订单数量。 |
| `BuyRequest` | 设为 `true` 即刻发送市价买单（执行后自动恢复为 `false`）。 |
| `SellRequest` | 设为 `true` 即刻发送市价卖单（执行后自动恢复为 `false`）。 |
| `CloseAllRequest` | 设为 `true` 即刻按照净头寸方向发送反向市价单，实现全部平仓（执行后自动恢复为 `false`）。 |

## 与 MQL 版本的差异
- 键盘热键被替换为策略参数，可以从任意兼容 StockSharp 的界面或脚本触发。
- 使用 StockSharp 汇总的净持仓，而非遍历 MetaTrader 的单个交易票据；当只有本策略开仓时，结果完全一致。
- 所有操作均通过市价单完成，简化了实现并在仿真环境中提供确定性。
- 不再依赖图表事件或 Tick 回调，内部计时器即可提供与按键触发类似的即时响应。

## 使用提示
- 启动前必须设置 `Security` 和 `Portfolio`，否则策略会抛出异常提醒配置不完整。
- 由于命令通过计时器轮询，即使市场暂时无行情更新，指令也会被执行。
- 可以将这些布尔参数绑定到 StockSharp 界面中的按钮、热键或自动化脚本，以复现 MetaTrader 的键盘操作体验。
