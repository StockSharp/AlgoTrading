# Стратегия XDidi Index Cloud Duplex

## Обзор
Стратегия XDidi Index Cloud Duplex переносит логику оригинального эксперта MQL5 *Exp_XDidi_Index_Cloud_Duplex* в инфраструктуру StockSharp. Используются два независимых набора индикаторов XDidi: «бычий» и «медвежий». Каждый набор рассчитывает отношение быстрых и медленных скользящих средних к средней кривой и формирует сигналы на разных таймфреймах.

## Логика торговли
1. **Расчёт индикатора**
   - Для каждого блока вычисляются три скользящие средние (быстрая, средняя, медленная) на выбранной цене.
   - Отношения `fast / medium` и `slow / medium` повторяют построение индикатора XDidi, опция инверсии соответствует параметру `Revers` из MQL.
2. **Формирование сигналов**
   - Длинный блок: если на предыдущем баре `fast > slow`, а на сигнальном баре `fast <= slow`, открывается длинная позиция. Если на предыдущем баре `fast < slow`, выполняется выход из лонга.
   - Короткий блок: если на предыдущем баре `fast < slow`, а на сигнальном баре `fast >= slow`, открывается короткая позиция. При `fast > slow` на предыдущем баре позиция закрывается.
   - Сдвиг по барам задаётся параметрами `LongSignalBar` и `ShortSignalBar`.
3. **Управление сделками**
   - Заявки выставляются по рынку объёмом стратегии; при смене направления противоположная позиция закрывается.
   - Защитные стопы и тейки задаются в шагах цены через `StartProtection`.

## Параметры
- **Таймфреймы**: `LongCandleType`, `ShortCandleType`.
- **Типы сглаживания и периоды**: `LongFast/Medium/SlowMethod` и `ShortFast/Medium/SlowMethod` с соответствующими длинами.
- **Источник цены**: `LongAppliedPrice`, `ShortAppliedPrice` (close, open, typical, Demark и др.).
- **Флаги торговли**: `EnableLongEntries`, `EnableLongExits`, `EnableShortEntries`, `EnableShortExits`.
- **Сдвиги по барам**: `LongSignalBar`, `ShortSignalBar`.
- **Инверсия**: `LongReverse`, `ShortReverse`.
- **Защита**: `StopLossPoints`, `TakeProfitPoints` в шагах цены; ноль отключает защиту.
- **Объём**: базовое свойство `Volume` стратегии.

## Особенности реализации
- Для сглаживания используются индикаторы StockSharp. Отсутствующие типы (JJMA, JurX, ParMA, VIDYA) заменены экспоненциальным усреднением.
- Обработка идёт только по закрытым свечам, что соответствует проверке `IsNewBar` в исходнике.
- Хранится минимально необходимая история значений (без тяжёлых коллекций).
- Если стоп и тейк равны нулю, `StartProtection()` всё равно вызывается для корректного жизненного цикла стратегии.

## Рекомендации по использованию
- Убедитесь, что коннектор предоставляет свечи выбранных таймфреймов.
- Настройте длины и типы сглаживания под инструмент; при оптимизации можно использовать встроенные параметры.
- При разных таймфреймах для лонгов и шортов индикаторы отображаются на отдельных областях графика.

## Ограничения по сравнению с версией MQL5
- Режимы мани-менеджмента (MM, MarginMode) не реализованы; объём задаётся свойством `Volume`.
- Экзотические типы сглаживания из `SmoothAlgorithms.mqh` заменены на близкие аналоги.
- Стоп- и лимит-заявки преобразованы в общие уровни защиты стратегии.
