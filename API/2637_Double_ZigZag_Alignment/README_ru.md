# Стратегия Double ZigZag Alignment
[English](README.md) | [中文](README_cn.md)

Стратегия является портом советника MQL5 «Double ZigZag». Она воспроизводит логику двойного ZigZag за счёт двух детекторов
разворотов с разными глубинами. Сделка формируется только тогда, когда оба детектора подтверждают три последовательных экстремума,
а последняя волна достаточно сильна относительно предыдущих.

## Концепция

- Быстрый детектор свингов аппроксимирует настройки ZigZag(13, 5, 3) с помощью скользящих максимумов и минимумов.
- Медленный детектор использует увеличенное окно (по умолчанию в 8 раз больше), чтобы отфильтровывать менее значимые развороты.
- Если оба детектора меняют направление на одной свече, фиксируется «совпадающий» экстремум вместе с количеством быстрых свингов,
  случившихся с момента прошлого совпадения. Эти счётчики полностью соответствуют переменным `up` и `dw` из исходного эксперта.

## Условия входа в лонг

1. Последний совпадающий экстремум — максимум, предыдущий — минимум, третий — снова максимум.
2. Число быстрых свингов после последнего совпадения больше, чем `StrengthMultiplier` (2.1 по умолчанию), умноженный на счётчик
   предыдущего сегмента (`up > dw * k`).
3. Новый максимум пробивает средний минимум сильнее, чем более старый максимум: `(previousHigh - swingLow) * BreakoutMultiplier <
   (newestHigh - swingLow)`.
4. При выполнении условий стратегия покупает объём, равный `Volume` плюс размер открытого шорта, чтобы итоговая позиция стала
   длинной.

## Условия входа в шорт

1. Последний совпадающий экстремум — минимум, предыдущий — максимум, третий — снова минимум.
2. Счётчик последнего сегмента меньше, чем предыдущий, умноженный на `StrengthMultiplier` (`up * k < dw`).
3. Текущий минимум пробивает средний максимум сильнее, чем прошлый минимум, с тем же коэффициентом `BreakoutMultiplier`.
4. Стратегия продаёт объём, достаточный для закрытия лонга и открытия короткой позиции.

## Управление позицией

- Сигналы взаимоисключающие: новое направление автоматически закрывает позицию противоположного знака.
- Стоп-лоссы и тейк-профиты не используются — выход происходит только по встречному сигналу.
- Анализ ведётся по типу свечей `CandleType` (по умолчанию таймфрейм 1 минута).

## Параметры по умолчанию

- `FastLength` = 13
- `SlowLength` = 104
- `StrengthMultiplier` = 2.1
- `BreakoutMultiplier` = 2.1
- `CandleType` = таймфрейм `TimeSpan.FromMinutes(1)`

## Теги

- **Категория**: Следование тренду / Паттерны
- **Направление**: Лонг и шорт
- **Индикаторы**: ZigZag (аппроксимация), Highest/Lowest
- **Стопы**: Нет
- **Таймфрейм**: Внутридневной по умолчанию
- **Сложность**: Средняя (нужно синхронно отслеживать свинги)
- **Сезонность**: Нет
- **Нейросети**: Нет
- **Дивергенция**: Нет
- **Риск**: Средний из-за отсутствия защитных стопов
