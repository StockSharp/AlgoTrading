# Universal Signal Demo
[English](README.md) | [中文](README_cn.md)

Стратегия повторяет эксперта MetaTrader 5 «Universal Signal», используя высокоуровневые API StockSharp. Восемь взвешенных рыночных паттернов объединяются в единый интегральный балл. Когда балл превышает заданные пороги, стратегия открывает или закрывает длинные и короткие позиции, при необходимости размещая отложенные лимитные заявки с ограниченным временем жизни.

## Параметры стратегии
- `CandleType` – тип свечей, используемых в расчётах.
- `SignalThresholdOpen` – минимальный интегральный балл для открытия позиции.
- `SignalThresholdClose` – противоположный балл, необходимый для закрытия позиции.
- `PriceLevel` – смещение цены для отложенных лимитных заявок (0 – исполнение по рынку).
- `StopLevel` / `TakeLevel` – абсолютные расстояния стоп-лосса и тейк-профита, применяемые модулем защиты.
- `SignalExpiration` – количество баров, после которых неисполненные заявки отменяются.
- `Pattern0Weight` … `Pattern7Weight` – веса каждого паттерна перед суммированием.
- `UniversalWeight` – глобальный множитель, применяемый к сумме всех вкладов.
- `ShortMaPeriod`, `LongMaPeriod`, `RsiPeriod`, `BollingerPeriod`, `BollingerWidth`, `TrendSmaPeriod`, `VolumeSmaPeriod` – настройки индикаторов для проверок паттернов.

## Логика торговли
1. Подписка на поток выбранных свечей и привязка EMA, RSI, MACD Signal, полос Боллинджера и дополнительных SMA.
2. После формирования каждой свечи вычисляются восемь булевых паттернов: направленность тренда, импульс RSI, гистограмма MACD, расположение относительно средней полосы, направление свечи и расширение объёма.
3. Каждый паттерн умножается на свой вес, затем суммы масштабируются глобальным весом.
4. Позиции закрываются, когда балл пересекает порог закрытия в противоположную сторону.
5. Новые позиции открываются при превышении порога открытия. Если `PriceLevel` больше нуля, подаётся лимитная заявка со смещением и автоматической отменой через `SignalExpiration` баров.
6. Метод `StartProtection` устанавливает фиксированные стоп-лосс и тейк-профит для всех сделок, используя стандартные инструменты управления рисками StockSharp.

Такой перенос сохраняет гибкость оригинального эксперта MQL5 и при этом соответствует соглашениям StockSharp и индикаторному подходу.
