# Стратегия Crypto Scalper Momentum

## Общая информация

**Crypto Scalper Momentum** — это перенос советника MetaTrader «Crypto Scalper» на платформу StockSharp. Стратегия сочетает MFI, Momentum и MACD на разных таймфреймах. Основной поток сигналов берётся с рабочего таймфрейма, Momentum подтверждает импульс на старшем периоде, а медленный MACD не позволяет торговать против глобального тренда и закрывает позиции при его смене. Дополнительно реализованы валютные цели, трейлинг прибыли и контроль просадки, присутствовавшие в оригинале.

## Логика торговли

1. **Базовые индикаторы**
   - Money Flow Index (по умолчанию 14 баров) на рабочем таймфрейме.
   - MACD (12/26/9) на том же таймфрейме.
2. **Импульс на старшем периоде**
   - Индикатор Momentum на отдельной серии свечей. Проверяется модуль отклонения от базового уровня MetaTrader (100).
3. **Макро-фильтр**
   - MACD на медленном таймфрейме (по умолчанию дневной) запрещает входы против тренда и закрывает позиции при смене направления.
4. **Условия входа**
   - **Покупка**: одно из последних трёх значений MFI ниже порога перепроданности, Momentum превышает заданный порог, основной MACD выше сигнальной линии, макро-MACD бычий.
   - **Продажа**: зеркально — MFI выше порога перекупленности, Momentum активен, основной MACD ниже сигнальной линии, макро-MACD медвежий.
5. **Выход**
   - Фиксированные стоп и тейк в пунктах.
   - Трейлинг по минимумам/максимумам свечей или классический шаговый трейлинг.
   - Перенос стопа в безубыток.
   - Принудительное закрытие при развороте макро-MACD.
   - Валютные и процентные цели, трейлинг прибыли в деньгах.
   - Контроль просадки по equity.

## Управление рисками

- **Стоп/Тейк**: задаются в пунктах и могут быть отключены.
- **Трейлинг**: выбор между экстремумами свечей и классическим шагом.
- **Безубыток**: перенос стопа после прохождения заданного расстояния.
- **Цели по прибыли**: закрытие корзины по сумме в валюте или проценту от стартового капитала, а также трейлинг плавающей прибыли.
- **Equity-стоп**: стратегия отслеживает максимум капитала и закрывает позиции при допустимой просадке.

## Основные параметры

| Параметр | Описание |
|----------|----------|
| `CandleType` | Рабочий таймфрейм. |
| `MomentumCandleType` | Таймфрейм для Momentum. |
| `MacroCandleType` | Таймфрейм для макро-MACD. |
| `MfiPeriod` | Период MFI. |
| `MfiOversold` / `MfiOverbought` | Уровни перепроданности / перекупленности. |
| `MomentumPeriod` | Период Momentum на старшем ТФ. |
| `MomentumThreshold` | Минимальное отклонение от уровня 100. |
| `MomentumReference` | Базовый уровень Momentum (обычно 100). |
| `MacdFastPeriod` / `MacdSlowPeriod` / `MacdSignalPeriod` | Параметры MACD на рабочем ТФ. |
| `MacroMacdFastPeriod` / `MacroMacdSlowPeriod` / `MacroMacdSignalPeriod` | Параметры MACD на макро-ТФ. |
| `TradeVolume` | Объём сделки. |
| `MaxTrades` | Максимум одновременных сделок в одном направлении (0 — без ограничений). |
| `UseStopLoss` / `StopLossPips` | Включение и размер стопа. |
| `UseTakeProfit` / `TakeProfitPips` | Включение и размер тейка. |
| `UseTrailingStop` | Включить трейлинг. |
| `UseCandleTrail` | Выбор типа трейлинга (по свечам или классический). |
| `TrailTriggerPips` / `TrailAmountPips` | Запуск и шаг классического трейлинга. |
| `CandleTrailLength` / `CandleTrailBufferPips` | Глубина истории и буфер для свечного трейлинга. |
| `UseBreakEven` / `BreakEvenTriggerPips` / `BreakEvenOffsetPips` | Настройки переноса в безубыток. |
| `UseMoneyTakeProfit` / `MoneyTakeProfit` | Валютная цель по всей корзине. |
| `UsePercentTakeProfit` / `PercentTakeProfit` | Процентная цель от стартового капитала. |
| `EnableMoneyTrailing` / `MoneyTrailTarget` / `MoneyTrailStop` | Трейлинг плавающей прибыли в валюте. |
| `UseEquityStop` / `EquityRiskPercent` | Допустимая просадка по equity. |
| `ForceExit` | Принудительное закрытие на следующей свече. |

## Примечания

- Пункты переводятся в цену через `PriceStep`. Если шаг цены недоступен, используется значение `0.0001`, что соответствует поведению MetaTrader.
- Для точного соответствия оригиналу можно подключить месячные свечи в параметре `MacroCandleType`. По умолчанию выбран дневной таймфрейм, чтобы стратегия работала на большинстве источников данных.
- Все комментарии в коде написаны на английском языке, как требует репозиторий.
