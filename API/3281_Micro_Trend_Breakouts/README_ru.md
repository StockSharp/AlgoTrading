# Стратегия Micro Trend Breakouts

## Обзор
**Micro Trend Breakouts** — это перенос советника MetaTrader «Micro Trend Breakouts» на высокоуровневый API StockSharp. Стратегия отслеживает короткие импульсные пробои, анализируя взаимное положение линейно-взвешенных средних, всплески Momentum и направленность MACD. В рынке удерживается не более одной позиции, решения принимаются по закрытиям свечей.

## Индикаторы
- **Линейно-взвешенные скользящие средние (LWMA)** — быстрый и медленный фильтры направления на рабочем таймфрейме.
- **Momentum** — модуль значения индикатора за последние три закрытые свечи должен превышать настраиваемый порог, что подтверждает ускорение цены.
- **MACD** — гистограмма используется как трендовый фильтр: основная линия должна располагаться выше сигнальной для покупок и ниже для продаж.

## Условия входа
1. Дождаться закрытия свечи нужного таймфрейма.
2. Для лонга быстрый LWMA должен быть выше медленного (для шорта — ниже).
3. Проверить микропробой: минимум свечи два бара назад должен быть ниже максимума предыдущей свечи (для продажи условие зеркальное).
4. Убедиться в наличии импульса — хотя бы одно из трёх последних абсолютных значений Momentum должно превышать порог.
5. Проверить MACD:
   - Лонг: основная линия MACD выше сигнальной независимо от положения относительно нуля.
   - Шорт: основная линия MACD ниже сигнальной независимо от положения относительно нуля.

При выполнении условий отправляется рыночная заявка с объёмом по параметру `Order Volume`.

## Выход и управление рисками
- Начальные стоп-лосс и тейк-профит задаются в шагах цены и вычисляются в момент входа. Значение `0` отключает соответствующий уровень.
- Модуль «безубытка» переносит стоп к цене входа после достижения заданной прибыли, при желании добавляя защитный зазор.
- Трейлинг-стоп подтягивает стоп после прохождения заданного профита: для лонга отталкивается от максимума, для шорта — от минимума, достигнутого после входа.
- На каждой закрытой свече проверяется, достигла ли цена стоп-лосса или тейк-профита. В случае срабатывания позиция закрывается рыночной заявкой и внутреннее состояние сбрасывается.

## Параметры
| Имя | Описание | Значение по умолчанию |
| --- | --- | --- |
| `Order Volume` | Объём рыночных заявок. | `1` |
| `Candle Type` | Таймфрейм анализа. | `15 минут` |
| `Fast LWMA` | Период быстрого LWMA. | `6` |
| `Slow LWMA` | Период медленного LWMA. | `85` |
| `Momentum Period` | Период индикатора Momentum. | `14` |
| `Momentum Threshold` | Минимальный модуль Momentum за три свечи. | `0.3` |
| `MACD Fast / Slow / Signal` | Периоды средних MACD. | `12 / 26 / 9` |
| `Stop Loss` | Расстояние до стопа в шагах цены (`0` — без стопа). | `20` |
| `Take Profit` | Расстояние до цели в шагах цены (`0` — без цели). | `50` |
| `Use Trailing` | Включение трейлинг-стопа. | `true` |
| `Trail Activation` | Прибыль в шагах для активации трейлинга. | `40` |
| `Trail Step` | Отступ трейлинг-стопа от экстремума. | `40` |
| `Use Breakeven` | Включение переноса стопа в безубыток. | `true` |
| `Breakeven Trigger` | Прибыль в шагах для срабатывания безубытка. | `30` |
| `Breakeven Padding` | Дополнительный зазор при переносе стопа. | `30` |

## Примечания
- Используется только один поток свечей и высокоуровневые методы, что соответствует общим требованиям по конвертации.
- Вместо привязки стопов к заявке применяется контроль закрытых свечей, при этом вызывается `StartProtection()`, чтобы базовый класс отслеживал позицию.
- Все комментарии в коде написаны на английском языке согласно инструкции.
