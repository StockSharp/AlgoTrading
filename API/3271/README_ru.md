# Стратегия Breakthrough Volatility
[English](README.md) | [中文](README_cn.md)

Стратегия Breakthrough Volatility ищет кратковременные всплески волатильности внутри бара. Она ждёт свечу, чей диапазон шире предыдущего, но не превышает его более чем на две нормализованные «пипсовые» величины. Если такая свеча закрывается выше открытия, стратегия покупает, если ниже — продаёт. Управление позицией выполняется с помощью фиксированных стопов, опционального трейлинг-стопа и механизма автоматического реверса после убыточной сделки.

## Логика торговли

1. **Фильтр расширения диапазона**
   - Рассчитывается текущий диапазон свечи (`High - Low`) и сравнивается с предыдущей свечой.
   - Требуется, чтобы текущий диапазон был больше, но не превышал предыдущий более чем на две нормализованные пипсы.
   - Это создаёт условия, когда волатильность растёт, но остаётся контролируемой, что указывает на возможный пробой без излишнего шума.
2. **Выбор направления**
   - Закрытие выше открытия — вход в длинную позицию.
   - Закрытие ниже открытия — вход в короткую позицию.
   - Опция «только одна позиция на бар» позволяет избежать повторных входов по той же свече.
3. **Сопровождение позиции**
   - Стоп-лосс и тейк-профит задаются в пунктах относительно цены входа.
   - При включённом трейлинг-стопе защитный уровень подтягивается после прохождения заданного расстояния в прибыльную сторону; параметр шага не даёт двигать стоп слишком часто.
   - Если сделка закрывается с убытком, стратегия может немедленно развернуться. Каждый реверс увеличивает дистанцию до тейк-профита, компенсируя рост риска. Максимальное число реверсов ограничено.

## Параметры

| Название | Описание | Значение по умолчанию | Оптимизация |
| --- | --- | --- | --- |
| `TradeVolume` | Базовый объём сделки. | `0.1` | Да |
| `StopLossPoints` | Дистанция стоп-лосса в пунктах. | `20` | Да |
| `TakeProfitPoints` | Дистанция тейк-профита в пунктах. | `10` | Да |
| `TrailingStopPoints` | Дистанция трейлинг-стопа в пунктах (`0` — выключен). | `25` | Нет |
| `TrailingStepPoints` | Минимальный шаг подтягивания трейлинг-стопа. | `5` | Нет |
| `OnlyOnePositionPerBar` | Запрет на несколько входов в течение одной свечи. | `true` | Нет |
| `UseAutoDigits` | Автонастройка размера пункта для инструментов с 3 или 5 знаками. | `true` | Нет |
| `ReverseAfterStop` | Включение реверса после убыточной сделки. | `true` | Нет |
| `MaxReverseOrders` | Максимальное число последовательных реверсов. | `2` | Нет |
| `TakeProfitIncrease` | Дополнительные пункты тейк-профита для каждого реверса. | `100` | Нет |
| `CandleType` | Тип и таймфрейм свечей для расчётов. | `TimeSpan.FromMinutes(1)` | Нет |

## Управление риском

- Все расстояния пересчитываются по шагу цены инструмента. Флаг автоопределения переводит пятизначные котировки в пипсовый формат.
- Трейлинг-стоп активируется только после прохождения заданного расстояния и сдвигает стоп не чаще указанного шага.
- Последовательность реверсов обнуляется после прибыльного выхода или при достижении лимита реверсов.

## Практические рекомендации

- Стратегия лучше всего работает на валютных парах с малым спредом, где небольшой всплеск волатильности может сигнализировать о начале импульса.
- Подбирайте таймфрейм свечей под торговую сессию. Значение по умолчанию (1 минута) подходит для высокочастотных пробоев.
- Реверсы совершаются сразу после фиксации убытка, поэтому убедитесь, что по счёту достаточно свободной маржи для серии сделок.
