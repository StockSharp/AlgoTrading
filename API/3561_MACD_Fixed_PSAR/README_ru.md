# Стратегия MACD Fixed PSAR

## Обзор
Стратегия представляет собой порт MetaTrader-советника **EA_MACD_FixedPSAR** на C#. Торговая идея основана на пересечениях MACD с фильтрацией по EMA, что позволяет искать развороты тренда. Механизмы управления рисками повторяют оригинал и включают фиксированный трейлинг-стоп и вариант с наращиваемым Parabolic SAR. Все расстояния задаются в пунктах и автоматически переводятся в денежные значения с учётом шага цены инструмента.

## Индикаторы
- `MovingAverageConvergenceDivergenceSignal` с периодами 12/26/9 для расчёта линий MACD и сигнальной линии.
- `ExponentialMovingAverage` (по умолчанию 26) выступает в роли трендового фильтра.

## Логика торговли
1. **Входы**
   - **Покупка**: MACD пересекает сигнальную линию снизу вверх, оставаясь ниже нуля; абсолютное значение MACD превышает порог *MACD Open Level*; EMA растёт относительно предыдущей свечи.
   - **Продажа**: MACD пересекает сигнальную линию сверху вниз, оставаясь выше нуля; абсолютное значение MACD превышает порог *MACD Open Level*; EMA снижается относительно предыдущей свечи.
2. **Выходы**
   - Обратное пересечение MACD с превышением порога *MACD Close Level*.
   - Срабатывание заданных уровней тейк-профита и стоп-лосса.
   - Дополнительный трейлинг-стоп:
     - **Fixed** — удерживает постоянную дистанцию от последнего закрытия.
     - **Fixed PSAR** — повторяет ступенчатое обновление Parabolic SAR из MQL-версии.

## Параметры
| Имя | Описание |
| --- | -------- |
| `Volume` | Объём сделок для рыночных ордеров. |
| `TakeProfitPips` | Размер тейк-профита в пунктах. |
| `StopLossPips` | Размер стоп-лосса в пунктах. |
| `TrailMode` | Режим трейлинг-стопа (`None`, `Fixed`, `FixedPsar`). |
| `TrailingStopPips` | Дистанция для фиксированного трейлинга. |
| `PsarStep` | Начальный коэффициент ускорения для PSAR. |
| `PsarMaximum` | Максимальный коэффициент ускорения для PSAR. |
| `MacdOpenLevelPips` | Минимальная величина MACD (в пунктах) для открытия позиции. |
| `MacdCloseLevelPips` | Минимальная величина MACD (в пунктах) для закрытия позиции. |
| `TrendPeriod` | Период EMA, применяемой как трендовый фильтр. |
| `CandleType` | Тип свечей, используемый при расчётах. |

## Дополнительно
- Перевод пунктов в цену учитывает шаг цены инструмента и специальную поправку для трёх- и пятизначных символов, как в MetaTrader.
- Обновление трейлинг-стопов происходит только по завершённым свечам, что снижает влияние рыночного шума.
- При наличии области графика стратегия отображает свечи, оба индикатора и метки сделок.
