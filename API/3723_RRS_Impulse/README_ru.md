# Стратегия RRS Impulse

**RRS Impulse** — это перенос эксперта MetaTrader «RRS Impulse» на высокоуровневый API StockSharp. В оригинале робот сочетал
фильтры RSI, стохастика и полос Боллинджера, переключал режимы силы сигналов и использовал виртуальные стопы с трейлингом. В
версии на C# сохранена та же логика, но реализация целиком построена на высокоуровневых вызовах: свечные подписки питают
индикаторы, а заявки выставляются методами `BuyMarket`, `SellMarket` и `ClosePosition`.

## Торговая логика

1. **Режимы индикаторов** — четыре варианта поведения:
   - `Rsi`: торгуем, когда RSI выходит из зоны перекупленности/перепроданности.
   - `Stochastic`: одновременно требуются уровни %K и %D выше/ниже заданных порогов.
   - `BollingerBands`: реакция на закрытие свечи выше верхней или ниже нижней полосы.
   - `RsiStochasticBollinger`: сигнал возникает только при единогласном подтверждении всех трёх фильтров.
2. **Направление торговли** — `Trend` следует за показаниями индикатора (перекупленность → продажи), а `CounterTrend`
   отыгрывает разворот (перекупленность → покупки).
3. **Сила сигнала** — определяет, сколько таймфреймов должны совпасть:
   - `SingleTimeFrame`: используется только базовый таймфрейм `CandleType`.
   - `MultiTimeFrame`: требуется подтверждение на M1, M5, M15, M30, H1 и H4.
   - `Strong`: концентрируется на внутридневном импульсе (M1, M5, M15, M30).
   - `VeryStrong`: использует всю лестницу M1…H4. При комбинированном режиме индикаторов каждый таймфрейм должен выполнить
     условия всех трёх фильтров.
4. **Риск-менеджмент** — для каждой позиции отслеживаются три виртуальных условия выхода:
   - фиксированный стоп-лосс в пунктах;
   - фиксированный тейк-профит в пунктах;
   - трейлинг-стоп, активируемый после достижения `TrailingStartPips` и сопровождаемый отступом `TrailingGapPips`.
   При смене направления стратегия сначала вызывает `ClosePosition()`, чтобы закрыть текущую позицию, и только на следующей
   проверке при наличии подтверждения открывает противоположную сделку.

## Параметры

| Группа      | Параметр | Описание |
|-------------|----------|----------|
| Data        | `CandleType` | Базовая свечная серия для расчётов. |
| Orders      | `TradeVolume` | Объём рыночных заявок. |
| Risk        | `StopLossPips`, `TakeProfitPips`, `TrailingStartPips`, `TrailingGapPips` | Виртуальные защитные расстояния в пунктах. |
| Signals     | `IndicatorMode`, `TradeDirection`, `SignalStrength` | Переключатели поведения, повторяющие входные параметры MQL. |
| RSI         | `RsiPeriod`, `RsiUpperLevel`, `RsiLowerLevel` | Настройки RSI для выявления перекупленности/перепроданности. |
| Stochastic  | `StochasticKPeriod`, `StochasticDPeriod`, `StochasticSlowing`, `StochasticUpperLevel`, `StochasticLowerLevel` | Параметры медленного стохастика. |
| Bollinger   | `BollingerPeriod`, `BollingerDeviation` | Длина расчёта и множитель отклонения полос Боллинджера. |

Диапазоны оптимизации сохранены там, где они присутствовали в оригинальном советнике (стопы, тейки, уровни осцилляторов).

## Требования к данным

Стратегии нужны минутные свечи для лестницы подтверждений. Если выбран более строгий режим `SignalStrength`, нужные таймфреймы
подписываются автоматически (метод `GetWorkingSecurities` сообщает о них движку). Потоки Level1 не используются: решения
принимаются только по закрытым свечам, что полностью повторяет «виртуальные» стопы и тейки MQL-версии.

## Особенности портирования

- Случайный перебор символов из MetaTrader убран: стратегии StockSharp работают с одним `Security`, поэтому акцент сделан на
  точном повторении логики фильтров и выходов, а выбор инструментов остаётся за пользователем.
- Управление позициями реализовано через рыночные команды — при смене направления или срабатывании защитного условия вызывается
  `ClosePosition()`, что соответствует циклам `OrderClose` в исходном коде.
- Все комментарии в коде написаны на английском языке, а отступы выполнены табуляцией в соответствии с требованиями репозитория.
