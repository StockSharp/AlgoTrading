# AFStar Strategy
[Русский](README_ru.md) | [中文](README_cn.md)

The AFStar strategy scans for short-term momentum shifts by combining a wide
range of fast/slow EMA crossovers with a Williams %R channel breakout filter.
Only when both components agree does the strategy generate actionable signals.

A buy arrow is produced when at least one fast EMA (within the configured
interval) crosses above a compatible slow EMA while the Williams %R based
oscillator escapes from the lower band after staying inside the neutral zone.
A sell arrow is generated by the symmetric conditions for bearish crossovers
and an exit from the upper band. Signals are executed after the configured
number of bars defined by the **Signal Bar** parameter, just like in the
original MetaTrader expert.

Once a position is open the strategy can optionally attach protective stop loss
and take profit levels expressed in price steps. Those protections are checked
on every closed candle. All trades use the constant **Order Volume** parameter
so the complex money-management rules from the MQL5 version are replaced with a
simpler fixed-size approach.

## Entry Logic

- **Long:**
  - At least one fast EMA within `[Start Fast, End Fast]` rises above a slow EMA
    within `[Start Slow, End Slow]` using the `Step Period` increment.
  - The Williams %R channel, evaluated with risk values in the
    `[Start Risk, End Risk]` range and `Risk Step`, detects a break above the
    upper boundary after spending time inside the neutral band.
  - Optional short positions are closed beforehand when **Enable Sell Exits**
    is turned on.
- **Short:**
  - Symmetric crossover and Williams %R breakout in the opposite direction.
  - Optional long exits occur first when **Enable Buy Exits** is enabled.

## Exit Logic

- Opposite arrows close positions when the corresponding exit flags are enabled
  (buy arrows close shorts, sell arrows close longs).
- Optional stop loss and take profit levels measured in price steps can close
  positions earlier if price reaches those thresholds.

## Parameters

- **Order Volume** – trade size used for market orders.
- **Candle Type** – timeframe for market data (defaults to 4-hour candles).
- **Start Fast / End Fast / Step Period** – fast EMA range for crossover scan.
- **Start Slow / End Slow** – slow EMA range paired with the fast EMA values.
- **Start Risk / End Risk / Risk Step** – Williams %R risk scan boundaries.
- **Signal Bar** – number of finished bars to wait before executing a signal.
- **Stop Loss (pips)** – optional stop loss distance in price steps.
- **Take Profit (pips)** – optional take profit distance in price steps.
- **Enable Buy Entries / Enable Sell Entries** – allow long or short entries.
- **Enable Buy Exits / Enable Sell Exits** – enable closing in the opposite
  direction.

## Notes

- The strategy keeps up to 512 recent candles to evaluate the AFStar logic.
- If price steps are not available for the security, a value of 1 is used when
  calculating stop-loss and take-profit distances.
- Signals are queued so that setting **Signal Bar = 0** executes immediately,
  while higher values delay execution by that many completed bars.
