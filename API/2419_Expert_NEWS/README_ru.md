# Стратегия Expert NEWS

## Обзор
Стратегия Expert NEWS представляет собой конверсию MQL5-советника «Expert_NEWS». Алгоритм постоянно размещает симметричные стоп-заявки выше и ниже текущей цены и управляет открытыми позициями с помощью перевода в безубыток, трейлинга и плановых обновлений отложенных ордеров. Реализация использует только потоковые котировки Level1, а базовый объём сделки равен 0.1 лота.

## Логика работы
1. **Подписка на котировки** – стратегия отслеживает лучшие цены спроса/предложения и рассчитывает уровни ордеров по свежим данным.
2. **Стартовые стоп-заявки** – при отсутствии длинной позиции и активного buy stop выставляется ордер по цене `ask + EntryOffsetTicks * PriceStep`; при отсутствии короткой позиции и sell stop размещается ордер по цене `bid - EntryOffsetTicks * PriceStep`.
3. **Обновление заявок** – каждые `OrderRefreshSeconds` секунд ордер отменяется и перевыставляется, если нужная цена изменилась больше чем на `TrailingStepTicks` тик.
4. **Защита позиции** – после срабатывания ордера открываются защитные stop и take-profit, если выбранные расстояния удовлетворяют ограничению `MinimumStopTicks`.
5. **Безубыток** – при активном `UseBreakEven` стоп переносится к `entry ± BreakEvenProfitTicks`, когда прибыль достаточна и новый уровень соблюдает минимальное расстояние от текущей цены.
6. **Трейлинг-стоп** – после достижения прибыли `TrailingStartTicks` стоп следует за ценой на расстоянии `TrailingStopTicks`, а каждое обновление требует минимум `TrailingStepTicks` тиков улучшения.
7. **Очистка** – закрытие позиции приводит к отмене всех оставшихся защитных заявок.

## Параметры
| Параметр | Описание |
|----------|----------|
| `StopLossTicks` | Начальное расстояние защитного стопа в тиках. Ноль отключает стартовый стоп. |
| `TakeProfitTicks` | Начальное расстояние тейк-профита в тиках. Ноль отключает тейк-профит. |
| `TrailingStopTicks` | Расстояние трейлинг-стопа в тиках. |
| `TrailingStartTicks` | Минимальная прибыль в тиках, необходимая для запуска трейлинга. |
| `TrailingStepTicks` | Минимальное улучшение при обновлении трейлинг-стопа или при перерегистрации отложенных ордеров. |
| `UseBreakEven` | Включает перенос стопа в безубыток при достижении цели по прибыли. |
| `BreakEvenProfitTicks` | Дополнительная подушка прибыли при переносе стопа в безубыток. |
| `EntryOffsetTicks` | Расстояние между текущей ценой и новыми стоп-заявками на вход. |
| `OrderRefreshSeconds` | Интервал между автоматическими попытками обновить отложенные стопы (в секундах). |
| `MinimumStopTicks` | Минимально допустимое расстояние стопов (в тиках). Ордеры ближе не отправляются. |

## Управление позицией
- Защитные заявки всегда соответствуют объёму текущей позиции; частичные исполнения автоматически уменьшают или увеличивают объём stop/limit заявок.
- Даже при отключённом стартовом стопе механизмы безубытка и трейлинга создадут новый стоп, как только условия будут выполнены.
- Стратегия запоминает последнюю цену стопа, поэтому трейлинг обновляет уровень только в одном направлении.

## Рекомендации по использованию
- Убедитесь, что задан `Security.PriceStep`, поскольку все параметры в тиках домножаются на этот шаг цены.
- Значение `Volume` по умолчанию равно `0.1`, что соответствует исходному роботу. При необходимости измените объём в свойствах стратегии.
- Если площадка предъявляет требования к минимальной дистанции стопов, укажите её в `MinimumStopTicks`. При отсутствии ограничений оставьте параметр равным нулю.
- Алгоритм не использует свечи или исторические данные; для работы достаточно потоковых котировок.
