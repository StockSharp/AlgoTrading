# Стратегия синхронизации символов

## Обзор
**Symbol Sync Strategy** переносит функциональность утилиты MetaTrader `SymbolSyncEA` в среду StockSharp. Стратегия отслеживает активный символ и автоматически назначает его всем привязанным стратегиям. При изменении главного инструмента все подключённые стратегии получают тот же `Security`, поэтому рабочее пространство остаётся согласованным без ручного вмешательства.

## Ключевые идеи
- Сохранять исходный инструмент при запуске и использовать его как резервную точку возврата.
- Поддерживать настраиваемый список стратегий, которые должны следовать за главным символом.
- Позволять менять инструмент как прямым присвоением `Security`, так и через идентификатор.
- Предоставлять методы ручной синхронизации и возврата к исходному инструменту, повторяя поведение исходного эксперта.

## Параметры
| Имя | Описание | Значение по умолчанию |
| --- | -------- | --------------------- |
| `ChartLimit` | Максимальное число стратегий, которые будут синхронизированы. Защищает от случайных массовых изменений. | `10` |
| `SyncSecurityId` | Идентификатор инструмента, распространяемый на привязанные стратегии. Пустое значение означает использование текущего инструмента стратегии. | `""` |

## Публичные методы
- `RegisterLinkedStrategy(Strategy strategy)` — добавляет стратегию в список синхронизации и возвращает `true` при успехе.
- `UnregisterLinkedStrategy(Strategy strategy)` — удаляет стратегию из списка.
- `ChangeSyncSecurity(Security security)` — назначает указанный инструмент и синхронизирует все привязанные стратегии.
- `ChangeSyncSecurity(string securityId)` — пытается найти инструмент по идентификатору через `SecurityProvider` и вызывает предыдущий метод.
- `ResetToInitialSecurity()` — возвращает инструмент, зафиксированный при старте.
- `SyncSymbols()` — запускает принудительную синхронизацию без изменения сохранённого идентификатора.

## Последовательность использования
1. Создайте `SymbolSyncStrategy`, задайте основной `Security` или установите `SyncSecurityId` до запуска.
2. Вызовите `RegisterLinkedStrategy` для каждой дочерней стратегии, которой требуется следовать за активным инструментом (например, разные таймфреймы или панели мониторинга).
3. При смене главного инструмента вызывайте `ChangeSyncSecurity(Security)` либо `ChangeSyncSecurity(string)`.
4. При необходимости вызывайте `SyncSymbols()`, если внешний компонент мог изменить дочернюю стратегию.

## Отличия от версии MQL
- Работает со стратегиями StockSharp вместо окон графиков MetaTrader.
- Использует `SecurityProvider` для поиска инструментов по идентификатору.
- Добавляет защитное логирование и ограничение на количество синхронизируемых стратегий.
- Предоставляет явные методы сброса и ручной синхронизации для сложных сценариев автоматизации.

## Примечания
- Стратегия не размещает торговые приказы — это вспомогательный инфраструктурный компонент.
- Комментарии в коде оставлены на английском языке в соответствии с требованиями проекта.
