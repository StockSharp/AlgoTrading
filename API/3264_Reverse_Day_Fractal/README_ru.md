# Reverse Day Fractal Strategy

## Обзор
Reverse Day Fractal — стратегия price action, отслеживающая резкие развороты после внутридневного пробоя. Алгоритм анализирует три последние завершённые свечи. Если текущая свеча формирует новый экстремум за пределами двух предыдущих свечей и закрывается в противоположную сторону, модель воспринимает ситуацию как ложный пробой и открывает сделку в сторону разворота. Защитные ордера управляются параметрами тейк-профита, стоп-лосса и трейлинг-стопа, заданными в шагах цены.

## Торговая логика
- **Бычий сценарий**:
  - Текущая завершённая свеча показывает *более низкий* минимум по сравнению с двумя предыдущими свечами.
  - Свеча закрывается *выше* цены открытия, что подтверждает отскок от нового минимума.
  - При выполнении условий и наличии разрешения на торговлю стратегия открывает длинную позицию. При необходимости она предварительно закрывает существующий шорт.
- **Медвежий сценарий**:
  - Текущая завершённая свеча показывает *более высокий* максимум, чем две предыдущие.
  - Свеча закрывается *ниже* цены открытия, что подтверждает откат от нового максимума.
  - При выполнении условий открывается короткая позиция, при необходимости закрывается текущий лонг.
- **Управление позицией**: по умолчанию разрешена только одна открытая позиция. Если параметр отключить, стратегия будет разворачивать позицию, добавляя объём, достаточный для смены направления.
- **Контроль рисков**: при запуске вызывается `StartProtection`, который активирует тейк-профит, стоп-лосс и трейлинг-стоп с заданными расстояниями в шагах цены. При включённом трейлинге стоп подтягивается ступенчато.

## Параметры
- `Trade Volume` – объём заявки для новых входов.
- `Take Profit` – расстояние до цели в шагах цены (0 — выключено).
- `Stop Loss` – расстояние до защитного стопа в шагах цены (0 — выключено).
- `Trailing Stop` – расстояние трейлинг-стопа в шагах цены (0 — выключено).
- `Trailing Step` – минимальное движение (в шагах), необходимое для подтяжки трейлинг-стопа.
- `Only One Position` – при включении новые сигналы игнорируются, пока позиция не закрыта.
- `Candle Type` – тип свечных данных для расчётов (по умолчанию часовой таймфрейм).

## Примечания
- Сигналы формируются только по завершённым свечам, поступающим из выбранной подписки.
- Для формирования сигнала необходимы как минимум две завершённые свечи после старта, чтобы заполнить историю экстремумов.
- Значения по умолчанию соответствуют оригинальному советнику MQL4: объём 0.01 лота, стоп-лосс 20 пунктов, тейк-профит 10 пунктов, трейлинг-стоп 25 пунктов и шаг трейлинга 5 пунктов.
