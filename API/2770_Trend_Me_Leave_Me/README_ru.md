# Стратегия Trend Me Leave Me

## Обзор
**Trend Me Leave Me** — это точная конверсия классического советника MQL5 Юрия Решетова. Стратегия терпеливо ждёт спокойные
периоды рынка, входит в направлении Parabolic SAR и после прибыльной сделки меняет сторону. Если позиция закрывается по стопу,
алгоритм снова попытает ту же сторону, полностью повторяя исходную логику "trend me, leave me". Реализация на C# использует
высокоуровневый API StockSharp и предоставляет доступ ко всем числовым параметрам оригинала.

## Ключевые идеи
### Фильтр спокойного рынка
- Индикатор Average Directional Index (ADX) с периодом `AdxPeriod` измеряет силу тренда.
- Новые входы разрешены только тогда, когда скользящее среднее ADX опускается ниже `AdxQuietLevel`, что соответствует поиску
  низковолатильных откатов в исходном советнике.

### Тайминг по Parabolic SAR
- Точки Parabolic SAR задают направление. Лонг возможен, когда закрытие свечи выше точки SAR, шорт — когда закрытие ниже.
- Параметры `SarStep` и `SarMax` повторяют настройки ускорения из MQL и при необходимости могут оптимизироваться.

### Планировщик направления
- Внутренний флаг `TradeDirections` заменяет переменную `cmd`. На старте он находится в состоянии *buy*.
- После выхода по **тейк-профиту** флаг переключается на противоположную сторону и стратегия ищет разворотную сделку.
- После **стоп-лосса** (или срабатывания безубыточности) флаг сохраняет прежнюю сторону, чтобы повторить попытку.

## Управление позицией
- `StopLossPips` и `TakeProfitPips` задают фиксированные расстояния от средней цены входа. Значение `0` отключает соответствующую
  защиту.
- `BreakevenPips` переносит стоп в точку входа после движения в прибыль на заданное количество пунктов. Возврат цены к входу
  закрывает сделку около нуля и оставляет флаг направления без изменений.
- Проверка стопов и целей выполняется по завершённой свече с учётом High/Low, что максимально приближает поведение к тиковому
  исполнению исходного эксперта.

## Управление объёмом
- Объём заявок определяется базовым свойством `Strategy.Volume`. В примере не используется объект `CMoneyFixedRisk` из MQL — при
  необходимости можно изменить `Volume` или расширить стратегию для более сложного манименеджмента.

## Параметры
| Параметр | Описание | Значение по умолчанию |
|----------|----------|-----------------------|
| `StopLossPips` | Расстояние до защитного стопа в пунктах. | `50` |
| `TakeProfitPips` | Расстояние до тейк-профита в пунктах. | `180` |
| `BreakevenPips` | Перевод стопа в безубыток после указанного движения. | `5` |
| `AdxPeriod` | Период сглаживания ADX. | `14` |
| `AdxQuietLevel` | Максимальное значение ADX для входа. | `20` |
| `SarStep` | Шаг ускорения Parabolic SAR. | `0.02` |
| `SarMax` | Максимальное ускорение Parabolic SAR. | `0.2` |
| `CandleType` | Таймфрейм расчёта. | Свечи 1 час |

## Особенности реализации
- Размер пункта вычисляется как шаг цены, умноженный на 10 для инструментов с 3 или 5 знаками после запятой — как и в MQL.
- Индикаторы подключены через высокоуровневый API StockSharp, сделки выполняются рыночными заявками `BuyMarket`/`SellMarket`.
- Python-версия намеренно отсутствует, папка `PY/` не создавалась согласно задаче.
- Перед запуском стратегии выберите инструмент, установите `Volume` и настройте параметры под волатильность конкретного рынка.
