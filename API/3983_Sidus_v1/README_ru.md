# Стратегия Sidus v1

## Обзор
Sidus v1 — трендовая стратегия, сочетающая две пары экспоненциальных скользящих средних (EMA) и фильтры индикатора RSI. Исходный советник MetaTrader 4 открывает сделку, когда быстрая EMA заметно отклоняется от медленной, а RSI подтверждает перепроданность или перекупленность. В версии для StockSharp сохранена логика исходника: торговля разрешается только на свечах с низким объёмом, а для длинных и коротких позиций выставляются асимметричные защитные ордера.

## Используемые индикаторы
- **Быстрая EMA (для покупок)** — оценивает краткосрочный импульс.
- **Медленная EMA (для покупок)** — фильтр направления тренда для длинных сделок.
- **Быстрая EMA (для продаж)** — измеряет импульс перед короткими сделками.
- **Медленная EMA (для продаж)** — фильтр тренда перед короткими сделками.
- **RSI (для покупок)** — подтверждает зону перепроданности.
- **RSI (для продаж)** — подтверждает зону перекупленности.

## Логика торговли
1. Подписка на свечной поток с выбранным таймфреймом (по умолчанию 15 минут).
2. На каждой завершённой свече пересчитываются все EMA и RSI.
3. Если объём свечи превышает заданный порог, сигналы игнорируются.
4. **Покупка** выполняется, когда:
   - Разность быстрой и медленной EMA меньше заданного порога.
   - Значение RSI ниже порога для покупок.
   - Текущая позиция не длинная (нет положительного нетто-объёма).
5. **Продажа** выполняется, когда:
   - Разность «коротких» EMA выше порога для продаж.
   - Значение RSI выше порога для продаж.
   - Текущая позиция не короткая (нет отрицательного нетто-объёма).
6. При появлении сигнала отменяются активные защитные ордера, отправляется рыночный ордер нужного объёма (при необходимости разворот позиции), затем сразу выставляются соответствующие take-profit и stop-loss.

## Управление рисками
- Для длинных позиций take-profit размещается на `entry + BuyTakeProfitPips * priceStep`, stop-loss — на `entry - BuyStopLossPips * priceStep`.
- Для коротких позиций take-profit размещается на `entry - SellTakeProfitPips * priceStep`, stop-loss — на `entry + SellStopLossPips * priceStep`.
- Расстояния задаются в пунктах и переводятся в цену через шаг цены инструмента. При необходимости скорректируйте параметры под шаг цены выбранного актива.

## Параметры
| Параметр | Описание | Значение по умолчанию |
|----------|----------|-----------------------|
| `FastEmaLength` | Длина быстрой EMA для покупок. | 23 |
| `SlowEmaLength` | Длина медленной EMA для покупок. | 62 |
| `FastEma2Length` | Длина быстрой EMA для продаж. | 18 |
| `SlowEma2Length` | Длина медленной EMA для продаж. | 54 |
| `RsiPeriod` | Период RSI для фильтра покупок. | 67 |
| `RsiPeriod2` | Период RSI для фильтра продаж. | 97 |
| `BuyDifferenceThreshold` | Максимальная разница EMA для открытия покупок. | 63 |
| `BuyRsiThreshold` | Максимальный уровень RSI для покупок. | 59 |
| `SellDifferenceThreshold` | Минимальная разница EMA для открытия продаж. | -57 |
| `SellRsiThreshold` | Минимальный уровень RSI для продаж. | 60 |
| `BuyTakeProfitPips` | Дистанция take-profit (пункты) для длинных сделок. | 95 |
| `BuyStopLossPips` | Дистанция stop-loss (пункты) для длинных сделок. | 100 |
| `SellTakeProfitPips` | Дистанция take-profit (пункты) для коротких сделок. | 17 |
| `SellStopLossPips` | Дистанция stop-loss (пункты) для коротких сделок. | 69 |
| `OrderVolume` | Объём новой позиции. | 0.5 |
| `MaxCandleVolume` | Максимальный объём свечи для входа. | 10 |
| `CandleType` | Таймфрейм расчёта индикаторов. | 15-минутные свечи |

## Рекомендации по использованию
- Убедитесь, что выбранный брокер/площадка поддерживает одновременные рыночные, стоп- и лимитные ордера.
- Подстройте параметры в пунктах под шаг цены конкретного инструмента — в MT4 стратегия использовала значение `Point`.
- Стратегия работает с неттинговой позицией: при смене направления сначала закрывается противоположный объём и только затем открывается новая позиция.
