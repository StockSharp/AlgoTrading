# 自定义图表监控策略

## 概述
**Custom Chart Monitor Strategy** 复刻了 MetaTrader 5 专家顾问 *Example1_LibCustomChart.mq5* 的思路。原脚本演示如何使用 `LibCustomChart` 库访问自定义图表数据。本版 StockSharp 策略专注于订阅指定的蜡烛序列，输出正在形成的柱子收盘价，并在出现新柱时给出提示。

该策略是教学示例，不会提交订单。它旨在展示如何在 StockSharp 中接入外部或合成的图表源，并在策略内部处理这些数据。

## MQL 原始逻辑
1. 加载 `LibCustomChart` 库。如果自定义图表已连接则读取其数据，否则回退到标准图表。
2. 在每个 tick 上刷新图表数据。
3. 读取最近一个（未完成）柱子的收盘价。
4. 打印收盘价，并在 `CustomChartNewBar()` 返回真时提示出现新柱。

StockSharp 实现通过蜡烛订阅和事件处理来完成上述流程，无需直接调用库函数。

## StockSharp 中的策略逻辑
1. 使用 `StrategyParam<DataType>` 参数选择要视为自定义图表的蜡烛类型，默认值为 1 分钟蜡烛。
2. 启动时调用 `SubscribeCandles()` 订阅该类型的蜡烛，并通过高层 API `Bind` 连接处理函数。
3. 每次接收到蜡烛更新时，处理函数都会记录当前收盘价，并跳过完全重复的更新以保持日志整洁。
4. 当蜡烛状态为 `CandleStates.Finished` 时，策略额外记录“New bar detected”信息，模拟 MQL 中的新柱提示。

这一结构可作为处理自定义指标、外部数据或合成蜡烛序列的模板。

## 参数
| 名称 | 类型 | 说明 |
| ---- | ---- | ---- |
| `Candle Type` | `DataType` | 指定哪一种蜡烛序列被视为自定义图表。请选择连接器支持的任意时间框架或蜡烛构建器。 |

## 使用步骤
1. 在启动前设置 `Security` 和 `Candle Type` 参数，使之对应需要监控的图表数据源。
2. 启动策略后，它会立即订阅蜡烛序列并开始在日志中输出最新收盘价。
3. 观察日志：每次更新会显示当前柱子的收盘价；当柱子完成时会额外输出“New bar detected”提示及时间戳。
4. 如果需要，可在现有处理方法中加入计算、交易决策或与其他系统的交互。

## 扩展建议
- 将日志输出替换为指标计算或数据转发，从而把监控到的图表信息用于后续分析。
- 如果需要比较自定义图表与标准图表，可以同时订阅其他蜡烛流并在处理函数中融合。
- 添加更多参数用于控制阈值、日志详细程度或基于观测数据自动下单。

## 说明
- 按要求未提供 Python 版本及其目录。
- 策略仅用于数据监控，不会发起任何交易指令。
- 请确保连接器能够提供所选的蜡烛类型，否则策略不会收到数据。
