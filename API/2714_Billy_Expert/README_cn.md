# Billy Expert Pullback Buyer
[English](README.md) | [Русский](README_ru.md)

## 概述
Billy Expert 是从 MetaTrader 5 专家顾问“Billy expert”移植而来的只做多回调策略。策略在基础周期上等待四根开盘价和最高价都持续下行的 K 线序列，然后在两个更高周期上的随机指标中寻找多头确认。当两个随机指标都显示动能转强时，系统在不超过最大持仓数的前提下加仓做多。

该实现遵循 StockSharp 的高级 API 要求，所有关键设置（下单量、最大仓位数量、止损和止盈）均通过策略参数暴露，以复刻原始 MQL 逻辑。

## 工作流程
1. 订阅基础 K 线序列（默认 1 分钟）以及两个用于随机指标的更高周期（默认 5 分钟和 6 分钟）。
2. 跟踪基础周期上最近四根已完成的 K 线。只有当这四根 K 线的最高价和开盘价都严格递减时才认为出现回调。
3. 计算快慢两个随机指标，要求在当前值和上一根值上，%K 都位于 %D 之上，表明动能已经在两个周期上同步转向多头。
4. 如果价格形态和动能过滤条件同时满足，且当前多头仓位数量少于 `MaxPositions`，则按 `TradeVolume` 下达市价买单。
5. 可选的止损与止盈以点（pip）为单位设置，并根据品种的 `PriceStep` 转换为绝对价差。若参数为 0，则不设置对应的保护单。
6. 仓位仅通过这些保护水平离场，以保持与原始 EA 一致的管理方式。

## 参数
- `TradeVolume`：每次下单的合约数量，默认 `0.01`。
- `StopLossPips`：止损距离（点），默认 `0`（不启用）。
- `TakeProfitPips`：止盈距离（点），默认 `32`。
- `MaxPositions`：最多同时持有的多头仓位数，默认 `6`。
- `Signal Candle`：用于形态判断的基础周期，默认 `1` 分钟。
- `Fast Stochastic TF`：快随机指标的周期，默认 `5` 分钟。
- `Slow Stochastic TF`：慢随机指标的周期，默认 `6` 分钟，必须长于快周期。

## 过滤条件与特性
- **方向**：仅做多。
- **入场条件**：四根连续 K 线的最高价和开盘价严格下降。
- **动能过滤**：快、慢随机指标的 %K 均在当前与上一根数值上高于 %D。
- **风险管理**：按点计算的止损和止盈，可选，无追踪机制。
- **仓位管理**：每次下单固定为 `TradeVolume`，且不超过 `MaxPositions`。
- **适用市场**：面向带有小数点报价的外汇品种，但任何提供有效 `PriceStep` 的资产均可使用。

## 使用提示
- 请确保 `Fast Stochastic TF` 严格小于 `Slow Stochastic TF`，否则策略会在启动时立即停止。
- 由于退出完全依赖止损/止盈，请根据标的波动性调整 `StopLossPips` 与 `TakeProfitPips`。
- 策略不会做空，也不会分批减仓，可结合账户级风险控制工具使用。
- 回测时需提供足够的历史数据，以便两个随机指标在首次信号前完成初始化。
