# Billy Expert Pullback Buyer
[English](README.md) | [中文](README_cn.md)

## Обзор
Billy Expert — конвертированная из MetaTrader 5 долгосрочная стратегия откатов. Она ожидает последовательность из четырёх свечей на базовом таймфрейме с понижающимися максимумами и ценами открытия, после чего проверяет подтверждение импульса двумя стохастиками на разных старших таймфреймах. Когда оба индикатора показывают, что покупатели вернулись, робот добавляет новую длинную позицию, пока не достигнет установленного лимита.

Конвертация выполнена с использованием высокоуровневого API StockSharp. Все ключевые параметры — объём сделки, количество одновременных входов, стоп-лосс и тейк-профит — доступны в настройках, чтобы поведение максимально соответствовало оригинальному советнику MQL.

## Как работает стратегия
1. Подписывается на основную свечную серию (по умолчанию 1 минута) и две дополнительные серии для стохастиков (по умолчанию 5 и 6 минут).
2. Отслеживает четыре последние завершённые свечи базового таймфрейма. Корректный откат требует строго убывающих максимумов *и* цен открытия.
3. Рассчитывает быстрый и медленный стохастические осцилляторы. Для входа необходимо, чтобы у обоих %K находился выше %D на текущем и предыдущем значениях.
4. При выполнении ценового и импульсного фильтров и если открыто меньше `MaxPositions` сделок, отправляется рыночная заявка на покупку объёмом `TradeVolume`.
5. Необязательные стоп-лосс и тейк-профит задаются в пунктах и преобразуются в абсолютное расстояние по `PriceStep`. Нулевая величина отключает соответствующий уровень защиты.
6. Выход из позиции происходит только по защитным уровням, как и в оригинальном советнике.

## Параметры
- `TradeVolume` – размер каждой сделки (по умолчанию `0.01`).
- `StopLossPips` – дистанция стоп-лосса в пунктах (по умолчанию `0`, отключено).
- `TakeProfitPips` – дистанция тейк-профита в пунктах (по умолчанию `32`).
- `MaxPositions` – максимум одновременно открытых длинных позиций (по умолчанию `6`).
- `Signal Candle` – базовый таймфрейм для анализа цены (по умолчанию `1` минута).
- `Fast Stochastic TF` – таймфрейм быстрого стохастика (по умолчанию `5` минут).
- `Slow Stochastic TF` – таймфрейм медленного стохастика (по умолчанию `6` минут), должен быть длиннее быстрого.

## Фильтры и поведение
- **Направление**: только покупки.
- **Условие входа**: четыре подряд свечи с падающими максимумами и открытиями.
- **Импульсный фильтр**: оба стохастика дают бычий сигнал (%K выше %D на двух последних значениях).
- **Управление риском**: опциональные стоп-лосс и тейк-профит в пунктах, без трейлинг-механизма.
- **Размер позиции**: фиксированный `TradeVolume` на вход, ограниченный `MaxPositions`.
- **Рынки**: оптимально для форекс-инструментов с дробными пунктами, но работает с любым активом, имеющим корректный `PriceStep`.

## Рекомендации
- Убедитесь, что `Fast Stochastic TF` строго меньше `Slow Stochastic TF`, иначе стратегия остановится при запуске.
- Настраивайте `StopLossPips` и `TakeProfitPips` под волатильность конкретного инструмента, так как других выходов нет.
- Стратегия не торгует шорт и не сокращает объём — при необходимости подключайте внешние лимиты риска.
- Для тестирования обеспечьте достаточную историю, чтобы оба стохастика успели сформироваться до первого сигнала.
