# 均线交叉策略

## 概述
该策略复刻了原始 MQL 移动平均线交叉专家顾问，使用 StockSharp 的高级 API 监控两条简单移动平均线。策略在每根完成的K线后更新指标，当快线从慢线下方穿越到上方时产生做多信号，反向穿越时产生做空信号，并可选择在出现反向信号时立即平掉当前持仓。

## 交易逻辑
- 订阅用户配置的K线类型，并在每根完成的K线上计算快慢 SMA。
- 当快线从下向上穿越慢线且没有持仓时，以设定的手数开多。
- 当快线从上向下穿越慢线且没有持仓时，以设定的手数开空。
- 如果开启“反向信号平仓”选项，在检测到反向交叉时立即平掉当前持仓。

## 风险控制
- 为每次开仓设置固定的止损和止盈，单位为品种的点值，开仓后重新计算价格位置。
- 当浮盈达到设定的触发点数后，将止损移动到保本价，并可额外保留一定点数作为锁定收益。
- 当利润达到设定的起始点数后启用移动止损，始终沿着最有利的价格调整止损，且不会逆向移动。

## 参数说明
- **Fast MA Period** – 快速SMA的周期。
- **Slow MA Period** – 慢速SMA的周期。
- **Trade Volume** – 下单手数。
- **Stop Loss (points)** – 初始止损的点数距离。
- **Take Profit (points)** – 初始止盈的点数距离。
- **Break-even Trigger** – 触发保本止损所需的利润点数。
- **Break-even Offset** – 保本后额外保留的利润点数。
- **Trailing Start** – 启动移动止损所需的利润点数。
- **Trailing Distance** – 移动止损与价格之间保持的点数距离。
- **Close On Opposite** – 是否在出现反向交叉时平仓。
- **Candle Type** – 用于计算指标的K线类型。

## 使用提示
- 请确保交易品种具备有效的 `PriceStep`。若缺失，则默认使用 1 作为点值。
- 保本和移动止损基于完成的K线进行计算，与原始 EA 在收盘价处理逻辑一致。
- 建议根据不同市场或时间框架对均线周期和风险参数进行优化。
