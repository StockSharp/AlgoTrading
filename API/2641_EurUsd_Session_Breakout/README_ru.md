# Стратегия EURUSD Session Breakout
[English](README.md) | [中文](README_cn.md)

Стратегия повторяет классическую идею по EUR/USD, когда узкий европейский утренний диапазон используется как трамплин для
американской сессии. Отслеживается скользящее окно из 24 свечей (по умолчанию 15-минутных), чтобы измерить диапазон перед американской сессией, отфильтровываются дни с диапазоном больше настраиваемого порога в пунктах, после чего совершаются пробойные сделки,
которые полностью выходят за пределы этого диапазона. За один торговый день допускается только одна попытка в лонг и одна в шорт.

## Логика работы

1. **Фиксация диапазона** – в начале заданного часа американской сессии фиксируется диапазон EU, построенный по 24 последним
   завершённым свечам (без текущей). Диапазон автоматически переводится в пункты для инструментов с 3 и 5 знаками.
2. **Фильтр узкого рынка** – торговля разрешается только если зафиксированный диапазон меньше параметра *Small EU Session (pips)*.
3. **Проверка пробоя** – в разрешённые часы американской сессии, и только между `(EU start hour + 5)` и `(EU start hour + 10)`, стратегия
   ищет свечи, полностью вышедшие за пределы диапазона с дополнительным буфером в пунктах (points).
4. **Исполнение** – рыночная покупка отправляется, если минимум свечи выше верхней границы диапазона плюс буфер. Рыночная продажа
   отправляется, если максимум свечи ниже нижней границы диапазона минус буфер. Флаги лонга и шорта независимы, поэтому в день
   возможна по одной сделке в каждом направлении.
5. **Управление риском** – стоп-лосс и тейк-профит задаются в пунктах, переводятся в абсолютные значения и контролируются на
   каждой завершённой свече по экстремумам high/low.

## Параметры

- **EU Session Start / US Session Start / US Session End** – часы (0–23), определяющие начало мониторинга EU и торговое окно US.
- **Small EU Session (pips)** – максимальный размер диапазона EU, при котором стратегия остаётся активной.
- **Trade On Monday** – включает или выключает торговлю по понедельникам, при этом выходные всё равно блокируются.
- **Stop Loss (pips)** – расстояние от входа до защитного стопа с автоматической поправкой на шаг цены и количество знаков.
- **Take Profit (pips)** – расстояние до цели, рассчитывается аналогично стопу.
- **Breakout Buffer (points)** – число шагов цены, на которое подтверждающая свеча должна выйти за диапазон.
- **Candle Type** – тип свечей для подписки; по умолчанию 15-минутные данные, как в исходном скрипте на M15.

## Дополнительные замечания

- Предполагается неттинговый учёт: защитные уровни закрывают весь объём рыночными ордерами.
- Полное обновление состояния выполняется в полночь, чтобы диапазон и флаги пробоев не переходили на следующий день, при этом
  открытые позиции сохраняют уровни стопа и цели.
- Стоп и тейк контролируются по экстремумам свечи, поэтому внутридневные шпильки, отсутствующие в истории, не будут замечены.
