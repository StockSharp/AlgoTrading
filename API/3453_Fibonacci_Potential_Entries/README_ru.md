# Стратегия Fibonacci Potential Entries

## Обзор

Стратегия полностью повторяет логику оригинального советника **EA_PUB_FibonacciPotentialEntries**. Она выставляет две отложенные заявки на уровнях отката Фибо 50% и 61% и управляет ими через высокоуровневый API StockSharp.

## Логика торговли

1. **Начальная постановка**
   - Как только становятся доступны котировки bid/ask, стратегия вычисляет текущий спред и отправляет две лимитные заявки:
     - Заявка №1: по уровню 50% со стопом ниже (или выше для шортов) уровня 61%.
     - Заявка №2: по уровню 61% со стопом, расположеным посередине к уровню 100%.
   - Объёмы рассчитываются так, чтобы первая сделка рисковала 0.7% капитала, а вторая — остатком параметра `RiskPercent`.

2. **Обработка цели**
   - Когда цена достигает уровня `TargetPrice`, стратегия закрывает половину объёма каждой исполненной позиции рыночными ордерами.
   - После частичной фиксации остаток защищается на уровне безубытка. Если рынок возвращается к цене входа, остаток закрывается автоматически.

3. **Направление**
   - `IsBullish = true` — постановка покупок (базовый вариант из MQL).
   - `IsBullish = false` — зеркальное поведение с продажами и инвертированными проверками стоп/тейк.

## Параметры

| Имя | Описание |
|-----|----------|
| `PriceOn50Level` | Уровень цены для первой лимитной заявки. |
| `PriceOn61Level` | Уровень цены для второй лимитной заявки. |
| `PriceOn100Level` | Референс для расчёта стопа второй сделки. |
| `TargetPrice` | Общая цель по прибыли для обеих позиций. |
| `RiskPercent` | Общий процент капитала под риском в обоих входах. |
| `IsBullish` | Выбор между длинным и коротким сценарием. |

## Особенности конвертации

- Используются только высокоуровневые методы (`SubscribeLevel1`, `BuyLimit`, `SellLimit`, `BuyMarket`, `SellMarket`), что соответствует правилам репозитория.
- Частичные закрытия и перевод в безубыток реализованы через рыночные заявки, без низкоуровневых модификаций, как и в исходном MQL-роботе.
- Объёмы приводятся к шагу объёма инструмента, чтобы соответствовать требованиям StockSharp.
