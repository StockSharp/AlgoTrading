# Стратегия HPCS Inter5

## Общее описание

**HPCS Inter5 Strategy** — это одноразовая импульсная стратегия, перенесённая из MetaTrader 4 (скрипт `_HPCS_Inter5_MT4_EA_V01_WE`). После запуска стратегия анализирует последние завершённые свечи и, если закрытие пятой свечи назад выше ближайшего закрытия, отправляет один рыночный ордер на покупку. Опциональные уровни стоп-лосса и тейк-профита рассчитываются в «пунктах» MetaTrader, повторяя оригинальную реализацию.

## Логика работы

1. Подписаться на выбранный тип свечей и хранить шесть последних закрытий.
2. После заполнения буфера сравнить закрытие пятой свечи назад с последним закрытием (`Close[5] > Close[1]`).
3. Если условие выполняется и сделка ещё не совершена, отправить рыночный ордер на покупку с заданным объёмом.
4. В момент старта вызвать `StartProtection`, чтобы активировать защитные приказы. Размер пункта рассчитывается так же, как в MetaTrader: для инструментов с 3 или 5 знаками после запятой используется `PriceStep * 10`, иначе берётся `PriceStep` без изменения.

После открытия позиции стратегия игнорирует все новые сигналы и не совершает дополнительных сделок.

## Параметры

| Имя | Значение по умолчанию | Описание |
| --- | --- | --- |
| `Candle Type` | Таймфрейм 1 минута | Тип свечей, по которым собираются цены закрытия. Настройте в соответствии с нужным горизонтом анализа. |
| `Stop Loss (pips)` | 10 | Расстояние защитного стоп-лосса в пунктах MetaTrader. Значение `0` отключает стоп. |
| `Take Profit (pips)` | 10 | Расстояние защитного тейк-профита в пунктах MetaTrader. Значение `0` отключает тейк-профит. |
| `Trade Volume` | 1 | Объём рыночного ордера при срабатывании сигнала. |

## Особенности реализации

- Для расчёта защитных уровней необходимо корректно заполнить `Security.PriceStep` (или `Security.Step`). При его отсутствии защитные отступы не активируются, но вход по сигналу остаётся рабочим.
- Обрабатываются только завершённые свечи (`CandleStates.Finished`), что соответствует логике MetaTrader с использованием `Close[1]` и более старых значений.
- Внутренний буфер содержит ровно шесть закрытий без использования индикаторов, что подчёркивает минималистичность исходного скрипта.
- Перед отправкой ордера вызывается `IsFormedAndOnlineAndAllowTrading()`, чтобы убедиться в готовности соединения и разрешениях на торговлю.

## Рекомендации по использованию

1. Выберите валютную пару с корректно настроенными шагом цены и объёмами.
2. Настройте `Candle Type` под нужный таймфрейм.
3. Установите `0` в параметрах стопа или тейк-профита, если планируете управлять выходом вручную.
4. Перезапускайте стратегию каждый раз, когда хотите повторно оценить условие входа: сигнал исполняется только один раз за запуск.
