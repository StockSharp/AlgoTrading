# Vortex Oscillator System 策略

## 概述
Vortex Oscillator System 是从 MetaTrader 5 专家顾问直接移植的策略，核心是 Vortex 振荡指标。该指标取正向 Vortex 线（VI+）与负向 Vortex 线（VI-）的差值，基于选定的 K 线序列计算。当振荡器数值大幅为负时，说明 VI- 强于 VI+；当数值显著为正时，则代表 VI+ 占据主导。策略把这些极值视为可能的拐点，通过振荡器阈值产生反转式入场，并利用同样的阈值完成止损或止盈。

## 工作流程
1. 根据设定的时间框架生成蜡烛图，并将其传递给内置的 `VortexIndicator`。
2. 当指标形成后，在每根收盘蜡烛上计算振荡器值 `VI+ - VI-`。
3. 将振荡器与用户定义的阈值比较：
   - 当数值低于买入阈值时，识别到多头信号；
   - 当数值高于卖出阈值时，识别到空头信号。
4. 可选的过滤条件要求多头信号必须位于买入阈值与多头止损水平之间（空头信号亦然）。
5. 出现新信号时，策略先平掉相反方向的仓位，再按设定手数开仓。
6. 持仓期间持续跟踪振荡器。一旦触发止损或止盈水平，仓位立即平掉。

整个流程完整复刻 MT5 版本：仅在收盘价上做决策、两种方向互斥，并使用振荡器控制退出。

## 入场规则
- **做多**
  - 当振荡器值小于或等于买入阈值时触发。
  - 如果启用多头止损，振荡器必须同时高于多头止损水平。
  - 开多前会先平掉所有空头仓位。
- **做空**
  - 当振荡器值大于或等于卖出阈值时触发。
  - 如果启用空头止损，振荡器必须同时低于空头止损水平。
  - 开空前会先平掉所有多头仓位。
- 当振荡器落在买入和卖出阈值之间时，信号被取消，不改变仓位。

## 离场规则
- **多头仓位**
  - 如果振荡器跌破或等于多头止损水平（启用时），立即平仓。
  - 如果振荡器升至或高于多头止盈水平（启用时），立即平仓。
- **空头仓位**
  - 如果振荡器升破或等于空头止损水平（启用时），立即平仓。
  - 如果振荡器跌至或低于空头止盈水平（启用时），立即平仓。

每根蜡烛收盘都会执行上述检查，确保与原始监控循环完全一致。

## 参数说明
- **Vortex Length** – Vortex 指标的周期长度（默认 14）。
- **Candle Type** – 计算指标所使用的蜡烛时间框架。
- **Use Buy Stop Loss** – 启用多头方向的振荡器止损过滤和出场。
- **Use Buy Take Profit** – 启用多头方向的振荡器止盈出场。
- **Use Sell Stop Loss** – 启用空头方向的振荡器止损过滤和出场。
- **Use Sell Take Profit** – 启用空头方向的振荡器止盈出场。
- **Buy Threshold** – 触发多头入场的振荡器数值（默认 -0.75）。
- **Buy Stop Loss Level** – 多头止损的振荡器数值（默认 -1.00）。
- **Buy Take Profit Level** – 多头止盈的振荡器数值（默认 0.00）。
- **Sell Threshold** – 触发空头入场的振荡器数值（默认 0.75）。
- **Sell Stop Loss Level** – 空头止损的振荡器数值（默认 1.00）。
- **Sell Take Profit Level** – 空头止盈的振荡器数值（默认 0.00）。
- **Volume** – 新仓位使用的交易量（默认 0.1，与原始 EA 相同）。

## 实现细节
- 仅在蜡烛收盘后处理，避免在同一根蜡烛内重复触发信号。
- 主要阈值提供了优化范围，可在 StockSharp 优化器中进行参数搜索。
- 策略在换向时会自动“翻仓”，一次性下单完成平仓与反向开仓。
- 止损与止盈选项互不依赖，可独立启用任意组合。
