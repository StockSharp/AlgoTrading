# E-News Lucky 策略

## 概览
**E-News Lucky** 策略是 MetaTrader 智能交易系统 `e-News-Lucky` 的 StockSharp 版本。策略实现了典型的新闻突破思路：

- 在设定的 `PlacementTime` 时间点，策略会在当前价格上下按照 `DistancePips` 的距离分别挂出 Buy Stop 与 Sell Stop 订单。
- 任一方向触发成交后，会立即撤销另一侧的挂单，并根据参数设置自动创建止损与止盈价位。
- 通过 `TrailingStopPips` 与 `TrailingStepPips` 可以启用移动止损，在行情顺势运行时逐步锁定利润。
- 到达 `CancelTime` 时，策略会撤销所有剩余挂单，并平掉所有持仓，以避免在交易窗口之外暴露风险。

策略仅使用蜡烛图数据（`CandleType`，默认 1 分钟）来判断时间与更新移动止损，不依赖任何指标。

## 参数说明
| 参数 | 说明 |
| --- | --- |
| `Volume` | 每个挂单的下单手数。策略会同时放置对称的 Buy Stop 与 Sell Stop。 |
| `StopLossPips` | 入场价与止损之间的距离（单位：点）。设置为 0 表示不使用止损。 |
| `TakeProfitPips` | 入场价与止盈之间的距离（单位：点）。设置为 0 表示不使用止盈。 |
| `TrailingStopPips` | 移动止损的基础距离（单位：点）。大于 0 时才会启动移动止损。 |
| `TrailingStepPips` | 每次调整移动止损所需的最小获利（单位：点），可减少震荡行情下的频繁移动。 |
| `DistancePips` | 挂单距离当前价格的偏移量（单位：点）。 |
| `PlacementTime` | 提交挂单的服务器时间。默认值：10:30。 |
| `CancelTime` | 撤单并平仓的服务器时间。默认值：22:30。 |
| `CandleType` | 用于调度与移动止损的蜡烛类型。默认值：1 分钟。 |

## 实现细节
- 点值计算与原始 EA 保持一致：若品种报价保留 3 位或 5 位小数，则将最小价格步长乘以 10 作为点值。
- 所有下单价格都会先按品种的最小价格变动单位进行规范化。
- 移动止损会比较最新收盘价与 `PositionPrice`，只有当浮盈超过 `TrailingStopPips` 与 `TrailingStepPips` 时才会上移（或下移）止损。
- 每个交易日到达 `PlacementTime` 会重新挂出双向突破单，到达 `CancelTime` 则保证所有订单与仓位被清理。

## 使用建议
1. 选择流动性高、点差小的品种运行本策略，以适应新闻行情的快速波动。
2. 根据关注的经济事件调整 `PlacementTime` 与 `CancelTime`，确保在新闻公布前后执行策略。
3. 依据市场波动率调整各类点数参数：较大的距离可减少假突破，较小的距离可以更早入场但风险更高。
4. 如需固定止损，可将 `TrailingStopPips` 设为 0 以关闭移动止损功能。
5. 在重大事件期间注意观察滑点与点差变化，确保挂单能按预期成交。
