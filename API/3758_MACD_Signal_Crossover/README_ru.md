# Стратегия MACD Signal Crossover

## Обзор
Этот пример демонстрирует перенос эксперта MetaTrader 4 `MACD_v1.mq4` в высокоуровневый API StockSharp. Алгоритм отслеживает пересечения линии MACD и сигнальной линии, открывая сделки в сторону нового импульса. Дополнительно реализованы те же защитные механизмы, что и в исходном советнике: удалённый тейк-профит, стоп-лосс и частичная фиксация прибыли при достижении первой цели.

## Логика торговли
1. **Источник данных** – стратегия подписывается на выбранный таймфрейм (по умолчанию 5-минутные свечи) и привязывает индикатор `MovingAverageConvergenceDivergenceSignal`.
2. **Условия входа**:
   - **Покупка** при пересечении линии MACD выше сигнальной. Если есть короткая позиция, она закрывается перед открытием лонга.
   - **Продажа** при пересечении MACD ниже сигнальной линии. Текущая длинная позиция закрывается перед открытием шорта.
3. **Условия выхода**:
   - Обратное пересечение закрывает открытую позицию и инициирует разворот.
   - `StartProtection` управляет стоп-лоссом и тейк-профитом в пунктах, повторяя параметры оригинальной реализации.
   - Частичное закрытие половины позиции происходит один раз, когда цена проходит заданное количество пунктов от средней цены входа.

## Параметры
| Название | Значение по умолчанию | Описание |
|----------|-----------------------|----------|
| **Fast Period** | 23 | Длина быстрой EMA в расчёте MACD (соответствует параметру `a = 2300`). |
| **Slow Period** | 40 | Длина медленной EMA (параметр `b = 4000`). |
| **Signal Period** | 8 | Длина сигнальной средней (`c = 800`). |
| **Take Profit** | 500 | Расстояние тейк-профита в пунктах. Ноль отключает защитный тейк. |
| **Stop Loss** | 80 | Расстояние стоп-лосса в пунктах. Ноль отключает стоп. |
| **Partial Profit** | 70 | Расстояние в пунктах до частичного закрытия половины позиции. Ноль отменяет функцию. |
| **Candle Type** | 5-минутный таймфрейм | Тип свечей для расчёта индикатора.

## Дополнительные замечания
- В оригинале периоды MACD задавались в сотых долях (2300/4000/800). В версии StockSharp они переведены в привычные значения 23/40/8.
- Флаг частичного выхода автоматически сбрасывается при наборе новой позиции, что позволяет повторно использовать цель.
- При наличии панели графика стратегия рисует свечи, линии MACD и собственные сделки.
- Объём сделок задаётся свойством `Volume` базовой стратегии. Перед запуском подберите его под требования инструмента.
