# Статические стрелки EA
[English](README.md) | [中文](README_cn.md)

## Обзор
Стратегия представляет собой прямой порт советника MetaTrader "Static Arrow" на платформу StockSharp. Это полностью
декоративный пример: заявки не выставляются, торговые сигналы не рассчитываются. При запуске стратегия подписывается на
серию свечей (по умолчанию недельный EURUSD), создаёт область графика для отображения и подготавливает ряд стрелок, которые
должны оставаться на своих местах независимо от поступающих данных.

В отличие от исходного MQL-кода, где использовались экранные координаты, StockSharp-версия привязывает каждую стрелку к
последней завершённой свече. Благодаря этому маркеры не смещаются при прокрутке графика или появлении новых баров. Поведение
умышленно упрощено, чтобы пример можно было использовать как шаблон для нанесения статических пометок из стратегии без
обращения к низкоуровневым API построения графиков.

## Как это работает
1. Стратегия проверяет, что выбранный `CandleType` содержит таймфрейм (поддерживаются только временные свечи).
2. После подписки на поток свечей она ждёт первую завершённую свечу. Её время открытия и цена закрытия становятся опорной
   точкой для всех стрелок.
3. По умолчанию генерируется 40 отметок времени путём пошагового движения назад по величине таймфрейма. Каждая отметка
   комбинируется с той же базовой ценой, к которой можно добавить `PriceOffset`.
4. При каждом завершённом баре закэшированные координаты прорисовываются методом `DrawText`, что удерживает стрелки на экране.
5. Поскольку координаты сохраняются, таймеры и обработка тиков не требуются — аннотации остаются до остановки или сброса
   стратегии.

## Параметры
- `CandleType` *(по умолчанию: недельный таймфрейм)* — таймфрейм свечного потока, по которому рассчитываются координаты.
- `ArrowCount` *(по умолчанию: 40)* — количество стрелок. Параметр можно оптимизировать, уменьшая нагрузку или расширяя ряд
  стрелок глубже в прошлое.
- `PriceOffset` *(по умолчанию: 0)* — добавочный сдвиг к базовой цене. Используйте его, чтобы разместить стрелки чуть выше или
  ниже свечей и избежать наложения на бары.
- `ArrowSymbol` *(по умолчанию: "↓")* — текст, который выводится на график. Можно указать любой символ Unicode, например "↑"
  или эмодзи.

## Рекомендации по использованию
- Стратегия предназначена для визуальных панелей и не открывает позиции. Настройки рисков и капитала на неё не влияют.
- После привязки координат изменение параметров во время работы требует перезапуска, чтобы пересчитать расположение стрелок.
- Недельный таймфрейм выбран в память об оригинальном советнике, который принудительно переключал график EURUSD на W1. Вы
  можете выбрать другой инструмент и период для оформления любых графиков.
- На очень мелких таймфреймах имеет смысл уменьшить `ArrowCount`, чтобы стрелки не выходили за пределы видимого окна.

## Отличия от оригинального MetaTrader-советника
- Настройки графика вроде автопрокрутки и масштаба не изменяются — ими управляет пользователь терминала.
- Пиксельные координаты заменены на пары время/цена, рассчитанные по первой завершённой свече, что делает пример устойчивым к
  различным разрешениям экранов и макетам терминала.
- Цикл таймера не нужен: аннотации StockSharp сохраняются до удаления, поэтому достаточно перерисовывать их после каждой
  завершённой свечи.
