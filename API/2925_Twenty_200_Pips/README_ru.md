# Стратегия Twenty 200 Pips

## Обзор
Стратегия повторяет логику советника **20/200 pips** для MQL5. Она анализирует часовые свечи и
сравнивает два исторических значения цены открытия (`Open[t1]` и `Open[t2]`). Если разница между
ними превышает заданный порог в заданный час, стратегия совершает единственную сделку за день и
опирается на фиксированные уровни тейк-профита и стоп-лосса.

## Торговая логика
1. Оформляется подписка на свечи (по умолчанию 1 час) и цена открытия подаётся на два индикатора
   `Shift`, чтобы получить значения `Open[t1]` и `Open[t2]` без хранения массивов.
2. На каждой завершённой свече флаг «можно торговать» сбрасывается в `true`, когда текущий час
   становится больше настроенного. Это имитирует ежедневный сброс во изначальном советнике.
3. Когда час совпадает с параметром `TradeHour`, позиция отсутствует, а флаг разрешения установлен,
   сравниваются сохранённые открытия:
   - Если `Open[t1] > Open[t2] + delta`, отправляется рыночная заявка на продажу.
   - Если `Open[t1] + delta < Open[t2]`, отправляется рыночная заявка на покупку.
4. После отправки заявки стратегия запрещает новые входы до следующего сброса. Защитные тейк-профит
   и стоп-лосс выставляются через `StartProtection`.

## Параметры
- `TakeProfit` – расстояние до тейк-профита в пунктах цены (по умолчанию 200).
- `StopLoss` – расстояние до стоп-лосса в пунктах цены (по умолчанию 2000).
- `TradeHour` – час суток, в который выполняется проверка условий входа (по умолчанию 18).
- `FirstOffset` – индекс более старой цены открытия (`Open[t1]` в исходнике, по умолчанию 7).
- `SecondOffset` – индекс более новой цены открытия (`Open[t2]`, по умолчанию 2).
- `DeltaPoints` – минимальная разница между открытиями для открытия сделки (по умолчанию 70).
- `Volume` – объём рыночных заявок (по умолчанию 0.1).
- `CandleType` – тип свечей для расчётов (по умолчанию часовые).

## Особенности реализации
- Индикаторы `Shift` обрабатываются вручную, что избавляет от собственных коллекций и соблюдает
  требования по стилю.
- `StartProtection` вызывается один раз в `OnStarted`, что имитирует фиксацию тейк-профита и
  стоп-лосса, прописанную в MQL-версии.
- В код добавлены комментарии на английском языке, как требует инструкция.
- За один день допускается только одна сделка: флаг `_canTrade` очищается после входа и
  восстанавливается только после прохождения настроенного часа.

## Использование
1. Запустите стратегию на нужном инструменте и настройте параметры под специфику рынка.
2. Убедитесь, что у инструмента корректно задан шаг цены (`PriceStep`), поскольку он используется для
   перевода пунктов в абсолютное значение.
3. После запуска стратегия ждёт наступления заданного часа и анализирует первую завершённую свечу,
   чтобы принять решение о входе.
