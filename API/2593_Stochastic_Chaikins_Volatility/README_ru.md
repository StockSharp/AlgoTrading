# Стратегия Stochastic Chaikin's Volatility

## Общее описание
Эта стратегия — перенос на StockSharp советника MetaTrader `Exp_Stochastic_Chaikins_Volatility`. Алгоритм измеряет разброс между максимумом и минимумом свечи, сглаживает его выбранным типом скользящей средней, после чего нормализует результат подобно стохастическому осциллятору. Торговая логика соответствует оригиналу и носит контртрендовый характер: входы выполняются в момент разворота осциллятора, а закрытия — при восстановлении импульса в противоположную сторону.

## Формирование индикатора
1. **Chaikin-подобная волатильность** — разница `High-Low` сглаживается *первой* скользящей средней. Доступные методы сглаживания: SMA, EMA, SMMA (Wilder), LWMA и Jurik.
2. **Стохастическая нормализация** — из последних `Stochastic Length` сглаженных значений берутся максимум и минимум, относительно которых рассчитывается текущая позиция в диапазоне 0–100.
3. **Вторичное сглаживание** — коэффициент из п.2 дополнительно фильтруется *второй* скользящей средней (из того же списка методов), что даёт основную линию осциллятора. Сигнальная линия равна значению основной линии на предыдущей закрытой свече, как в исходном индикаторе.

## Правила торговли
- **Входы**
  - *Покупка*: когда осциллятор сформировал вершину и последняя закрытая свеча пересекла предыдущий максимум сверху вниз.
  - *Продажа*: когда осциллятор сформировал впадину и последняя свеча пересекла предыдущий минимум снизу вверх.
- **Выходы**
  - Длинные позиции закрываются, если предыдущее значение осциллятора стало ниже ещё более раннего (импульс вниз).
  - Короткие позиции закрываются, если предыдущее значение стало выше ещё более раннего (импульс вверх).
- Параметр `Signal Shift` задаёт, какую по счёту закрытую свечу анализировать. Значение 1 полностью повторяет логику MQL.

## Параметры
| Имя | Описание |
| --- | --- |
| `Candle Type` | Таймфрейм свечей для расчётов (по умолчанию 4 часа). |
| `Primary Method` / `Primary Length` | Тип и период первичной скользящей для сглаживания диапазона `High-Low`. |
| `Secondary Method` / `Secondary Length` | Тип и период вторичного сглаживания нормализованного осциллятора. |
| `Stochastic Length` | Размер окна для поиска минимума и максимума при нормализации. |
| `Signal Shift` | Сдвиг по закрытым свечам для расчёта сигналов (минимум 1). |
| `Allow Long/Short Entry` | Разрешение на открытие длинных / коротких позиций. |
| `Allow Long/Short Exit` | Разрешение на закрытие позиций при развороте осциллятора. |
| `High/Middle/Low Level` | Визуальные уровни из оригинального индикатора (на торговлю не влияют). |

## Особенности использования
- В StockSharp используются стандартные индикаторы. Экзотические методы сглаживания из MQL (ParMA, VIDYA, AMA и т.д.) заменяются ближайшими доступными аналогами; для более плавного поведения выбирайте вариант Jurik.
- Размер позиции определяется параметром `Volume` базового класса. Системы стоп-лосса и тейк-профита из MQL-библиотеки не переносятся — выходы выполняются по сигналам осциллятора либо через внешнее управление риском (`StartProtection`).
- Расчёты ведутся только по завершённым свечам. Убедитесь, что поставщик данных отдаёт выбранный таймфрейм с достаточной историей для прогрева обоих сглаживаний и стохастического окна.
