# Fractal Identifier 2.0 策略

## 概述
**Fractal Identifier 2.0 策略**直接移植自 MetaTrader 5 指标 "Fractal Identifier 2.0"。原始脚本会反复读取系统自带的分形缓冲区，并在图表注释中输出最新确认的向上分形。本版 StockSharp 策略保持相同行为，通过监控所选的K线数据并在诊断日志中记录最近的分形高点。

该策略不会发送任何订单，主要用于辅助分析，用来提示新的看涨分形已经确认。借助 StockSharp 的高级 API 订阅蜡烛序列，可方便地嵌入到更大的交易工作流或监控面板中。

## 工作流程
1. 订阅由 `CandleType` 参数指定的主蜡烛序列。
2. 维护一个滚动缓冲区，保存最近完成蜡烛的最高价。
3. 当缓冲区中至少有五根蜡烛时，从最新确认的中心向较旧的蜡烛扫描，寻找第一个满足经典 Bill Williams 分形条件的高点（该高点高于前后各两根蜡烛的高点）。
4. 一旦找到新的分形，就在日志中输出检测到的价格水平。

该流程复现了 MQL5 脚本不断调用 `CopyBuffer` 并打印最新非空分形值的逻辑。

## 参数
| 名称 | 说明 | 默认值 |
| --- | --- | --- |
| `LookbackBars` | 在最近完成的蜡烛中搜索分形高点的数量。增大该值可以在报告之前查找更久远的分形。 | `10` |
| `CandleType` | 用于计算分形的蜡烛序列。根据需要调整时间框架，例如 5 分钟K线。 | `1 分钟时间框架` |

## 输出
- 当检测到分形高点时，策略会调用 `AddInfoLog("Most recent fractal high: {price}")`。该日志与原始脚本的图表注释内容一致。
- 策略会绘制对应的蜡烛图区域，帮助用户直观地观察日志生成的时刻。

## 注意事项
- 仅评估向上分形，与 MT5 源代码的行为一致。
- 分形需要再完成两根蜡烛才会得到确认，因此最新的高点可能会有短暂的延迟才会记录。
- 可以将该组件嵌入到其他策略中，用于触发告警、绘制水平或将价格传递给规则引擎。
