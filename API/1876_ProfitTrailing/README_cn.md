# Profit Trailing 策略
[English](README.md) | [Русский](README_ru.md)

该策略由 MQL4 EA "ProfitTrailing.mq4" 转换而来。它监控已有持仓，通过固定的止盈与盈利回撤的跟踪止损来管理退出。可与其他策略结合使用，或手动监管已开仓位。

当未实现利润超过设定的步长时策略启动跟踪止损。随着利润增长，止损水平同步上移。如果利润回撤超过该步长或达到止盈目标，仓位将被平掉。

## 细节

- **入场条件**：
  - 无。仓位需由其他策略或手动开立。
- **方向**：双向。
- **出场条件**：
  - 利润达到 `TakeProfit`。
  - 激活后利润回落至跟踪止损水平。
- **止损**：仅在盈利区间内的跟踪止损，无初始止损。
- **过滤器**：
  - 适用于任何品种和时间框架。
- **参数**：
  - `TrailingStep` — 启动跟踪止损所需的利润（货币单位），同时也是止损与当前利润的距离。
  - `TakeProfit` — 平仓所需的利润（货币单位）。
  - `CandleType` — 用于跟踪价格与利润的K线类型。

## 机制

1. 启动时订阅K线并调用 `StartProtection()`。
2. 出现持仓时记录入场价。
3. 当利润超过 `TrailingStep` 时设置跟踪止损 `profit - TrailingStep`。
4. 随着利润增加，跟踪止损上移。
5. 当利润跌破跟踪止损或达到 `TakeProfit` 时平仓。
