# Стратегия Profit Trailing
[English](README.md) | [中文](README_cn.md)

Конвертирована из советника MQL4 "ProfitTrailing.mq4". Эта утилита отслеживает существующую позицию и управляет её выходом с помощью фиксированного тейк-профита и трейлинг-стопа по прибыли. Её можно использовать совместно с другой стратегией или вручную для контроля открытых сделок.

Стратегия включает трейлинг после превышения прибыли заданного шага. Уровень трейлинг-стопа смещается по мере роста прибыли. Если прибыль откатывается на величину шага или достигает тейк-профита, позиция закрывается.

## Детали

- **Условия входа**:
  - Нет. Позиции должны открываться другими стратегиями или вручную.
- **Длинные/короткие**: Оба направления.
- **Условия выхода**:
  - Прибыль достигает `TakeProfit`.
  - После активации прибыль падает до уровня трейлинг-стопа.
- **Стопы**: Трейлинг-стоп только в прибыли, без начального стоп-лосса.
- **Фильтры**:
  - Подходит для любого инструмента и таймфрейма.
- **Параметры**:
  - `TrailingStep` — прибыль (в денежных единицах), необходимая для активации трейлинга и расстояние до стопа.
  - `TakeProfit` — прибыль (в денежных единицах), при которой позиция закрывается.
  - `CandleType` — серия свечей для расчёта цены и прибыли.

## Механика

1. При запуске открывается подписка на свечи и вызывается `StartProtection()`.
2. При появлении позиции запоминается цена входа.
3. После превышения `TrailingStep` устанавливается трейлинг-стоп `profit - TrailingStep`.
4. По мере роста прибыли трейлинг-стоп перемещается выше.
5. Позиция закрывается, если прибыль падает ниже трейлинг-стопа или достигает `TakeProfit`.
