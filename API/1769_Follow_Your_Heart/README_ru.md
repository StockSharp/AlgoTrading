# Стратегия Follow Your Heart

## Обзор
Стратегия является портом советника MetaTrader «Follow Your Heart» на StockSharp. Она анализирует несколько последних свечей и суммирует относительные изменения их цен открытия, закрытия, максимумов и минимумов. Длинная позиция открывается, когда все изменения превышают порог и общий результат положительный. Короткая позиция открывается при обратных условиях. В один момент времени может существовать только одна позиция.

Позиции защищены по целям прибыли и убытка в денежном выражении, а также по take-profit/stop-loss в пунктах. Опциональные торговые сессии позволяют исполнять сигналы только в указанные часы.

## Параметры
- `Bars` – количество свечей для накопления изменений цен. По умолчанию: 6.
- `Level` – порог для изменений открытия и закрытия. По умолчанию: 2.3.
- `ProfitBuy` – цель прибыли для закрытия длинной позиции. По умолчанию: 75.
- `ProfitSell` – цель прибыли для закрытия короткой позиции. По умолчанию: 56.
- `LossBuy` – порог убытка для закрытия длинной позиции. По умолчанию: -54.
- `LossSell` – порог убытка для закрытия короткой позиции. По умолчанию: -51.
- `TakeProfit` – take-profit в пунктах. По умолчанию: 550.
- `StopLoss` – stop-loss в пунктах. По умолчанию: 550.
- `TradingHoursOn` – включить фильтр торговых сессий. По умолчанию: true.
- `OpenHourBuy` / `CloseHourBuy` – разрешённые часы для покупок. По умолчанию: 6 / 12.
- `OpenHourSell` / `CloseHourSell` – разрешённые часы для продаж. По умолчанию: 4 / 10.
- `CandleType` – таймфрейм свечей. По умолчанию: 1 минута.

## Логика стратегии
1. Для каждой завершённой свечи вычисляется относительное изменение открытия, закрытия, максимума и минимума по сравнению с предыдущей свечой и обновляются скользящие суммы.
2. Если позиция отсутствует:
   - **Покупка** при положительной сумме, когда изменения открытия и закрытия выше `Level`, а изменение закрытия больше изменения открытия и текущее время находится в сессии покупок.
   - **Продажа** при отрицательной сумме, когда изменения открытия и закрытия ниже `-Level`, а изменение закрытия меньше изменения открытия и текущее время находится в сессии продаж.
3. При наличии позиции она закрывается, если прибыль или убыток превышают заданные денежные лимиты либо цена сместилась на `TakeProfit`/`StopLoss` пунктов.

## Примечания
- Используются только рыночные заявки.
- Блок управления капиталом из оригинального кода упрощён; объём берётся из свойства `Volume` стратегии.
