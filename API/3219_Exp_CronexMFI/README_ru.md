# Стратегия Exp Cronex MFI

## Обзор
Стратегия воспроизводит советник **Exp_CronexMFI**. Денежный поток (MFI) сглаживается дважды, после чего сделки открываются **против** пересечения полученных линий. В порте сохранена контртрендовая логика и все настройки вынесены в параметры StockSharp.

## Принцип работы
1. Подписка на выбранные свечи (по умолчанию таймфрейм 4 часа).
2. Расчёт индикатора Money Flow Index с заданным периодом.
3. Двухступенчатое сглаживание выбранным методом: первый проход формирует быструю линию Cronex, второй — сглаживает её ещё раз для медленной линии.
4. Сохранение пар значений с учётом задержки `SignalShift`, аналогичной параметру `SignalBar` в MQL.
5. Когда быстрая линия пересекает медленную сверху вниз, стратегия закрывает короткие позиции (если разрешено) и открывает/увеличивает длинные. При пересечении снизу вверх закрываются лонги и открываются шорты.
6. Заявки отправляются по рынку с объёмом `Volume`; возможность входа и выхода отдельно настраивается для длинной и короткой стороны.

Расчёт ведётся только по завершённым свечам, как и в версии для MetaTrader.

## Параметры
| Имя | Тип | Значение по умолчанию | Описание |
| --- | --- | --- | --- |
| `MfiPeriod` | `int` | `25` | Период Money Flow Index. |
| `FastPeriod` | `int` | `14` | Период первого сглаживания (быстрая линия Cronex). |
| `SlowPeriod` | `int` | `25` | Период второго сглаживания (медленная линия Cronex). |
| `SignalShift` | `int` | `1` | Количество завершённых свечей для задержки сигнала. |
| `Smoothing` | `SmoothingMethod` | `Simple` | Алгоритм сглаживания для обеих линий. |
| `EnableLongEntries` | `bool` | `true` | Разрешает открытие/увеличение длинных позиций. |
| `EnableShortEntries` | `bool` | `true` | Разрешает открытие/увеличение коротких позиций. |
| `EnableLongExits` | `bool` | `true` | Разрешает закрытие длинных позиций по сигналу. |
| `EnableShortExits` | `bool` | `true` | Разрешает закрытие коротких позиций по сигналу. |
| `CandleType` | `DataType` | `TimeFrame(4h)` | Серия свечей для расчётов. |
| `Volume` | `decimal` | `1` | Объём заявок при открытии позиции. |

## Варианты сглаживания
В оригинальном индикаторе доступны дополнительные режимы. В StockSharp они сопоставлены встроенным средним:

| Концепция MQL | Значение `SmoothingMethod` | Примечание |
| --- | --- | --- |
| SMA | `Simple` | Простое скользящее среднее. |
| EMA | `Exponential` | Экспоненциальное скользящее среднее. |
| SMMA | `Smoothed` | Сглаженное среднее (по Уайлдеру). |
| LWMA | `Weighted` | Линейно-взвешенное среднее. |
| JJMA / JurX / ParMA / T3 / VIDYA / AMA | `DoubleExponential`, `TripleExponential`, `Hull`, `ZeroLagExponential`, `ArnaudLegoux`, `KaufmanAdaptive` | Подберите ближайший аналог адаптивного сглаживания. |

## Отличия от версии MQL
- Выбор между тиковым и реальным объёмом отсутствует — используются объёмы свечей StockSharp.
- Управление позицией выполнено рыночными заявками; задержка исполнения реализована параметром `SignalShift`.
- Стоп-лосс и тейк-профит необходимо настраивать отдельно (например, через `StartProtection` или правила риска).

## Рекомендации
- Подбирайте таймфрейм под ликвидность инструмента; значение 4 часа соответствует исходному советнику.
- Увеличивайте `SignalShift`, если требуется дополнительное подтверждение сигнала.
- Используйте защитные правила и контроль капитала для ограничения убытков.
