# Стратегия EA OBJPROP Chart ID

## Обзор

**Стратегия EA OBJPROP Chart ID** воссоздает ориентированное на визуализацию поведение оригинального примера MetaTrader 5. Она строит полосы канала Дончиана на трех синхронизированных таймфреймах: основной график отображает торговый интервал, а две вспомогательные панели демонстрируют контекст H4 и Daily. Такой подход повторяет идею исходного эксперта, который объединял несколько графиков и индикаторов в одном рабочем пространстве.

## Ключевые особенности

- **Мульти-таймфреймовая визуализация** — автоматически подписывается на свечи основного, H4 и дневного таймфреймов для выбранного инструмента.
- **Единая длина канала Дончиана** — один и тот же период применяется ко всем таймфреймам, что упрощает сравнение границ канала.
- **Интеграция на высоком уровне** — использует диаграммы StockSharp для отрисовки цен, каналов и сделок без ручного создания низкоуровневых объектов.
- **База для расширения** — сохраняет последние значения верхней и нижней границ для каждого таймфрейма, облегчая добавление торговых правил в будущем.

## Параметры

| Параметр | Описание | Категория | Значение по умолчанию |
|----------|----------|-----------|------------------------|
| `ChannelLength` | Длина канала Дончиана, общая для всех таймфреймов. | Indicators | 22 |
| `PrimaryCandleType` | Основной таймфрейм, используемый для торговли и верхней панели. | General | Свечи 30 минут |
| `H4CandleType` | Вспомогательный таймфрейм H4, показанный во второй панели. | General | Свечи 4 часа |
| `DailyCandleType` | Вспомогательный дневной таймфрейм, показанный в третьей панели. | General | Дневные свечи |

Все параметры доступны через интерфейс StockSharp, поддерживают оптимизацию и настройку без изменения исходного кода.

## Логика стратегии

1. Инициализирует три индикатора DonchianChannels с одинаковой длиной.
2. Подписывается на свечные серии основного, H4 и дневного таймфреймов для текущего инструмента.
3. Привязывает каждую подписку к своему индикатору через высокоуровневый API, обеспечивая инкрементальный расчет значений.
4. Создает одну основную и до двух дополнительных областей графика, где отображаются свечи, каналы и сделки стратегии.
5. Сохраняет последние верхние и нижние границы каналов для каждого таймфрейма, что упрощает внедрение торговых фильтров.

Реализация ориентирована на визуализацию и не размещает заявки, повторяя замысел исходного MQL-примера, сосредоточенного на построении панели мониторинга.

## Практические рекомендации

- Убедитесь, что для выбранного инструмента доступна историческая информация на всех используемых таймфреймах, иначе панели могут оставаться пустыми.
- При необходимости можно заменить параметры таймфреймов на другие типы `TimeFrame`, например 15 минут или неделю.
- Для добавления торговой логики используйте методы `ProcessPrimary`, `ProcessH4`, `ProcessDaily`, где уже доступны актуальные границы каналов.

## Особенности конверсии

- В MetaTrader дочерние графики создавались объектами `OBJ_CHART`; в StockSharp используется создание областей графика, полностью соответствующее высокоуровневой архитектуре платформы.
- Управление индикаторами выполняется через вызовы `BindEx`, что устраняет необходимость ручного получения хэндлов и синхронизирует значения с новыми свечами.
- Не требуется явное удаление объектов — подписки и отображение очищаются автоматически при остановке стратегии.
