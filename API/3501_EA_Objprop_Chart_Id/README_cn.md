# EA OBJPROP 图表 ID 策略

## 概述

**EA OBJPROP 图表 ID 策略** 通过在三个同步时间框中绘制唐奇安通道包络线，重现原始 MetaTrader 5 示例以图表展示为核心的行为。主图展示交易时间框，两块辅助面板分别显示 H4 与日线背景，这种布局与原始 EA 将多张图表与指标叠放在同一工作区的方式相呼应。

## 主要特性

- **多时间框可视化** —— 自动为选定标的订阅主周期、H4 与日线 K 线数据。
- **统一的唐奇安通道长度** —— 在所有时间框上使用相同的参数，便于比较包络范围。
- **高层级图表集成** —— 使用 StockSharp 图表区域绘制价格、通道以及策略成交，无需手动创建低层级图表对象。
- **易于扩展的基础** —— 保存每个时间框最近的上下通道，为未来扩展突破或确认逻辑提供数据。

## 参数

| 参数 | 说明 | 分类 | 默认值 |
|------|------|------|--------|
| `ChannelLength` | 所有时间框通用的唐奇安通道周期长度。 | Indicators | 22 |
| `PrimaryCandleType` | 用于交易和主图展示的时间框。 | General | 30 分钟 K 线 |
| `H4CandleType` | 在第二面板展示的 H4 时间框。 | General | 4 小时 K 线 |
| `DailyCandleType` | 在第三面板展示的日线时间框。 | General | 1 天 K 线 |

所有参数均支持在 StockSharp 参数界面中调节，亦可用于优化，无需修改代码。

## 策略流程

1. 初始化三条相同周期的唐奇安通道指标。
2. 为当前标的订阅主周期、H4 与日线的蜡烛数据。
3. 通过高层级 API 将每个订阅绑定到对应指标，确保指标值随新蜡烛增量计算。
4. 创建一个主图区域和最多两个辅助区域，在其中绘制蜡烛、通道以及策略成交。
5. 记录每个时间框最近的通道上、下边界，便于日后在处理方法中添加交易决策。

当前版本专注于可视化，不会自动提交订单，与原始 MetaTrader 代码仅构建仪表板的意图保持一致。

## 使用说明

- 请确保所选标的在所有订阅的时间框上均有足够历史数据，以填充全部图表区域。
- 若需要其他背景面板，可在参数中替换为不同的 `TimeFrame` 数据类型（例如 15 分钟或周线）。
- 如需加入交易逻辑，可在 `ProcessPrimary`、`ProcessH4`、`ProcessDaily` 方法中利用已保存的通道数值。

## 转换备注

- 原 MetaTrader 示例通过 `OBJ_CHART` 创建子图，StockSharp 版本改为使用高层级 API 生成图表区域，更贴近平台原生体验。
- 指标管理通过 `BindEx` 完成，而非手动创建句柄，确保值与到达的蜡烛同步。
- 无需显式删除图表对象，策略停止时 StockSharp 会自动清理订阅和图表绑定。
