# Стратегия Filling Type

Оригинальный советник MQL5 «Filling Type» лишь определяет, какой тип исполнения ордеров доступен для текущего символа. Он вызывает `SymbolInfoInteger(SYMBOL_FILLING_MODE)` и выводит пояснение для режимов Fill or Kill (FOK), Immediate or Cancel (IOC) или Return.

Порт на StockSharp сохраняет диагностическую функцию и использует метаданные `ExchangeBoard`:

1. При старте стратегия проверяет, что выбран `Strategy.Security` и у инструмента есть ссылка на `ExchangeBoard`. Если доска отсутствует, выводится предупреждение — аналогично тому, как исходник очищал `Comment()`.
2. Далее стратегия пытается прочитать через отражение наиболее распространённые свойства доски (`OrderExecutionTypes`, `ExecutionType` и т.д.). Разные коннекторы StockSharp публикуют информацию под разными именами, поэтому перебирается список кандидатов и, при необходимости, любые свойства, содержащие слова «Execution» или «Filling».
3. Найденные значения выводятся построчно. Если свойство представляет собой перечисление, каждая запись журналируется с индексом, что позволяет чётко увидеть наличие FOK/IOC/RETURN или специфичных кодов брокера.
4. При отсутствии явных свойств стратегия анализирует `ExchangeBoard.ExtensionInfo`, выбирая ключи с подстроками `fill` или `exec` — часть адаптеров публикует поддерживаемые режимы именно там.
5. Если и этот путь не дал результата, в лог попадает сводка общих возможностей доски (`IsSupportMarketOrders`, `IsSupportStopOrders`, `IsSupportStopLimitOrders`, `IsSupportOddLots`, `IsSupportMargin`), чтобы трейдер мог сделать вывод вручную.
6. Параметр `LogBoardDiagnostics` управляет выводом расширенной информации о доске (название, биржа, страна, часовой пояс, режим расчётов, связанная доска поставки, расписание торгов).

## Параметры

| Имя | Значение по умолчанию | Описание |
| --- | --------------------- | -------- |
| `LogBoardDiagnostics` | `true` | При включении после определения типа исполнения печатается расширенная диагностическая информация о биржевой доске. Помогает убедиться, что подключён нужный инструмент. |

## Особенности использования

- Стратегия предназначена только для диагностики и не выставляет ордера. Запустите её на нужном инструменте и изучите лог сразу после старта.
- Поддерживаемые режимы исполнения в StockSharp зависят от адаптера. Отражение позволяет гибко подстроиться под разные реализации без жёсткого связывания с конкретным брокером.
- Если ни свойства доски, ни словарь расширений не содержат подсказок, fallback-лог помогает сопоставить поведение с документацией брокера (например, частичное исполнение только для лимиток).
- В отличие от MQL5 в StockSharp нет панели `Comment()`, поэтому сообщения выводятся через `LogInfo`/`LogWarning`, которые видны в журнале стратегии и в файлах логов.

## Отличия от версии MQL

- В MQL5 проверка выполнялась на каждом тике. В StockSharp она вынесена в `OnStarted`, поскольку метаданные доски статичны и нет смысла дублировать вывод.
- Вместо жестко прописанных флагов MetaTrader используется отражение для чтения свойств адаптера — это делает код устойчивым к обновлениям SDK и пригодным для разных площадок.
- Отсутствует вызов `Comment()`: все сообщения направляются в лог стратегии.

## Как запустить

1. Настройте коннектор и укажите нужный инструмент в параметрах стратегии.
2. Запустите стратегию и просмотрите лог, чтобы увидеть, какие свойства использованы и какие режимы исполнения доступны.
3. При необходимости включите `LogBoardDiagnostics`, чтобы получить расширенную информацию о биржевой доске и упростить проверку требований брокера.

Такой подход сохраняет обучающую ценность исходного скрипта и органично вписывается в инфраструктуру StockSharp.
