# 反转策略

## 概述

反转策略是一种均值回归系统，结合布林带与相对强弱指数（RSI）来识别行情的超买与超卖状态。当价格位于布林带外缘并且 RSI 再次回到阈值以内时，策略判断走势可能耗尽，尝试逆势进场，并通过固定的带宽止损与止盈控制风险收益。

## 交易逻辑

1. 订阅所配置的K线数据（默认 5 分钟K线）。
2. 基于设定的周期和标准差倍数计算布林带。
3. 基于设定的周期计算 RSI。
4. 记录上一根完成K线，用于检测跨越信号：
   - **做多条件**：上一根收盘价低于上一根下轨且 RSI 低于超卖阈值，本根收盘价重新站上当前下轨，同时 RSI 上穿超卖阈值。
   - **做空条件**：上一根收盘价高于上一根上轨且 RSI 高于超买阈值，本根收盘价重新跌破当前上轨，同时 RSI 下穿超买阈值。
5. 做多时以市价买入，止损设置在入场价下方一个标准差，止盈设置在入场价上方两个标准差。
6. 做空时以市价卖出，止损设置在入场价上方一个标准差，止盈设置在入场价下方两个标准差。
7. 持仓管理：
   - 多头仓位若触及上轨、触发止损或达到止盈则立即平仓。
   - 空头仓位若触及下轨、触发止损或达到止盈则立即平仓。

## 参数

| 名称 | 说明 | 默认值 |
| --- | --- | --- |
| `CandleType` | K线订阅的时间框架。 | 5 分钟 |
| `BollingerPeriod` | 布林带均线与标准差的计算周期。 | 20 |
| `BollingerWidth` | 布林带使用的标准差倍数。 | 2.0 |
| `RsiPeriod` | 计算 RSI 所使用的周期。 | 14 |
| `RsiOverbought` | 判断超买并触发做空条件的 RSI 阈值。 | 70 |
| `RsiOversold` | 判断超卖并触发做多条件的 RSI 阈值。 | 30 |

所有参数均可在 StockSharp Designer 或 Runner 中进行优化。调节 RSI 阈值可以改变信号的激进程度，调整布林带宽度可决定价格需要偏离均值的幅度。

## 使用说明

- 策略采用 StockSharp 高级 API，实现自动订阅K线并绑定指标。
- 交易通过 `BuyMarket` 与 `SellMarket` 市价单完成，止损与止盈在代码内部管理，不会在市场中挂出限价单。
- 默认设置适用于日内级别的反转交易，如需用于更高时间框架，可调整 `CandleType` 参数。
- 实盘部署时，可视需要叠加趋势、波动率或交易时段等过滤条件以提升稳定性。
