# Стратегия Build Your Grid

**Build Your Grid** — прямой перенос советника MetaTrader "BuildYourGridEA". Стратегия ведёт две независимые лестницы рыночных позиций (лонгов и шортов), добавляет новые уровни при каждом смещении цены на заданное количество пунктов и при необходимости увеличивает объёмы по заданной прогрессии. Корзина закрывается при достижении целевой прибыли, при превышении допустимой просадки в пунктах или с помощью защитных хеджирующих ордеров.

## Принцип работы

1. **Первичное открытие.** В зависимости от параметра *Order Placement* стратегия выставляет первый buy-, sell- или оба ордера, как только спред становится приемлемым.
2. **Расширение сетки.** Дополнительные сделки совершаются по тренду или против него. Расстояние до следующего уровня измеряется в пунктах и может умножаться на количество уже открытых сделок либо на степень двойки.
3. **Прогрессия объёмов.** Размер ордера следует выбранной схеме (фиксированной, геометрической или экспоненциальной) и ограничивается множителем *Max Multiplier* относительно первой позиции.
4. **Фиксация прибыли.** Вся корзина закрывается, когда суммарный плавающий результат превышает целевой уровень, выраженный в пунктах или валюте счёта.
5. **Ограничение убытков.** Если суммарная просадка по пунктам превышает порог *Loss (pips)*, стратегия в зависимости от режима закрывает первые сделки с каждой стороны либо всю корзину.
6. **Хеджирование.** При падении доходности ниже *Hedge Threshold (%)* выставляется балансирующий ордер объёмом, равным разнице между лонговым и шортовым объёмом, умноженной на *Hedge Multiplier*.

## Параметры

| Параметр | Описание |
| --- | --- |
| `Order Placement` | Разрешённые направления открытия (оба, только покупки, только продажи). |
| `Grid Direction` | Расширять сетку по тренду или контртрендово. |
| `Grid Step (pips)` | Базовый шаг в пунктах до следующего уровня. |
| `Step Progression` | Способ увеличения шага: фиксированный, геометрический (× количество), экспоненциальный (× 2^(n-1)). |
| `Close Target` | Тип целевого ориентира (в пунктах или валюте счёта). |
| `Target (pips)` / `Target (currency)` | Порог для закрытия всей корзины в плюс. |
| `Loss Handling` | Действие при достижении лимита убытка (ничего, закрыть первые сделки, закрыть все). |
| `Loss (pips)` | Максимальный суммарный убыток в пунктах до запуска защиты. |
| `Use Hedge` | Включить ли автоматические хеджирующие сделки. |
| `Hedge Threshold (%)` | Просадка в процентах от баланса, при которой запускается хедж. |
| `Hedge Multiplier` | Множитель для расчёта объёма хедж-ордера. |
| `Auto Volume` / `Risk Factor` | Автоматический объём = Баланс × RiskFactor / 100000. |
| `Manual Volume` | Фиксированный объём при отключённом автолоте. |
| `Lot Progression` | Модель роста объёмов (фикс., геометрическая, экспоненциальная). |
| `Max Multiplier` | Ограничение максимального объёма `первый лот × MaxMultiplier`. |
| `Max Orders` | Лимит одновременно открытых сделок (0 = без ограничения). |
| `Max Spread` | Запрет на новые входы, пока спред превышает порог (0 = игнорировать). |
| `Use Completed Bar` / `Candle Type` | Обработка сигналов только после закрытия выбранной свечи, как в исходном советнике. |

## Рекомендации по использованию

- Стратегия ориентируется на лучшие bid/ask цены, поэтому источник данных должен предоставлять точные котировки первого уровня.
- При активации хеджирования стратегия использует значение портфеля. В Designer/Testeр необходимо подключить портфель с актуальным балансом.
- Сеточные системы быстро наращивают риски. Начинайте с небольших объёмов и тестируйте конфигурацию в симуляции перед переходом на реальную торговлю.
- Включённый режим `Use Completed Bar` заставляет стратегию принимать решения только после закрытия свечи, воспроизводя поведение оригинального алгоритма.
