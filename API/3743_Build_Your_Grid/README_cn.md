# Build Your Grid 策略

**Build Your Grid 策略** 是 MetaTrader 专家顾问 “BuildYourGridEA” 的直接移植版本。它分别维护多头和空头两组市价仓位，当价格按
照设定的点差间距移动时添加新的网格层，并可按几何或指数方式放大下单手数。当组合利润达到目标、浮亏超过允许的点数，或
者浮动亏损占账户余额的比例达到阈值时，策略会平掉全部仓位或发送对冲订单以锁定风险。

## 工作原理

1. **首单建立。** 根据 *Order Placement*（下单方向）参数，在满足点差限制后，策略会立即开出首个买单、卖单或双向订单。
2. **网格扩展。** 额外订单可以顺势或逆势触发。到下一层的距离以点数衡量，并可按已开仓数量或 2^(n-1) 倍进行放大。
3. **手数递增。** 下单手数遵循所选的手数进阶规则（固定、几何或指数），并可通过 *Max Multiplier* 限制在首单手数的倍数范围内。
4. **获利平仓。** 当浮动盈亏（以点或以货币计）超过目标值时，全部网格仓位将同时平仓。
5. **亏损保护。** 当累计浮亏超过设定的点数上限时，策略会按照 *Loss Handling* 模式，仅关闭最早的买卖仓位或直接平掉所有仓位。
6. **对冲保护。** 当浮动亏损占账户余额的比例达到 *Hedge Threshold (%)* 时，策略会根据多空手数差并乘以 *Hedge Multiplier* 下发对冲订单，锁定风险敞口。

## 参数说明

| 参数 | 描述 |
| --- | --- |
| `Order Placement` | 允许开仓的方向（双向、仅多或仅空）。 |
| `Grid Direction` | 新网格层是顺势追涨/杀跌还是逆势高抛/低吸。 |
| `Grid Step (pips)` | 添加下一层前的基础点差距离。 |
| `Step Progression` | 点差固定、按仓位数量线性增长或按 2^(n-1) 指数增长。 |
| `Close Target` | 盈利目标的类型（以点或以账户货币计算）。 |
| `Target (pips)` / `Target (currency)` | 触发全局平仓所需的盈余阈值。 |
| `Loss Handling` | 达到亏损限制时的处理方式（不操作、仅平掉首单、平掉全部）。 |
| `Loss (pips)` | 触发保护前允许的最大浮亏点数。 |
| `Use Hedge` | 是否在深度回撤时使用对冲订单。 |
| `Hedge Threshold (%)` | 触发对冲的账户浮亏百分比阈值。 |
| `Hedge Multiplier` | 计算对冲手数时应用于多空手数差的乘数。 |
| `Auto Volume` / `Risk Factor` | 自动手数 = 账户余额 × RiskFactor / 100000。 |
| `Manual Volume` | 关闭自动手数时使用的固定手数。 |
| `Lot Progression` | 每层订单的手数递增方式（固定、几何或指数）。 |
| `Max Multiplier` | 将手数限制在 `首单手数 × MaxMultiplier` 以内。 |
| `Max Orders` | 同时持仓的最大订单数（0 表示不限制）。 |
| `Max Spread` | 当点差大于阈值时暂停加仓（0 表示忽略）。 |
| `Use Completed Bar` / `Candle Type` | 仅在所选 K 线收盘后执行决策，重现 EA 的 "Use Completed Bar" 选项。 |

## 使用建议

- 策略基于买卖价更新工作，请确保行情源提供实时的一级报价和准确的点差。
- 对冲手数依赖组合余额。若在 Designer 或 Tester 中运行，请确认所连接的投资组合能够返回有效的账户价值。
- 网格策略风险累积较快，请先用较小手数在模拟环境验证参数后再应用于实盘。
- 启用 `Use Completed Bar` 后，交易逻辑每根 K 线只评估一次，更贴近原始 EA 在收盘价上做出决策的行为。
