# Стратегия Simple MACD EA
[English](README.md) | [中文](README_cn.md)

## Общее описание
Simple MACD EA — это перенос классического советника MetaTrader «Simple MACD EA». Стратегия использует две экспоненциальные скользящие средние (EMA), чтобы воссоздать гистограмму MACD и определить доминирующее направление на минутных свечах. Длинная позиция открывается, когда EMA с периодом 100 поднимается выше медленной EMA с настраиваемым периодом. Короткая позиция открывается, когда быстрая EMA опускается ниже медленной. В рынке всегда присутствует только одна позиция.

## Логика управления сделками
- **Определение тренда.** Разность между EMA(100) и настраиваемой EMA задаёт текущий тренд (`+1`, `0`, `-1`). Переход значения из отрицательного в положительное приводит к открытию покупки. Обратный переход инициирует продажу.
- **Подтверждение импульса.** Стратегия отслеживает разницу между основной EMA и более медленной EMA с периодом `MACD level + 1`. Если эта разница сокращается против открытой позиции после движения цены не менее чем на пять пунктов в прибыль, позиция закрывается заранее.
- **Временная защита.** После того как сделка удерживается заданное число циклов, активируется «мягкий» стоп, снижающий допустимое неблагоприятное движение относительно цены входа.
- **Трейлинг-выход.** Когда сделка уходит в прибыль и остаётся открытой достаточное число циклов, включается внутренний трейлинг-стоп. Уровень стопа следует за ценой на заданное количество пунктов и может быть обновлён ограниченное число раз. После исчерпания лимита позиция закрывается.
- **Выход по смене тренда.** Если трендовый сигнал разворачивается в противоположную сторону, а цена уже находится минимум на пять пунктов в прибыли, позиция закрывается немедленно.

## Параметры
- **Тип свечей** — таймфрейм, по которому рассчитываются EMA (по умолчанию 1 минута).
- **Объём** — объём заявки для новых входов.
- **MACD Level** — период медленной EMA. Дополнительно автоматически создаётся EMA с периодом `MACD Level + 1`.
- **Trailing Stop** — расстояние трейлинг-стопа в пунктах. Ноль отключает функцию.
- **Trailing Updates** — максимальное число обновлений трейлинг-стопа для одной сделки.
- **Wait Cycles** — количество циклов ожидания перед активацией мягкого стопа.

## Дополнительные замечания
- Перед сменой направления стратегия всегда закрывает текущую позицию.
- Для перевода пунктов в цены используется шаг цены выбранного инструмента.
- Реализация построена на высокоуровневом API подписки на свечи StockSharp и не создаёт собственных буферов индикаторов.
