# Стратегия Chart Button Test

## Общее описание
**Chart Button Test Strategy** переносит логику оригинального MQL-примера в StockSharp. Вместо графического элемента создаётся виртуальная ценовая зона, центр которой следует за последними данными рынка. Информационные сообщения в журнале имитируют обратную связь от перетаскиваемой кнопки на графике MetaTrader.

Стратегия не подаёт торговых заявок. Её задача — отслеживать, находится ли цена закрытия завершённых свечей внутри зоны, и фиксировать все переходы в журнале. Далее оператор может построить оповещения или дополнительные автоматические действия на основе этих записей.

## Принцип работы
1. После закрытия первой свечи стратегия инициализирует виртуальную кнопку: фиксирует цену закрытия, задаёт границы зоны и рассчитывает временное окно длиной, указанной в параметре **Selection Length**.
2. Каждая новая завершённая свеча обновляет зону:
   * Если **Lock Time** выключен, временное окно сдвигается вперёд вместе со свечой.
   * Независимо от настройки времени, верхняя и нижняя границы пересчитываются из текущей цены и параметра **Price Padding**.
3. При входе или выходе цены из зоны в журнал добавляется сообщение с указанием события.
4. Любое изменение параметров во время работы приводит к немедленному перерасчёту зоны и поясняющему сообщению в журнале.

Таким образом воспроизводится функционал MQL-советника с перетаскиваемой кнопкой, но в парадигме высокоуровневого API StockSharp.

## Параметры
| Параметр | Описание |
|----------|----------|
| **Candle Type** | Тип свечных данных, которые обрабатывает стратегия. По умолчанию — таймфрейм 5 минут. |
| **Price Padding** | Полуширина отслеживаемой зоны вокруг центральной цены. Значение должно быть положительным, по умолчанию 10. |
| **Selection Length** | Длительность временного окна виртуальной кнопки. По умолчанию 1 час. |
| **Lock Time** | При включении фиксирует границы окна по времени. При выключении окно перемещается вслед за каждой новой свечой. |

## Как использовать
1. Добавьте стратегию в портфель и выберите нужный инструмент.
2. Настройте тип свечей и ширину зоны в соответствии с волатильностью инструмента.
3. Запустите стратегию и дождитесь закрытия первой свечи. В журнале появится сообщение о создании виртуальной кнопки.
4. По необходимости меняйте параметры **Price Padding** и **Selection Length** — все изменения сопровождаются логами.
5. Следите за сообщениями «entered» и «left» в журнале, чтобы понимать, находится ли цена внутри отслеживаемой зоны.

## Отличия от версии MQL
- В StockSharp не создаётся визуальная кнопка, взаимодействие реализовано через расчёты и логирование.
- Перемещение кнопки мышью заменено на изменение параметров, что полностью соответствует подходу высокоуровневого API.
- Скрипт не совершает сделок, как и оригинальный пример.

## Дополнительные замечания
- На основе стратегии легко построить оповещения или добавить торговую логику при входе/выходе цены из зоны.
- Поскольку используется закрытие свечей, рекомендуется выбирать таймфрейм, подходящий по скорости реакции.
