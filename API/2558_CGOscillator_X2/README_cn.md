# CGOscillator X2 策略

## 概述

**CGOscillator X2 策略**是一套基于重心振荡指标（Center of Gravity Oscillator）的多周期顺势系统。策略先在更高周期上评估振荡器的斜率来确认主导趋势，再等待较低周期出现回调钩形信号后顺势入场。策略提供以绝对价格单位表示的止损与止盈参数，允许在开仓后即时设置风险控制。

## 交易逻辑

1. **趋势识别（高周期）**
   - 在趋势周期上使用参数 `TrendLength` 计算 CG 振荡器。
   - 当前 CG 值高于信号线（上一周期的 CG 值）时判定为多头趋势；低于信号线时判定为空头趋势。
2. **信号生成（低周期）**
   - 在信号周期上使用独立长度的 CG 振荡器。
   - 策略比较最近两个已完成 K 线：若当前 CG ≥ 信号且上一根 CG < 上一根信号，则视为下跌趋势中的多头钩形；若当前 CG ≤ 信号且上一根 CG > 上一根信号，则视为上涨趋势中的空头钩形。
3. **开仓与平仓**
   - 仅当高周期显示上升趋势且低周期出现空头钩形（回调到超卖区）时才允许做多；做空逻辑为镜像条件。
   - 依据布尔参数可选择在高周期趋势翻转时平仓，或在低周期钩形反向时立即平仓。
4. **风险控制**
   - 每次市价开仓后都会根据参数设置绝对距离的止损和止盈。当价格在当前 K 线内触发止损或止盈时，策略会先行平仓再处理新的信号。

## 参数说明

| 名称 | 说明 |
| ---- | ---- |
| `TrendCandleType` | 用于趋势分析的蜡烛类型（时间框架）。 |
| `SignalCandleType` | 用于信号分析的蜡烛类型。 |
| `TrendLength` | 趋势周期 CG 振荡器的长度。 |
| `SignalLength` | 信号周期 CG 振荡器的长度。 |
| `BuyOpen` | 是否允许在上升趋势内开多仓。 |
| `SellOpen` | 是否允许在下降趋势内开空仓。 |
| `BuyClose` | 高周期趋势转为空头时是否平掉多单。 |
| `SellClose` | 高周期趋势转为多头时是否平掉空单。 |
| `BuyCloseSignal` | 低周期出现空头钩形时是否平掉多单。 |
| `SellCloseSignal` | 低周期出现多头钩形时是否平掉空单。 |
| `StopLoss` | 以绝对价格表示的止损距离，0 表示不启用。 |
| `TakeProfit` | 以绝对价格表示的止盈距离，0 表示不启用。 |

## 指标细节

自定义的 **CenterOfGravityOscillatorIndicator** 完全复刻 MT5 版本的 CG 振荡器：
- 使用 `(最高价 + 最低价) / 2` 的中位价作为输入。
- 对最近 `Length` 根中位价进行加权求和得到 CG 值。
- 信号线是上一周期的 CG 值，用于识别钩形拐点。

## 使用提示

- 通过设置策略的 `Volume` 属性来确定基础下单数量。若需要反手，策略会自动在市价单中加入当前仓位的绝对值，确保新仓方向正确。
- 策略仅在 K 线收盘后做出决策，能够减少盘中噪音干扰，但会在每根 K 线收盘时才反应。
- 止损与止盈采用绝对价格单位，请根据标的品种的最小变动价位与波动性进行调整。
- 只需配置合适的蜡烛类型，该策略即可用于 StockSharp 支持的任何交易品种。
