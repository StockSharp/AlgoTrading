# Стратегия Simple FX

## Краткое описание
- Высокоуровневая портированная версия эксперта MetaTrader 4 *simplefx2.mq4* (Simple FX 2.0).
- Торгует пересечением быстрой и медленной простых скользящих средних по закрытым свечам.
- Держит только одну позицию и переворачивается при смене доминирующего тренда.

## Логика торговли
1. Формирует свечи выбранного таймфрейма.
2. Рассчитывает две простые скользящие средние (быструю и медленную) по ценам закрытия свечей.
3. Подтверждает бычий тренд, когда и текущая, и предыдущая свечи показывают, что быстрая SMA находится выше медленной. Медвежий тренд подтверждается, когда обе свечи показывают обратное соотношение.
4. Если подтверждённый тренд отличается от сохранённого состояния, стратегия закрывает противоположную позицию и немедленно открывает рыночную сделку в направлении нового тренда с заданным объёмом.
5. Дополнительно можно задать уровни стоп-лосса и тейк-профита в шагах цены; они реализуются через сервис защиты StockSharp и повторяют настройки из MT4.

Стратегия работает только с завершёнными свечами и не реагирует на внутрисвечные тики, что обеспечивает максимальное соответствие оригинальному эксперту. Для каждого входа в позицию в журнал записывается поясняющее сообщение.

## Параметры
| Имя | Описание | Значение по умолчанию | Диапазон оптимизации |
| --- | --- | --- | --- |
| `ShortPeriod` | Период быстрой простой скользящей средней. | 50 | 10 → 150 шаг 5 |
| `LongPeriod` | Период медленной простой скользящей средней. | 200 | 50 → 400 шаг 10 |
| `Volume` | Объём рыночной заявки при входе. | 0.1 | 0.1 → 2 шаг 0.1 |
| `StopLossPoints` | Расстояние стоп-лосса в шагах цены (0 отключает). | 0 | — |
| `TakeProfitPoints` | Расстояние тейк-профита в шагах цены (0 отключает). | 0 | — |
| `CandleType` | Таймфрейм свечей для анализа. | 1 час | — |

## Отличия от версии MT4
- Файл `simplefx.dat` больше не нужен: направление тренда хранится во внутреннем состоянии стратегии.
- Параметры скольжения, комментария, magic number и цветов стрелок не перенесены, т.к. маршрутизация заявок в StockSharp устроена иначе.
- Уровни стоп-лосса и тейк-профита задаются в **шагах цены**. При необходимости скорректируйте их под размер пункта у вашего брокера.
- В любой момент времени открыта только одна позиция. Перед переворотом вызывается `ClosePosition()`, что гарантирует чистый переход между long и short.

## Как использовать
1. Выберите инструмент и настройте желаемый таймфрейм свечей.
2. Отредактируйте периоды скользящих средних и параметры управления рисками.
3. Запустите стратегию — она подпишется на свечи, будет отслеживать смену тренда и совершать рыночные сделки после подтверждённого пересечения на двух последовательных свечах.
