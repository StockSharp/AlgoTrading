# Simple FX 策略

## 摘要
- 基于 MetaTrader 4 专家顾问 *simplefx2.mq4*（Simple FX 2.0）的高层 API 移植版本。
- 在收盘完成的K线数据上交易快/慢简单移动平均线的金叉与死叉。
- 始终只保持一个方向的仓位，在趋势反转时立即翻转持仓。

## 交易逻辑
1. 按照可配置的时间框架生成K线。
2. 使用K线收盘价计算一条快线和一条慢线简单移动平均值。
3. 当当前与上一根K线都显示快线高于慢线时确认多头趋势；当两根K线都显示快线低于慢线时确认空头趋势。
4. 如果确认的趋势与策略保存的趋势状态不同，则先平掉反向持仓，再按照设定手数以市价开仓跟随新趋势。
5. 可选的止损/止盈设置使用价格步长表示，并通过 StockSharp 的保护服务执行，以贴近原始 MT4 机器人。

策略仅处理完整收盘的K线，不对单个Tick作出反应，从而保持与原程序一致的节奏。每次开仓都会写入日志，便于复盘每个交叉信号。

## 参数
| 名称 | 描述 | 默认值 | 优化范围 |
| --- | --- | --- | --- |
| `ShortPeriod` | 快速简单移动平均线周期。 | 50 | 10 → 150 步长 5 |
| `LongPeriod` | 慢速简单移动平均线周期。 | 200 | 50 → 400 步长 10 |
| `Volume` | 每次市价单的交易手数。 | 0.1 | 0.1 → 2 步长 0.1 |
| `StopLossPoints` | 以价格步长表示的止损距离（0 表示关闭）。 | 0 | — |
| `TakeProfitPoints` | 以价格步长表示的止盈距离（0 表示关闭）。 | 0 | — |
| `CandleType` | 用于分析的K线时间框架。 | 1 小时 | — |

## 与 MT4 版本的差异
- 不再需要 MT4 的 `simplefx.dat` 持久化文件，趋势方向在策略状态中直接维护。
- MT4 中的滑点、订单备注、魔术编号和箭头颜色等选项未提供，对应功能由 StockSharp 以不同方式处理。
- 止损与止盈距离以**价格步长**解释，部署前请根据交易商的点值调整。
- 策略始终只有一笔仓位，翻转时通过 `ClosePosition()` 清理旧仓后再开新仓。

## 使用步骤
1. 选择交易品种并设置所需的K线时间框架。
2. 根据需要调整两条移动平均线周期以及风控参数。
3. 启动策略后，它会订阅K线、维护趋势状态，并在连续两根K线确认交叉时发出市价单。
