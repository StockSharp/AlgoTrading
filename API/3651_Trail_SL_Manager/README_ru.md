# Стратегия Trail SL Manager

## Краткое описание

Trail SL Manager — это перенос советника MetaTrader `trailSL` на платформу StockSharp.
Стратегия не генерирует сделки самостоятельно: она отслеживает уже открытые позиции и автоматически сдвигает защитный стоп.
Сначала стоп переводится в безубыток после набора заданного количества пунктов, затем по мере движения рынка выполняется пошаговое трейлинг-сопровождение.

## Логика работы

1. Стратегия подписывается на выбранный тип свечей и обрабатывает только закрытые бары.
2. Вычисляет направление позиции и её среднюю цену входа, переводя текущее преимущество в пункты.
3. Как только прибыль достигает `BreakEvenTriggerPoints`, стоп переносится к цене входа с учётом `BreakEvenOffsetPoints`.
4. После перевода в безубыток (или сразу, если разрешено) каждые `TrailStepPoints` пунктов стоп подтягивается ещё на `TrailOffsetPoints`. При возврате цены к уровню стопа позиция закрывается по рынку.

Расчёты выполнены в тех же пунктах, что и в оригинальном советнике, поэтому поведение знакомо пользователям, переходящим с MetaTrader.

## Параметры

| Параметр | Назначение | Значение по умолчанию |
|----------|------------|------------------------|
| `EnableBreakEven` | Включает перевод стопа в безубыток. | `true` |
| `BreakEvenTriggerPoints` | Количество пунктов прибыли для срабатывания безубытка. | `20` |
| `BreakEvenOffsetPoints` | Дополнительные пункты, фиксируемые при переносе стопа. | `10` |
| `EnableTrailing` | Включает трейлинг-стоп. | `true` |
| `TrailAfterBreakEven` | Запускает трейлинг только после безубытка. | `true` |
| `TrailStartPoints` | Минимальная прибыль, позволяющая начать трейлинг. | `40` |
| `TrailStepPoints` | Шаг прибыли между пересчётами стопа. | `10` |
| `TrailOffsetPoints` | Количество пунктов, на которое подтягивается стоп при каждом шаге. | `10` |
| `InitialStopPoints` | Начальная дистанция защитного стопа для новой позиции. | `200` |
| `CandleType` | Тип свечей для контроля движения цены. | `1 Minute` |

## Использование

1. Запустите стратегию совместно с другой стратегией или ручными сделками, которые формируют позиции.
2. Настройте пороги по пунктам с учётом волатильности инструмента и ограничений брокера.
3. Стартуйте стратегию, чтобы она отслеживала закрытые свечи и своевременно подтягивала стопы.
4. При необходимости используйте реальные биржевые стоп-заявки в дополнение к рыночному закрытию, которое выполняет стратегия.

> **Важно:** При пробое виртуального трейлинг-стопа стратегия закрывает позицию по рынку. Если требуется аппаратная защита на стороне биржи, добавьте собственные защитные ордера.
