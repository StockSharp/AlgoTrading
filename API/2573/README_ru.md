# Стратегия e_RP_250 Reverse Point
[English](README.md) | [中文](README_cn.md)

Эта стратегия представляет собой портирование эксперта MetaTrader 5 `e_RP_250` на платформу StockSharp. Исходная система
работает от разворотных точек, которые вычисляет пользовательский индикатор *rPoint*. Поскольку оригинальный индикатор недоступен
в StockSharp, при конверсии используется связка индикаторов `Highest` и `Lowest`, полностью воспроизводящая поведение rPoint.
Как только формируется новый локальный максимум или минимум, стратегия переворачивает позицию и навешивает те же stop-loss,
take-profit и опциональный трейлинг-стоп, что и в версии для MQL.

В исходном коде не приводятся проверенные результаты тестирования, поэтому перед реальной торговлей обязательно выполните
собственную оценку эффективности.

## Логика торговли

- Подписка на свечи, заданные параметром `CandleType` (по умолчанию 5-минутные бары).
- Отслеживание максимума и минимума за последние `ReversePoint` свечей (по умолчанию 250 баров).
- Если текущая свеча обновляет максимум, закрывается лонг (если он был) и открывается шорт.
- Если текущая свеча обновляет минимум, закрывается шорт (если он был) и открывается лонг.
- Уровни stop-loss и take-profit задаются в пунктах и реализуются через `StartProtection`.
- Дополнительный трейлинг-стоп фиксирует прибыль после прохождения ценой заданного количества пунктов.

В каждый момент времени открыта только одна позиция. Стратегия также блокирует повторные сигналы на одной и той же свече,
запоминая время последнего срабатывания — тем самым повторяется защита `TimeN` из исходного скрипта.

## Параметры

| Параметр | Описание |
|----------|----------|
| `TakeProfitPoints` | Дистанция take-profit в ценовых пунктах (по умолчанию **15**). Ноль отключает автоматическое фиксирование прибыли. |
| `StopLossPoints` | Дистанция stop-loss в ценовых пунктах (по умолчанию **999**). Ноль означает торговлю без фиксированного стопа. |
| `TrailingStopPoints` | Опциональный трейлинг-стоп в пунктах (по умолчанию **0** — трейлинг выключен). |
| `ReversePoint` | Количество свечей для определения разворотных точек. Чем больше значение, тем «плавнее» реакции на шум. |
| `CandleType` | Тип анализируемых свечей. По умолчанию 5-минутный таймфрейм, но можно выбрать любой `DataType`. |

## Управление позицией

- `StartProtection` выставляет те же stop-loss и take-profit, что и оригинальный эксперт.
- Трейлинг-стоп отслеживает наилучшую цену после входа и закрывает сделку при откате на заданное расстояние.
- Сигнал обратного направления закрывает текущую позицию и затем инициирует новый вход.

## Рекомендации по использованию

- Убедитесь, что поставщик данных поддерживает выбранный тип свечей, иначе сигналы появляться не будут.
- Проверьте корректность `PriceStep` у инструмента — от него зависит пересчёт пунктов в цену.
- Экспериментируйте со значением `ReversePoint`, чтобы подобрать чувствительность под волатильность конкретного актива.
