# e_RP_250 反转点策略
[English](README.md) | [Русский](README_ru.md)

本策略是 MetaTrader 5 专家顾问 `e_RP_250` 在 StockSharp 平台上的移植版本。原始脚本依赖自定义 *rPoint* 指标来识别
关键反转点。由于该指标在 StockSharp 中不可用，本移植使用 `Highest` 与 `Lowest` 指标组合来重现相同的效果。一旦
出现新的摆动高点或低点，策略就会翻转持仓，并应用与 MQL 版本相同的止损、止盈以及可选的跟踪止损规则。

原始源码未提供经过验证的历史测试结果，因此在实盘运行之前请务必自行评估策略表现。

## 交易逻辑

- 订阅由 `CandleType` 参数指定的 K 线数据（默认使用 5 分钟 K 线）。
- 计算最近 `ReversePoint` 根 K 线内的最高价和最低价（默认窗口为 250 根）。
- 当当前 K 线刷新最高价时，平掉多头仓位并开立新的空头仓位。
- 当当前 K 线刷新最低价时，平掉空头仓位并开立新的多头仓位。
- 通过 `StartProtection` 以价格点为单位复现原策略的止损和止盈距离。
- 可选的跟踪止损在价格朝有利方向运行指定点数后锁定利润。

任意时刻仅允许存在一笔仓位。策略还会记录上一次下单的 K 线时间，从而避免在同一根 K 线上重复触发信号，
这一点与原脚本中的 `TimeN` 机制保持一致。

## 参数说明

| 参数 | 说明 |
|------|------|
| `TakeProfitPoints` | 止盈距离（单位：价格点），默认 **15**。设为 0 可关闭自动止盈。 |
| `StopLossPoints` | 止损距离（单位：价格点），默认 **999**。设为 0 表示不设置固定止损。 |
| `TrailingStopPoints` | 跟踪止损距离（单位：价格点），默认 **0** 表示禁用。 |
| `ReversePoint` | 用于识别反转点的窗口长度。值越大，信号越平滑、触发越晚。 |
| `CandleType` | 使用的 K 线类型，默认是 5 分钟，可根据需要调整为任何 `DataType`。 |

## 仓位管理

- `StartProtection` 用来应用与 MT5 专家相同的止损与止盈设置。
- 跟踪止损会跟踪入场后的最有利价格，并在价格回撤指定点数时退出。
- 相反方向的信号会立即平掉当前仓位，然后再开立新的仓位。

## 使用建议

- 确认数据源支持所选的 K 线周期，否则策略不会产生信号。
- 请检查交易品种的 `PriceStep` 值，确保价格点与实际最小报价单位一致。
- 根据标的的波动特性调整 `ReversePoint`，以平衡噪声过滤与信号灵敏度。
