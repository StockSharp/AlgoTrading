# Стратегия News Trader

Стратегия повторяет логику оригинального советника **NewsTrader.mq4**: за несколько минут до выхода новости выставляются отложенные стоп-заявки на покупку и продажу. За 10 минут до указанного времени публикации робот размещает два стоп-ордера и, после срабатывания одного из них, сразу подключает защитные заявки.

## Основная логика

- Используется подписка на минутные свечи (тип можно изменить) только для отслеживания времени.
- Время активации вычисляется как `время новости – LeadMinutes`, и стратегия ждёт первой завершённой свечи, чьё время открытия не меньше этого момента.
- Вычисляет цены стоп-заявок сдвигом на `BiasPips`, умноженным на `Security.PriceStep`, полностью повторяя выражение `bias * Point` из версии на MQL4.
- После исполнения одной стоп-заявки противоположная отменяется, а к открытой позиции привязываются собственные стоп-лосс и тейк-профит с заданными пипсовыми расстояниями.
- Срабатывание стоп-лосса или тейк-профита отменяет оставшуюся защитную заявку и закрывает позицию.
- В `OnStarted` вызывается `StartProtection()`, чтобы стратегия могла работать совместно с общесистемными защитными механизмами StockSharp.

## Параметры

| Имя | Описание | Значение по умолчанию |
| --- | --- | --- |
| `TradeVolume` | Объём каждой отложенной заявки. | `1` |
| `StopLossPips` | Размер стоп-лосса в пипсах (0 — без защитного стопа). | `10` |
| `TakeProfitPips` | Размер тейк-профита в пипсах (0 — без цели). | `10` |
| `BiasPips` | Смещение стоп-заявок относительно текущей цены. | `20` |
| `LeadMinutes` | Сколько минут до новости активировать заявки. | `10` |
| `NewsYear`, `NewsMonth`, `NewsDay`, `NewsHour`, `NewsMinute` | Дата и время новости в часах торговой площадки. | `2010`, `3`, `8`, `1`, `30` |
| `CandleType` | Тип свечей, используемый для контроля времени. | `1 Minute` |

## Особенности реализации

- В `OnStarted` свойство `Volume` приравнивается к `TradeVolume`, чтобы методы `BuyStop` и `SellStop` использовали правильный объём.
- Если у инструмента не задан `PriceStep`, стратегия выбрасывает исключение, потому что невозможно перевести пипсовые расстояния в цены.
- Для расчёта уровней используется цена закрытия свечи — это аналог последней котировки `Bid/Ask`, применённой в MQL-версии.
- Отложенные заявки создаются только один раз; после наступления события переинициализация не выполняется автоматически.
- Если значения `StopLossPips` или `TakeProfitPips` равны нулю, соответствующие защитные заявки не выставляются, что оставляет пространство для ручного управления.

## Файлы

- `CS/NewsTraderStrategy.cs` — реализация стратегии на C#.

Python-версия специально не создавалась по требованию задачи.
