# Стратегия OsMaSter V0

## Общее описание
- Конвертирована из эксперта MetaTrader 5 «OsMaSter v0» (файл MQL `OsMaSter v0.mq5`).
- Использует паттерн индикатора MACD Histogram (OsMA) для поиска разворотов импульса после локальной консолидации.
- Работает с одним инструментом и таймфреймом, который задаётся параметром `CandleType`.
- Автоматически преобразует стоп-лосс и тейк-профит, заданные в пунктах, в абсолютные ценовые значения с учётом шага цены и количества знаков инструмента.

## Параметры
| Имя | Значение по умолчанию | Описание |
| --- | --- | --- |
| `FastPeriod` | 9 | Длина быстрой EMA для расчёта гистограммы MACD. |
| `SlowPeriod` | 26 | Длина медленной EMA для расчёта гистограммы MACD. |
| `SignalPeriod` | 5 | Период сигнальной EMA, сглаживающей гистограмму. |
| `StopLossPips` | 30 | Размер защитного стопа в пунктах. Значение `0` отключает стоп. |
| `TakeProfitPips` | 50 | Размер тейк-профита в пунктах. Значение `0` отключает цель. |
| `TradeVolume` | 1 | Объём заявки (лотов), используемый при входе по рынку. |
| `CandleType` | Свечи 15 минут | Таймфрейм, по которому рассчитываются индикаторы. |

## Логика сигналов
1. Стратегия хранит четыре последние величины гистограммы MACD (`hist0` — текущая, `hist1` — предыдущая, ..., `hist3` — три свечи назад).
2. **Покупка** выполняется, когда `hist3 > hist2`, `hist2 < hist1` и `hist1 < hist0`, что соответствует формированию локального минимума и росту гистограммы.
3. **Продажа** выполняется, когда `hist3 < hist2`, `hist2 > hist1` и `hist1 > hist0`, что соответствует локальному максимуму и снижению гистограммы.
4. Одновременно может быть открыта только одна позиция, новые сигналы игнорируются до закрытия текущей сделки.

## Управление позицией
- Ордера выставляются методами `BuyMarket()` и `SellMarket()` с объёмом `TradeVolume`.
- Метод `StartProtection` прикрепляет стоп-лосс и тейк-профит, рассчитывая ценовое смещение из заданных пунктов. Для инструментов с 3 или 5 знаками используется правило «шаг цены × 10», иначе берётся сам шаг цены.
- Дополнительных правил выхода нет: позиции закрываются защитными ордерами или вручную.

## Примечания
- Убедитесь, что у инструмента корректно заданы `PriceStep` и `Decimals`, иначе пересчёт пунктов может отличаться от спецификации брокера.
- Подберите подходящий таймфрейм и объём в зависимости от цели торговли.
- Пока открыта позиция, повторные сигналы в ту же сторону пропускаются, так как стратегия ожидает исполнения стопа или тейк-профита.
