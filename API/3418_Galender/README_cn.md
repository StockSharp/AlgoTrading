# Galender 策略

## 概述

**Galender Strategy** 在 StockSharp 高级 API 中重现了 MQL5 "Galender" 专家的逻辑。策略订阅经济新闻数据流，并根据时间区间、货币代码、关键字以及重要性等级过滤消息。所有符合条件的事件都会按照时间顺序保存，效果与原始 EA 中的列表视图一致。

> **提示**
> 本策略仅用于信息通知，不会自动下单。它适合希望在 StockSharp 终端内跟踪宏观经济公告的交易者。

## 参数

| 参数 | 说明 | 默认值 |
|------|------|--------|
| `DateFrom` | 需要监控的最早 UTC 时间，早于该时间的新闻将被忽略。 | `2020-07-01T00:00:00Z` |
| `DateTo` | 需要监控的最晚 UTC 时间，晚于该时间的新闻将被忽略。 | `2020-09-01T00:00:00Z` |
| `CurrencyFilter` | 以逗号分隔的货币代码列表，策略会在新闻标题和正文中查找这些代码。留空表示不过滤。 | `USD` |
| `KeywordFilter` | 必须出现在新闻中的关键字（不区分大小写）。留空表示不过滤。 | `interest` |
| `ImportanceFilter` | 需要的新闻重要性：`None`、`Low`、`Moderate`、`High` 或 `All`。通过匹配新闻文本中的对应标签实现。 | `All` |

## 工作流程

1. **启动**：策略启动后清空历史记录，并针对所选证券订阅新闻数据。
2. **消息过滤**：每条 `NewsMessage` 都会依次检查发布时间、货币代码、关键字和重要性是否满足条件。
3. **保存事件**：符合条件的新闻被转换为内部日历条目，包含发布时间、推断出的货币代码、事件标题、影响方向（Positive/Negative/None）以及 `Previous`、`Forecast`、`Actual` 之后的文本片段。条目按时间排序。
4. **记录日志**：策略会以英文写入日志，总结每条匹配新闻和提取出的字段。

## 与 MQL5 版本的差异

- StockSharp 版本没有图形界面，所有结果通过日志输出。
- MQL5 专用的经济日历接口不可用，策略改为分析数据提供商的普通新闻流，并依赖关键字识别重要性。
- 数值字段通过简单的字符串解析获得，如果格式不兼容，这些字段将保持为空，以避免误报。

## 使用建议

- 将策略绑定到与目标货币相关的证券，以确保成功订阅新闻。
- 支持多个货币代码，例如 `USD,EUR,GBP`。过滤器会逐一匹配，并识别单词边界。
- 将 `ImportanceFilter` 设置为 `All` 可模拟 MQL5 中的 "All" 选项，其他值则会限制匹配的新闻等级。
- 如果希望捕获所有新闻，可以把 `KeywordFilter` 留空。

## 扩展思路

- 结合 WPF 或 Avalonia 等界面框架，将条目显示在可视化列表中。
- 如果数据源提供结构化的字段，可用它们取代关键字匹配逻辑。
- 将该策略的输出与其他交易策略联动，在高影响力新闻公布前暂停自动交易。
