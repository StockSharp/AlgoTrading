# Стратегия Exp Skyscraper Fix Duplex

## Обзор
Exp Skyscraper Fix Duplex — порт советника MQL5 *Exp_Skyscraper_Fix_Duplex*. Стратегия строит каналы Skyscraper Fix для длинной и короткой стороны отдельно, поэтому для каждого направления можно выбрать свою таймфреймную серию, длину ATR и чувствительность. Это позволяет по-разному реагировать на фазу рынка, но использовать единый торговый модуль StockSharp.

## Логика индикатора
Пользовательский индикатор **Skyscraper Fix** повторяет исходный алгоритм:

- Для каждой завершённой свечи считается ATR с фиксированным периодом 15.
- Максимальное и минимальное значения ATR внутри окна `Length` задают адаптивный шаг по цене.
- В зависимости от параметра `Mode` используются либо High/Low, либо Close свечи для построения верхней и нижней границ на расстоянии двух шагов.
- Пробой закрытием выше верхней или ниже нижней границы переворачивает внутренний тренд и фиксирует противоположный уровень так, чтобы он не смещался против текущего направления.
- Пересечение противоположной линии даёт дискретный сигнал на покупку или продажу (аналог буферов-стрелок в MQL).

Индикатор возвращает значения верхнего и нижнего трейлинга, уровни входа и вспомогательную среднюю линию, которую можно отрисовать в чартинге.

## Торговые правила
Длинная и короткая логика обрабатываются независимо для каждой завершённой свечи соответствующей подписки:

- **Вход в лонг** — при появлении нового уровня `Buy` от длинного индикатора. Сначала закрывается возможный шорт, затем открывается лонг по рынку указанным объёмом.
- **Выход из лонга** — при появлении уровня `Lower`, лонг закрывается рыночной продажей.
- **Вход в шорт** — при появлении уровня `Sell` от короткого индикатора. Сначала закрывается возможный лонг, затем открывается шорт по рынку.
- **Выход из шорта** — при появлении уровня `Upper`, активный шорт покрывается рыночной покупкой.

Параметры `SignalBar` позволяют задержать обработку сигнала на указанное число закрытых свечей (`1` соответствует поведению оригинала, `0` — работа по последней свече).

## Параметры
- `TradeVolume` — объём заявок для рыночных входов.
- `EnableLongEntries` / `EnableLongExits` — разрешение торговли в лонг.
- `LongCandleType` — тип свечей для длинного индикатора.
- `LongLength`, `LongKv`, `LongPercentage`, `LongMode`, `LongSignalBar` — настройки Skyscraper Fix для длинной стороны.
- `EnableShortEntries` / `EnableShortExits` — разрешение торговли в шорт.
- `ShortCandleType` — тип свечей для короткого индикатора.
- `ShortLength`, `ShortKv`, `ShortPercentage`, `ShortMode`, `ShortSignalBar` — настройки Skyscraper Fix для короткой стороны.

## Примечания по использованию
- Параметр `TradeVolume` задаёт свойство `Volume`, поэтому вызовы `BuyMarket()` и `SellMarket()` используют этот объём автоматически.
- Оба индикатора читают `PriceStep` инструмента. Пока шаг цены равен нулю, расчёт сигналов приостанавливается.
- При старте вызывается `StartProtection()`, чтобы до первой сделки активировались базовые защитные механизмы.
- Версия на Python не создавалась согласно заданию, поэтому папка `PY` отсутствует.
