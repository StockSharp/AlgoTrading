# Стратегия Aussie Surfer Ltd

## Обзор
**Aussie Surfer Ltd** — это порт советника MetaTrader 5 "Aussie Surfer Ltd" (папка MQL `43278`) на высокоуровневый API StockSharp. Стратегия сочетает отскоки от полос Боллинджера с фильтром по линии "зубов" индикатора Alligator, чтобы автоматизировать авторский подход оригинального эксперта. По умолчанию анализ ведётся по 15-минутным свечам и исполняется на выбранном инструменте рыночными ордерами.

## Индикаторы и данные
- **Полосы Боллинджера (цена закрытия, период 5, отклонение 2.5)** — фиксируют моменты, когда цена выходит за пределы канала и быстро возвращается внутрь.
- **Сглаженная скользящая средняя (период 21)** — воссоздаёт линию зубов Alligator и позволяет оценить изменение наклона тренда.
- **Медианная цена свечи ((High + Low) / 2)** — подаётся на вход Alligator, чтобы сохранить динамику, идентичную MetaTrader.

Стратегия подписывается на единственную свечную серию и обрабатывает только завершённые свечи, что исключает ложные сигналы на незакрытых барах.

## Логика торговли
1. **Вход**
   - Если предыдущая свеча открылась выше своей нижней полосы, а текущая открывается ниже значения нижней полосы двух баров назад, то стратегия закрывает шорт (если он есть) и открывает **лонг**. Это повторяет идею «прокола» нижней полосы и возврата внутрь канала.
   - Если предыдущая свеча открылась ниже верхней полосы, а текущая открывается выше значения верхней полосы двух баров назад, то закрывается лонг и открывается **шорт**.
2. **Выход по Alligator**
   - Отслеживаются значения зубов Alligator на двух предыдущих свечах. Если для лонга значение два бара назад выше, чем один бар назад, тренд ослабевает и позиция закрывается. Для шорта условие зеркальное: когда наклон разворачивается вверх, шорт закрывается.
3. **Управление рисками**
   - При входе задаются фиксированные уровни стоп-лосса и тейк-профита в пунктах. Нулевое значение отключает соответствующий уровень.
   - При активном стоп-лоссе и включённой опции трейлинг-стоп подтягивается к максимуму (для лонга) или минимуму (для шорта) предыдущей завершённой свечи с учётом выбранного расстояния в пунктах.

## Управление риском
- **Стоп-лосс** — переводит заданные пункты в цену с помощью шага цены инструмента (`PriceStep`).
- **Тейк-профит** — фиксируется при открытии позиции и остаётся неизменным до срабатывания или закрытия по другому правилу.
- **Трейлинг-стоп** — перемещает стоп вслед за благоприятными экстремумами предыдущей свечи.
- **Реверс** — при появлении противоположного сигнала позиция разворачивается одним рыночным ордером достаточного объёма.

## Параметры
| Параметр | Описание | Значение по умолчанию |
|----------|----------|-----------------------|
| `OrderVolume` | Базовый торговый объём в лотах или контрактах. | `0.30` |
| `StopLossPips` | Размер стоп-лосса в пунктах (`0` — отключено). | `46` |
| `TakeProfitPips` | Размер тейк-профита в пунктах (`0` — отключено). | `0` |
| `EnableTrailingStop` | Включить подтягивание стопа при активном стоп-лоссе. | `true` |
| `BollingerPeriod` | Период расчёта полос Боллинджера. | `5` |
| `BollingerDeviation` | Множитель стандартного отклонения для полос. | `2.5` |
| `TeethPeriod` | Период сглаженной СМА для линии зубов Alligator. | `21` |
| `CandleType` | Тип свечей для анализа (по умолчанию 15 минут). | Свечи `15m` |

Все числовые параметры снабжены диапазонами оптимизации для быстрой настройки в Strategy Analyzer.

## Особенности реализации
- Обрабатываются только завершённые свечи, что имитирует работу советника в MetaTrader, запускавшегося при открытии нового бара.
- Если включён трейлинг-стоп без положительного значения стоп-лосса, на этапе инициализации выбрасывается исключение — это защищает от некорректной конфигурации.
- При наличии области графика стратегия автоматически рисует свечи, полосы Боллинджера и линию зубов Alligator для визуальной проверки.

## Использование
1. Загрузите стратегию в терминал или тестер StockSharp.
2. Укажите торгуемый инструмент и подстройте параметры объёма и пунктов в соответствии с спецификацией брокера.
3. Запустите стратегию. Она подпишется на выбранную свечную серию, будет оценивать сигналы на каждой завершённой свече и управлять позицией по описанным правилам.

При работе на реальном счёте убедитесь, что брокер поддерживает рыночные ордера и предоставляет корректный `PriceStep`, чтобы перевод пунктов в цену выполнялся без ошибок.
