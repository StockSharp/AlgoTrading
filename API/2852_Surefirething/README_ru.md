# Стратегия Surefirething

## Обзор
Surefirething воспроизводит классический советник MetaTrader 5, который размещает симметричные лимитные заявки на покупку и продажу вокруг закрытия последней свечи. Система перестраивает сетку после каждой завершённой свечи, управляет защитными стопами в пунктах и полностью закрывает позиции за десять минут до полуночи по серверному времени.

## Обработка свечей
- Работает с настраиваемым типом свечей (по умолчанию таймфрейм 1 час).
- После завершения свечи вычисляется расширенный диапазон: `range = (high - low) * 1.1`.
- На основе диапазона рассчитываются два уровня пробоя:
  - `L4 = close - range / 2` для лимитной покупки.
  - `H4 = close + range / 2` для лимитной продажи.
- Перед публикацией новой сетки существующие отложенные заявки отменяются, поэтому одновременно активно только две заявки.

## Управление заявками
- Лимитные приказы выставляются на уровнях `L4` и `H4` с указанным объёмом.
- После открытия позиции противоположная лимитная заявка немедленно отменяется.
- Каждый день в **23:50** (серверное время) стратегия:
  - Отменяет все оставшиеся отложенные заявки.
  - Закрывает открытую позицию по рынку, если она есть.
  - Сбрасывает отслеживание стоп-лоссов и тейк-профитов перед новым днём.

## Управление рисками
- Стоп-лосс и тейк-профит задаются в пунктах и переводятся в цену через минимальный шаг цены инструмента (для 5- и 3-знаковых инструментов автоматически используется классический пункт).
- Можно включить трейлинг-стоп в пунктах. При каждом движении цены больше `TrailingStopPips + TrailingStepPips` стоп переносится на `текущая цена - TrailingStopPips` для длинных позиций или `текущая цена + TrailingStopPips` для коротких.
- На каждой свече контролируется достижение стопа или цели. При пробое уровня позиция закрывается рыночным ордером.

## Параметры
- `OrderVolume` – базовый объём лимитных заявок (по умолчанию `0.1`).
- `StopLossPips` – расстояние до стоп-лосса в пунктах (по умолчанию `50`).
- `TakeProfitPips` – расстояние до тейк-профита в пунктах (по умолчанию `50`).
- `TrailingStopPips` – расстояние трейлинг-стопа в пунктах (по умолчанию `25`).
- `TrailingStepPips` – дополнительное движение в пунктах, требуемое для переноса стопа (по умолчанию `1`). При включённом трейлинге должно быть больше нуля.
- `CandleType` – тип свечей, используемый в расчётах (по умолчанию таймфрейм 1 час).

## Примечания
- Реализация повторяет исходную логику MQL и запрещает нулевой шаг трейлинг-стопа, если он активирован.
- Python-версия для стратегии не предоставляется.
