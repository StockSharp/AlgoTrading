# Стратегия Price Impulse
[English](README.md) | [中文](README_cn.md)

Стратегия Price Impulse отслеживает поток заявок Level1 и реагирует на резкие изменения лучшего бид/аск. Логика повторяет исходный советник MetaTrader 5: сравнивает текущую котировку с ценой, поступившей несколько тиков назад, и открывает позицию, если импульс превышает заданный порог в пунктах. Фиксированные стоп‑лосс и тейк‑профит автоматически настраиваются через `StartProtection`, поэтому дополнительных ручных заявок не требуется.

Подход нейтрален к направлению рынка. Длинная позиция появляется, когда аск заметно вырос относительно прошлой цены, короткая — когда бид провалился ниже выбранного уровня. После каждой сделки включается пауза (`CooldownSeconds`), полностью повторяющая параметр `InpSleep` из MQL и защищающая от постоянного перезахода.

## Как работает

- Подписывается на поток Level1 и хранит скользящую историю лучших бидов и асков.
- Сравнивает текущую цену с котировкой, пришедшей `HistoryGap` тиков назад (дополнительный буфер управляется параметром `ExtraHistory`).
- Открывает лонг, если аск вырос более чем на `ImpulsePoints * PriceStep`, и стратегия не находится в длинной позиции.
- Открывает шорт, если бид упал более чем на тот же порог, и открытых коротких позиций нет.
- Применяет фиксированные стоп‑лосс/тейк‑профит в пунктах и выдерживает паузу `CooldownSeconds` перед следующей сделкой.

## Параметры

- **OrderVolume** – объём каждой рыночной заявки. По умолчанию `0.1`, что соответствует оригинальному эксперту, но допускает оптимизацию под любой инструмент.
- **StopLossPoints** – расстояние от точки входа до защитного стопа в пунктах. Значение `0` отключает стоп‑лосс.
- **TakeProfitPoints** – расстояние до тейк‑профита в пунктах. Значение `0` отключает тейк‑профит.
- **ImpulsePoints** – минимальный импульс (в пунктах) между текущей котировкой и ценой `HistoryGap` тиков назад, необходимый для входа.
- **HistoryGap** – количество тиков между текущей ценой и сравниваемой точкой. Большие значения фильтруют шум, но делают сигналы менее оперативными.
- **ExtraHistory** – дополнительное число хранимых тиков, чтобы корректно обрабатывать bursts котировок и повторять логику MQL, где массив заполнялся с запасом.
- **CooldownSeconds** – время ожидания после сделки перед новым входом. Полностью заменяет `InpSleep` из оригинала и предотвращает постоянные перевороты.

## Особенности

- Параметры, выраженные в пунктах, автоматически переводятся в абсолютные значения через `Security.PriceStep` (с запасным использованием `Security.MinPriceStep`).
- Торговля начинается только после получения достаточной истории и проверки, что соединение активно и торговля разрешена.
- Стратегия рассчитана на ликвидные инструменты с надёжным потоком Level1, иначе импульсы могут быть ложными.
- Python‑версии нет — предоставлена только реализация на C#, как и требовалось в задаче.
