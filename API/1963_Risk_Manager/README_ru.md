# Risk Manager

Стратегия управления рисками следит за стоимостью портфеля и закрывает позиции при превышении заданных ограничений. Новые сделки не открываются; алгоритм защищает существующие позиции, используя правила дневного убытка, убытка по позиции и трейлинг‑профита.

## Обзор

При запуске стратегия запоминает начальную стоимость портфеля и на каждом срабатывании таймера проверяет условия риска. Если капитал падает ниже допустимого уровня или позиция приносит слишком большой убыток, позиции закрываются. При включенном трейлинг‑профите сохраняется достигнутая прибыль.

## Принцип работы

- **Дневной убыток** – сравнивает текущую стоимость портфеля с начальной и останавливает торговлю, если падение превышает `DailyRisk`%.
- **Убыток по позиции** – контролирует прибыль текущей позиции. Если убыток превышает `TradeRisk`% от начального капитала, позиция закрывается.
- **Трейлинг‑профит** – фиксирует максимальный процент прибыли за день и закрывает все позиции, когда прибыль снижается на `TrailingRisk`% от этого максимума.

## Параметры

- `DailyRisk` – максимальный допустимый дневной убыток в процентах. По умолчанию `5`.
- `TradeRisk` – максимальный убыток по открытой позиции в процентах от начального капитала. По умолчанию `0` (отключено).
- `TrailingRisk` – процентное снижение прибыли от дневного максимума для закрытия позиций. По умолчанию `0` (отключено).

## Пример

- `DailyRisk` = `5`
- `TradeRisk` = `2`
- `TrailingRisk` = `3`

## Примечания

- Работает с одним инструментом, привязанным к стратегии.
- Для вычислений необходимы данные о портфеле.
- Предназначена для защиты позиций, открытых вручную или другими алгоритмами.

## Риск

- Уровень риска: низкий
