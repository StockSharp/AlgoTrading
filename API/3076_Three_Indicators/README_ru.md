# Стратегия «Three Indicators»

## Обзор
Стратегия представляет собой конвертацию оригинального советника **«Three indicators»** из MQL5 в среду StockSharp. На закрытии каждой свечи выбранного таймфрейма анализируются три классических индикатора — MACD, стохастик и RSI. Сделка открывается только тогда, когда все фильтры указывают в одном направлении, что полностью повторяет логику исходного эксперта.

## Торговая логика
1. **Фильтр направления свечи** — сравнение цены открытия текущей закрывшейся свечи с ценой открытия предыдущей. Более высокая цена открытия поддерживает покупки, более низкая — продажи.
2. **Фильтр наклона MACD** — оценка изменения основной линии MACD (разность между текущим и предыдущим значениями). Снижение MACD разрешает покупки, рост — продажи, как и в оригинальном коде.
3. **Фильтр стохастика** — проверка значения %D относительно уровня 50. Ниже 50 поддерживает покупки, выше 50 — продажи.
4. **Фильтр RSI** — значение RSI относительно 50. Ниже 50 разрешает покупки, выше 50 — продажи.

Только если **все четыре фильтра** подтверждают одинаковое направление, стратегия открывает новую позицию. При появлении обратного сигнала существующая позиция немедленно переворачивается рыночной заявкой, закрывающей текущий объём и открывающей противоположное направление, что соответствует логике MQL-версии (без 30-секундной задержки).

## Параметры
| Параметр | Описание |
| --- | --- |
| `CandleType` | Таймфрейм свечей, используемых стратегией. По умолчанию 1 минута. |
| `TradeVolume` | Объём для входа и переворота позиции. |
| `MacdFastPeriod` | Длина быстрой EMA в расчёте MACD. |
| `MacdSlowPeriod` | Длина медленной EMA в расчёте MACD. |
| `MacdSignalPeriod` | Длина EMA сигнальной линии MACD. |
| `MacdPriceType` | Тип цены, подаваемой на MACD (Close, Open, High, Low, Median, Typical, Weighted). |
| `StochasticKPeriod` | Длина окна для расчёта линии %K. |
| `StochasticDPeriod` | Длина сглаживания линии %D. |
| `StochasticSlowing` | Дополнительное сглаживание %K перед вычислением %D. |
| `RsiPeriod` | Период усреднения индикатора RSI. |
| `RsiPriceType` | Тип цены, используемый в расчёте RSI. |

## Индикаторы
- **MACD** — настраивается по периодам быстрой, медленной и сигнальной EMA.
- **Stochastic Oscillator** — использует стандартную реализацию StockSharp с параметрами %K/%D и slowing.
- **RSI (Relative Strength Index)** — финальный фильтр направления.

## Особенности поведения
- Обработка производится только по **закрытым свечам**, что делает стратегию устойчивее по сравнению с тиковым запуском в MQL.
- Встроенная в оригинале задержка `Sleep(30000)` устранена — переворот выполняется сразу одной рыночной заявкой.
- Стохастик использует стандартное сглаживание StockSharp (SMA), что соответствует логике исходного советника.
- Выбор типа цены для MACD и RSI реализован через перечисление `IndicatorAppliedPrice`, полностью совпадающее с вариантами MetaTrader.

## Управление рисками
Стратегия не выставляет стоп-лосс и тейк-профит. Управление позицией осуществляется исключительно через сигналы индикаторов. При необходимости добавьте внешние правила риск-менеджмента.

## Рекомендации по использованию
1. Выберите инструмент и таймфрейм через параметр `CandleType`.
2. При необходимости скорректируйте периоды индикаторов под выбранный рынок.
3. Отслеживайте на графике отрисованные свечи и индикаторы, чтобы контролировать согласованность сигналов.
4. Добавьте внешние модули управления капиталом, если требуются фиксированные стопы или цели.
