# SMC Hilo MaxMin 突破策略

## 概述
本策略复刻 MetaTrader 专家顾问 *SMC MaxMin at 1200* 的行为。到达设定的终端小时 (`SetHour`) 时，策略会在上一根完结
K线的高点上方挂买入止损，在低点下方挂卖出止损。挂单价格会根据经纪商的最小止损距离自动加上缓冲，距离以点
(pip) 为单位并通过 `Security.PriceStep` 转换为报价单位。一旦突破触发，另一侧的挂单立刻撤销，持仓则由固定止损、
止盈以及可选的追踪止损共同管理。

相较于原始 MQL4 代码的主要差异：

- 使用 StockSharp 提供的 `BuyStop`、`SellStop`、`BuyLimit`、`SellLimit` 等高层 API，而非直接调用 `OrderSend`。
- 最小止损距离、止损与止盈均以点数输入，通过 `Security.PriceStep` 自动换算，兼容不同品种的最小跳动单位。
- 追踪止损仅在浮盈超过设定的追踪距离时才移动，避免频繁改价。
- 逻辑完全基于蜡烛订阅高层 API，无需手动遍历历史或维护指标缓存。

## 交易规则
1. **建仓时刻**：当终端时间的小时数等于 `SetHour` 时，读取上一根完整 K 线的高低点。
2. **多头进场**：在 `上一高点 + 最小止损距离 + 一个最小跳动` 处挂买入止损单。
3. **空头进场**：在 `上一低点 - 最小止损距离 - 一个最小跳动` 处挂卖出止损单。
4. **互斥执行**：任意一侧挂单成交后，另一侧挂单立即撤销。
5. **初始止损**：多头止损价为 `上一低点 - StopLossPips`，空头止损价为 `上一高点 + StopLossPips`（均会换算为价格）。
6. **止盈**：多头在 `入场价 + TakeProfitPips` 挂卖出限价，空头在 `入场价 - TakeProfitPips` 挂买入限价。
7. **追踪止损**：当浮盈大于 `TrailingStopPips` 时，将止损跟随当前买/卖价，保持相同的点数距离。
8. **挂单超时**：两小时后 (`SetHour + 2`) 仍未成交的止损挂单会被自动撤销。

## 参数
| 名称 | 说明 | 默认值 |
| ---- | ---- | ----- |
| `Volume` | 进场挂单的下单量。 | `0.1` |
| `SetHour` | 创建突破挂单的终端小时（0–23）。 | `15` |
| `TakeProfitPips` | 止盈距离（点）。设为 `0` 表示不下止盈单。 | `500` |
| `StopLossPips` | 初始止损距离（点）。设为 `0` 表示不下初始止损。 | `30` |
| `TrailingStopPips` | 追踪止损距离（点）。设为 `0` 表示不启用追踪。 | `30` |
| `MinStopDistancePips` | 经纪商要求的最小止损距离（点），用于调整挂单价。 | `0` |
| `CandleType` | 用于判断小时窗口的蜡烛类型，默认 1 小时。 | `1h` |

## 使用提示
- 需订阅 Level-1 数据，以便获取最新买/卖价用于追踪止损和距离换算。
- 若标的资产的最小跳动与常见外汇品种不同，请相应调整 `TakeProfitPips`、`StopLossPips` 与 `TrailingStopPips`。
- 当止盈或止损参数为 0 时，不会发送对应的挂单，但若启用追踪止损仍会根据浮盈动态调整。
- 请确认 `SetHour` 与行情源提供的服务器时间一致，避免错过预期的挂单时刻。
