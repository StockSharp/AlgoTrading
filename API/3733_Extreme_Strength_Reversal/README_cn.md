# 极限强度反转策略

## 摘要
- 将 MetaTrader EXSR 专家顾问转换为 StockSharp 策略的逆势系统。
- 结合布林带与 RSI 极值识别价格耗竭区域。
- 采用按账户权益百分比计算的仓位大小，并使用以点（pip）表示的固定止损/止盈距离。

## 交易逻辑
1. 订阅所选周期的 K 线（默认 1 小时）。
2. 计算布林带（周期、偏差）与 RSI 指标。
3. 每当 K 线收盘：
   - 做多条件：RSI 低于超卖阈值但仍大于零，最低价跌破下轨，且收出阳线（收盘价高于开盘价）。
   - 做空条件：RSI 高于超买阈值，最高价突破上轨，且收出阴线（收盘价低于开盘价）。
4. 同一时间只允许持有一个方向的仓位，如需反向会先平掉原有头寸。
5. 依据成交价加减 MetaTrader 风格的点差距离放置止损和止盈，之后每根 K 线都会检测是否触发退出。

## 风险管理
- 若 `Volume` 参数大于零，则使用固定手数；否则根据 `RiskPercent` 与止损距离自动计算仓位。
- 风险基于当前账户权益（若不可用则使用余额或初始资金），并将止损距离转换为价格或货币单位（使用合约的最小跳动及其价格）。
- 计算出的仓位会根据合约的最小手数、最大手数和步长进行规范化。

## 参数
| 名称 | 说明 | 默认值 |
| ---- | ---- | ------ |
| Risk Percent | 单笔交易占用的账户权益百分比。 | 1% |
| Stop Loss (pips) | 止损距离（以点 pip 表示）。 | 150 |
| Take Profit (pips) | 止盈距离（以点 pip 表示）。 | 300 |
| Bollinger Period | 计算布林带使用的 K 线数量。 | 20 |
| Bollinger Deviation | 布林带标准差倍数。 | 2.0 |
| RSI Period | 计算 RSI 使用的 K 线数量。 | 14 |
| RSI Overbought | 判定极端超买的 RSI 水平。 | 80 |
| RSI Oversold | 判定极端超卖的 RSI 水平。 | 20 |
| Candle Type | 用于分析的 K 线周期。 | 1 小时 |

## 备注
- 为了获得精确的仓位计算，请确保品种提供价格跳动、跳动价值和手数步长信息；若缺失则使用默认值。
- 即使临时禁止开仓，风险管理仍会生效，以保证止损和止盈的防护。
- 策略仅处理收盘完成的 K 线，保持与原始 EA 基于上一根 K 线的行为一致。
