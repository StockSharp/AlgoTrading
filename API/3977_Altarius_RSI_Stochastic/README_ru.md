# Стратегия Altarius RSI Stochastic

## Обзор

Стратегия Altarius RSI Stochastic представляет собой перенос советника MetaTrader `AltariusRSIxampnSTOH` на платформу StockSharp. Торговая логика сочетает два стохастика с разными периодами и короткий RSI. Медленный стохастик определяет направление и зоны перекупленности/перепроданности, быстрый стохастик измеряет силу импульса, а RSI совместно с линией сигнала медленного стохастика управляют выходом из позиции. Дополнительно реализованы элементы управления капиталом из исходного MQL-скрипта: снижение объёма после убыточных сделок и принудительное закрытие при критической просадке по капиталу.

## Торговая логика

1. **Источники данных** – работа ведётся по настраиваемым свечам (по умолчанию 15-минутные). Все расчёты выполняются по цене закрытия свечи.
2. **Условия входа**
   - **Покупка**: основная линия медленного стохастика (15,8,8) находится выше сигнальной, но остаётся ниже `BuyStochasticLimit` (50). Разница между линиями быстрого стохастика (10,3,3) по модулю больше `StochasticDifferenceThreshold` (5), что подтверждает импульс.
   - **Продажа**: основная линия медленного стохастика ниже сигнальной, но выше `SellStochasticLimit` (55). Разница между линиями быстрого стохастика также должна превышать порог импульса.
3. **Условия выхода**
   - **Закрытие длинной позиции**: RSI (период 4) выше `ExitRsiHigh` (60), а сигнальная линия медленного стохастика опускается ниже предыдущего значения и остаётся выше `ExitStochasticHigh` (70).
   - **Закрытие короткой позиции**: RSI ниже `ExitRsiLow` (40), сигнальная линия медленного стохастика поднимается выше предыдущего значения и остаётся ниже `ExitStochasticLow` (30).
   - **Выход по риску**: при превышении допустимой просадки по плавающей прибыли (`MaximumRiskPercent`) стратегия немедленно закрывает позиции.
4. **Управление объёмом** – стартовый объём задаётся параметром `BaseVolume`. После последовательных убытков объём уменьшается пропорционально `DecreaseFactor`. При расчёте учитываются шаг и ограничения по объёму инструмента.

## Параметры

| Параметр | Описание |
|----------|----------|
| `BaseVolume` | Базовый объём заявки до применения правил управления риском. |
| `MaximumRiskPercent` | Допустимая доля просадки по капиталу, при превышении которой позиции закрываются. |
| `DecreaseFactor` | Делитель, определяющий скорость сокращения объёма после серии убытков. |
| `RsiPeriod` | Период RSI для сигналов выхода. |
| `SlowStochasticPeriod`, `SlowStochasticK`, `SlowStochasticD` | Настройки медленного стохастика. |
| `FastStochasticPeriod`, `FastStochasticK`, `FastStochasticD` | Настройки быстрого стохастика. |
| `StochasticDifferenceThreshold` | Минимальная разница между линиями быстрого стохастика, подтверждающая импульс. |
| `BuyStochasticLimit`, `SellStochasticLimit` | Допустимые уровни медленного стохастика для открытия позиций. |
| `ExitRsiHigh`, `ExitRsiLow` | RSI-уровни, инициирующие выход из длинных и коротких позиций. |
| `ExitStochasticHigh`, `ExitStochasticLow` | Уровни сигнальной линии медленного стохастика, подтверждающие выход. |
| `CandleType` | Тип свечей, применяемых при расчётах. |

## Примечания

- Стратегия одновременно держит только одну позицию, как и оригинальный советник.
- Просадка и сокращение объёмов рассчитываются по текущим данным портфеля в StockSharp.
- При наличии графика стратегия отрисовывает свечи, оба стохастика и собственные сделки для визуального контроля.
