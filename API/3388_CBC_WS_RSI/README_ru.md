# Стратегия CBC_WS_RSI

## Обзор
**CBC_WS_RSI** — реализация на StockSharp высокого уровня оригинального советника MQL5. Стратегия объединяет свечные модели «Три белых солдата» и «Три черные вороны» с подтверждением по RSI. Вход выполняется только тогда, когда много-свечная разворотная конфигурация совпадает с направлением импульса. Обработка ведётся исключительно по сформированным свечам, а все подписки реализованы через `SubscribeCandles().Bind(...)` без ручной работы с буферами индикаторов.

## Логика торговли
### Условия для покупки
1. Обнаружена фигура **«Три белых солдата»**:
   - Три подряд бычьи свечи с закрытием выше открытия.
   - Каждое закрытие выше закрытия предыдущей свечи.
   - Вторая и третья свечи открываются внутри тела предыдущей.
2. RSI текущей свечи **не превышает уровня подтверждения лонга** (по умолчанию 40).
3. При отсутствии позиции выполняется покупка `Volume` по рынку. При наличии короткой позиции она закрывается и только затем открывается длинная.

### Условия для продажи
1. Обнаружена фигура **«Три черные вороны»**:
   - Три подряд медвежьи свечи с закрытием ниже открытия.
   - Каждое закрытие ниже закрытия предыдущей свечи.
   - Вторая и третья свечи открываются внутри тела предыдущей.
2. RSI текущей свечи **не ниже уровня подтверждения шорта** (по умолчанию 60).
3. При отсутствии позиции выполняется продажа `Volume` по рынку. При наличии длинной позиции она закрывается и только затем открывается короткая.

### Правила выхода
- **Закрытие лонга:** RSI пересекает сверху вниз верхний (70) или нижний (30) уровни выхода.
- **Закрытие шорта:** RSI пересекает снизу вверх нижний (30) или верхний (70) уровни выхода.
- **Защита позиций:** Параметры стоп-лосса и тейк-профита задаются в процентах. Если значения больше нуля, защита активируется через `StartProtection`.

Стратегия отслеживает два последних значения RSI и фиксирует позицию при первом же пересечении критических уровней, что позволяет быстро реагировать на изменение импульса.

## Параметры
| Имя | Описание | Значение по умолчанию |
| --- | -------- | --------------------- |
| `CandleType` | Тип и таймфрейм свечей для подписки. | Свечи 1 часа |
| `RsiPeriod` | Период расчёта RSI. | 37 |
| `LongConfirmationLevel` | Максимальный RSI для входа в лонг. | 40 |
| `ShortConfirmationLevel` | Минимальный RSI для входа в шорт. | 60 |
| `LowerExitLevel` | Нижний уровень RSI для закрытия позиций. | 30 |
| `UpperExitLevel` | Верхний уровень RSI для закрытия позиций. | 70 |
| `StopLossPercent` | Стоп-лосс в процентах (0 отключает). | 1 |
| `TakeProfitPercent` | Тейк-профит в процентах (0 отключает). | 2 |

Все числовые параметры помечены `SetCanOptimize(true)` и могут участвовать в оптимизации.

## Визуализация
При наличии области графика стратегия отображает:
- выбранную свечную серию;
- линию RSI;
- совершённые сделки, что помогает оценить точность распознавания моделей.

## Рекомендации по использованию
- Перед запуском установите желаемый объём `Volume`.
- Стратегия подходит для любых инструментов с данными OHLC.
- Свечи с нулевым телом игнорируются, что уменьшает влияние дожи.
- Подтверждение RSI снижает количество ложных сигналов при слабых разворотах.
