# Стратегия Rnd Trade

## Обзор
- Конвертация советника MetaTrader 5 `RndTrade.mq5` на высокоуровневый API StockSharp.
- Через фиксированные интервалы времени закрывает текущую позицию и тут же открывает новую в случайно выбранном направлении.
- Вместо таймера MetaTrader используется подписка на свечи с соответствующим таймфреймом.

## Параметры
| Имя | Тип | Значение по умолчанию | Описание |
| --- | --- | --------------------- | -------- |
| `IntervalMinutes` | `int` | `60` | Количество минут между закрытием текущей позиции и открытием новой случайной позиции. Значение должно быть больше нуля. |
| `Volume` | `decimal` | `1` | Размер позиции для рыночного входа. Свойство базового класса `Strategy`. |

## Подписки на данные
- Подписка на свечи с таймфреймом, равным `IntervalMinutes` (например, `60` → часовые свечи).
- Обработка выполняется только при закрытии свечи (`CandleStates.Finished`), что гарантирует единичное срабатывание за интервал.

## Логика торговли
1. Ожидаем формирования каждой интервалной свечи.
2. Пропускаем обработку, пока стратегия не сформирована, находится онлайн и ей разрешена торговля.
3. Закрываем позицию, открытую на предыдущем интервале.
4. Генерируем случайное число для выбора длинной или короткой позиции.
5. Отправляем рыночную заявку (`BuyMarket` или `SellMarket`) с заданным объёмом в выбранном направлении.

## Особенности реализации
- Используется цепочка `SubscribeCandles().Bind(ProcessCandle)`, что исключает ручную работу со списками или индикаторами.
- В `OnStarted` вызывается `StartProtection()`, чтобы активировать модуль защиты позиций (стопы и тейки не задаются явно).
- Генератор `Random` повторяет поведение `MathRand()` из оригинального MQL-кода.
- В код добавлены английские комментарии, объясняющие связь между шагами конверсии и функциональностью StockSharp.

## Отличия от оригинальной стратегии MQL
- Таймер `OnTimer` заменён таймфреймовыми свечами, которые задают частоту исполнения логики.
- Закрытие позиции выполняется методом `ClosePosition()` вместо перебора тикетов и вызова `PositionClose` для каждого из них.
- Размер позиций берётся из свойства `Volume`, а не из минимального лота инструмента.
- Параметры проскальзывания и типа исполнения делегируются брокеру/эмулятору и не настраиваются из стратегии.

## Использование
1. Привяжите стратегию к портфелю и инструменту в среде StockSharp.
2. Настройте `IntervalMinutes` и `Volume` под желаемую частоту торговли и размер позиции.
3. Запустите стратегию — она автоматически будет закрывать и открывать позиции на каждом интервале.
4. Python-версия отсутствует: доступна только реализация на C#.
