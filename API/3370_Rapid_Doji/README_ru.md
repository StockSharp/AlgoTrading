# Стратегия Rapid Doji

## Общее описание

Стратегия Rapid Doji повторяет логику оригинального советника «Rapid Doji EA». Она анализирует завершённые свечи выбранного таймфрейма (по умолчанию дневного) и выставляет стоп-заявки на пробой максимумов и минимумов каждой свечи-доджи. Защитные стопы рассчитываются по индикатору Average True Range (ATR), а фиксированный трейлинг в пунктах удерживает риск на постоянном расстоянии, как только позиция выходит в прибыль.

## Торговые правила

1. **Подписка на данные** – стратегия получает завершённые свечи нужного таймфрейма и параллельно ведёт ATR с настраиваемым периодом.
2. **Определение доджи** – свеча считается доджи, если размер тела не превышает 3% от полного диапазона свечи. В расчёт берутся только закрытые свечи.
3. **Выставление заявок**:
   - Buy Stop на уровне максимума доджи.
   - Sell Stop на уровне минимума доджи.
   - Для каждой заявки запоминается защитный стоп: противоположный экстремум минус/плюс ATR × множитель.
4. **Управление рисками** – после открытия позиции противоположная заявка снимается, запомненный уровень стопа регистрируется в виде защитной заявки, далее включается трейлинг.
5. **Трейлинг-стоп** – на каждой новой свече стоп сдвигается так, чтобы фиксированное расстояние (в пунктах, пересчитанных через шаг цены) сохранялось от последней цены закрытия, но только при положительном результате позиции.

Стратегия не использует тейк-профиты: выход осуществляется по защитному или трейлинг-стопу.

## Параметры

| Параметр | Описание |
|----------|----------|
| `CandleType` | Тип свечей для поиска паттерна (по умолчанию дневные свечи). |
| `AtrPeriod` | Период расчёта ATR. |
| `AtrMultiplier` | Множитель ATR для расчёта защитного стопа. |
| `TrailingDistancePoints` | Фиксированное расстояние трейлинг-стопа в пунктах. |

Все параметры поддерживают оптимизацию в среде StockSharp.

## Особенности реализации

- Используется высокоуровневый API `SubscribeCandles` и привязка индикатора через `Bind`, что избавляет от ручной загрузки истории.
- Цены заявок нормализуются методом `Security.ShrinkPrice`, чтобы соблюдать шаг цены инструмента.
- Защитные стопы и их трейлинг управляются вручную для полного соответствия оригинальному советнику.
- Python-версия намеренно не создавалась в соответствии с требованиями задачи.
