# Стратегия Wave Power EA

**Wave Power EA Strategy** — это порт советника MQL4 «Wave Power EA1» на C#. Оригинальный робот строит позицию по сигналу
стохастика или MACD, а затем добавляет новые рыночные ордера через фиксированное число пунктов, одновременно переставляя
общий тейк-профит. Версия на StockSharp повторяет эту логику с использованием высокоуровневого API, привязки индикаторов и
готовых методов для регистрации заявок. Все комментарии в коде оставлены на английском языке согласно требованиям.

## Логика работы

1. **Выбор сигнала.** Первый ордер открывается только при появлении направления от одного из фильтров:
   - `Stochastic` — пересечение %K и %D в зоне перепроданности/перекупленности.
   - `MacdSlope` — наклон основной линии MACD меняет знак.
   - `CciLevels` — CCI опускается ниже –120 или поднимается выше +120.
   - `AwesomeBreakout` — индикатор Awesome Oscillator пробивает адаптивный минимум или максимум.
   - `RsiMa` — пересечение быстрой и медленной SMA при подтверждении от RSI (выше/ниже 50).
   - `SmaTrend` — веер SMA (15/20/25/50) выстраивается в одном направлении с минимальным требуемым наклоном.

2. **Расширение сетки.** После исполнения первого ордера стратегия запоминает цену. Как только рынок проходит против позиции на
   `GridStepPips` и лимит по количеству ордеров не достигнут, отправляется новая рыночная заявка в том же направлении. Объем
   умножается на коэффициент `Multiplier`.

3. **Общие цели.** Каждый новый уровень пересчитывает общий тейк-профит и при необходимости стоп-лосс. Когда число ордеров
   приближается к `OrdersToProtect`, дистанция до цели заменяется на `ReboundProfitPrimary`. После превышения порога используется
   значение `ReboundProfitSecondary`, чтобы ускорить выход из просадки.

4. **Контроль корзины.** На закрытии свечи плавающий результат переводится в пункты на один лот. При достижении порогов
   защитного профита или убытка вся серия закрывается по рынку. То же самое произойдет, если время жизни последнего ордера
   превысит `OrdersTimeAliveSeconds` или запрещено открывать сделки по пятницам.

5. **Новый цикл.** После полного закрытия позиции внутренние счетчики обнуляются, и стратегия готова к следующему сигналу.

По сравнению с оригиналом порт не открывает встречные (хеджирующие) ордера после пятого уровня сетки — все добавления идут в
сторону исходного сигнала. Остальные правила управления капиталом, защитные механизмы и фильтры индикаторов соответствуют
референсной реализации на MQL4.

## Параметры

| Параметр | Описание |
|----------|----------|
| `EntryLogic` | Режим индикатора для первого ордера. |
| `CandleType` | Таймфрейм для расчёта всех индикаторов (по умолчанию 1 час). |
| `InitialVolume` | Объем первого ордера в лотах/контрактах. |
| `GridStepPips` | Минимальное расстояние между уровнями сетки в пунктах. |
| `MaxOrders` | Максимальное число одновременных ордеров. |
| `TakeProfitPips` | Общий тейк-профит в пунктах (0 — отключить). |
| `StopLossPips` | Общий стоп-лосс в пунктах (0 — отключить). |
| `Multiplier` | Множитель объема для каждого нового уровня. |
| `SecureProfitProtection` | Включить логику защитного профита. |
| `OrdersToProtect` | Количество ордеров до активации защитного профита. |
| `ReboundProfitPrimary` | Порог профита (в пунктах на лот) для первой стадии защиты. |
| `ReboundProfitSecondary` | Порог профита после превышения защищаемого количества ордеров. |
| `LossProtection` | Включить защиту по плавающему убытку. |
| `LossThreshold` | Убыток (в пунктах на лот), при котором корзина закрывается при полном заполнении. |
| `ReverseCondition` | Инвертировать сигналы покупки/продажи. |
| `TradeOnFriday` | Разрешить открывать новые ордера в пятницу. |
| `OrdersTimeAliveSeconds` | Максимальное время жизни последнего ордера в секундах (0 — без ограничения). |
| `TrendSlopeThreshold` | Минимальный наклон SMA для режима `SmaTrend`. |

## Рекомендации по применению

1. Запускайте стратегию на инструменте с корректно настроенным шагом цены, чтобы пересчет пунктов работал корректно.
2. Подбирайте `GridStepPips`, `Multiplier` и `MaxOrders` под волатильность инструмента и требования по марже.
3. На реальном счёте включайте защитные блоки, чтобы избежать чрезмерных просадок во время длительных трендов.
4. Стратегия работает по закрытым свечам — выберите таймфрейм, соответствующий желаемому стилю торговли (в оригинале
   использовались комбинации M30 и H1, но стандартные часовые свечи подходят).
5. Так как хеджирование после пятого уровня отсутствует, при необходимости точного повторения оригинала уменьшите значение
   `MaxOrders`.

## Содержимое папки

- `CS/WavePowerEAStrategy.cs` — реализация логики Wave Power EA на StockSharp.
- `README.md` / `README_ru.md` / `README_cn.md` — документация на английском, русском и китайском языках.

Версия на Python специально не создавалась, как требовалось в задании.
