# 日内开盘 MACD 直方图策略

## 概览
本策略还原 MetaTrader 专家顾问“2 1000 1 0.7% 0.5 500lev st”的逻辑：在每个新交易日的开始入场，并通过 MACD 直方图的斜率决定方向。系统以小时级别的 K 线为基础，并保留了原始 MQL 配置中的固定仓位管理参数。

## 交易逻辑
- 策略监听小时 K 线，识别每天的第一根 K 线。
- 使用上一交易日中最近两个收盘 K 线的 MACD 直方图值进行判断。
- 若直方图在这两个柱之间下降，则在新交易日的第一根 K 线开多仓。
- 若直方图上升，则改为开空仓。
- 同一时间只允许持有一个方向的仓位，如出现反向信号会先平仓后再开新仓。

## 风险控制
- 初始止损距离：875 点（按交易品种的最小跳动价乘以该数值得到价格距离）。
- 止盈距离：510 点。
- 跟踪止损距离：2172 点。跟踪止损会记录自入场以来的最高价（多头）或最低价（空头），并在移动到更紧的位置时覆盖初始止损。
- 原策略的保本移动功能关闭，因此此处也未启用。

## 参数
| 名称 | 说明 | 默认值 |
| ---- | ---- | ------ |
| `CandleType` | 策略使用的 K 线序列（默认 1 小时）。 | 1 小时 K 线 |
| `MacdFastPeriod` | MACD 快速均线周期。 | 58 |
| `MacdSlowPeriod` | MACD 慢速均线周期。 | 195 |
| `MacdSignalPeriod` | MACD 信号线周期。 | 183 |
| `StopLossPoints` | 以点数表示的止损距离。 | 875 |
| `TakeProfitPoints` | 以点数表示的止盈距离。 | 510 |
| `TrailingStopPoints` | 以点数表示的跟踪止损距离。 | 2172 |

## 备注
- 策略仅使用已收完的 K 线，模仿原专家中的“使用上一根柱”选项，避免了时间穿越问题。
- 跟踪止损和固定止盈止损均在策略内部处理，建议不要额外启用组合层面的保护，以免出现重复的止损管理。
- 参数基于标准的点值定义，如果交易品种的最小跳动价不同，请相应调整参数。
