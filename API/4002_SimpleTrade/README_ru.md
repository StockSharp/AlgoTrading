# Стратегия SimpleTrade

## Общее описание
- Перенос экспертного советника MetaTrader 4 **SimpleTrade.mq4** (в исходнике также встречается название «neroTrade») на платформу StockSharp.
- Работает с одним инструментом и временным интервалом, задаваемым параметром `CandleType`.
- В любой момент времени держит не более одной позиции и на открытии каждой новой свечи переходит в нужное направление.

## Логика торговли
1. При появлении новой свечи в состоянии `Active` стратегия считывает её цену открытия и сравнивает с ценой открытия свечи, находящейся на `LookbackBars` периодов левее.
2. Если текущая цена открытия **выше** эталонной, все позиции закрываются и отправляется рыночная покупка объёмом `TradeVolume` лотов.
3. Если текущая цена открытия **ниже или равна** эталонной, открытые позиции также закрываются и выполняется рыночная продажа тем же объёмом.
4. Параметр `StopLossPoints` полностью повторяет поле `stop` из MQL-версии. При наличии у инструмента `PriceStep` значение переводится в абсолютные цены и передаётся в `StartProtection`, что позволяет StockSharp автоматически сопровождать стоп-лосс.
5. История цен открытия накапливается через высокоуровневую подписку на свечи: завершённые свечи пополняют буфер, а активная свеча инициирует расчёт ровно один раз за бар.

## Параметры
| Параметр | Назначение | Значение по умолчанию |
|----------|------------|-----------------------|
| `TradeVolume` | Объём заявки в лотах. Должен быть больше нуля. | `1` |
| `StopLossPoints` | Дистанция защитного стоп-лосса в пунктах инструмента. Значение `0` отключает автоматический стоп. | `120` |
| `LookbackBars` | Количество свечей для сравнения цен открытия. При `3` реализуется проверка `Open[0]` против `Open[3]`. | `3` |
| `CandleType` | Тип данных (временной интервал) для запрашиваемых свечей. Определяет частоту появления сигналов. | `таймфрейм 1 час` |

## Особенности реализации
- Задействован высокоуровневый пайплайн `SubscribeCandles(...).Bind(...)`, что обеспечивает одинаковое поведение в бэктесте и в онлайне.
- В `OnStarted` вызывается `StartProtection`. Убедитесь, что у инструмента задан `PriceStep`; без него рассчитать абсолютный стоп-лосс невозможно.
- Все сделки совершаются рыночными ордерами на открытии свечей, поэтому отдельный параметр проскальзывания не нужен.
- Буфер цен открытия ограничен `LookbackBars + 5` элементами и не разрастается бесконтрольно.
- В папке присутствует только реализация на C#; версия на Python не создавалась.

## Структура каталога
```
4002_SimpleTrade/
├── CS/
│   └── SimpleTradeStrategy.cs
├── README.md
├── README_cn.md
└── README_ru.md
```
