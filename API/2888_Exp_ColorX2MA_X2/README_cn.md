# Exp ColorX2MA X2 策略
[English](README.md) | [Русский](README_ru.md)

该策略将 MT5 专家 "Exp_ColorX2MA_X2" 移植到 StockSharp。它在高周期上使用 ColorX2MA 判断趋势，在低周期上使用 ColorX2MA 生成进出场信号。每个 ColorX2MA 都由两层可配置均线级联组成，并根据最终曲线的斜率自动着色。当低周期的颜色在高周期趋势方向上发生转换时触发交易。

实现保留了原始指标的所有价格类型，同时支持最常用的平滑算法（SMA、EMA、SMMA、LWMA、Jurik）。如果 Jurik 指标公开 `Phase` 属性，会使用配置的阶段值进行设置。

## 交易规则
- **做多入场**
  - 高周期 ColorX2MA 颜色为多头（trend direction > 0）。
  - 低周期 ColorX2MA 在上一根柱子为多头颜色，本柱收盘变为中性或空头颜色（`Clr[1] == 1` 且 `Clr[0] != 1`）。
  - 允许做多。
- **做空入场**
  - 高周期 ColorX2MA 颜色为空头（trend direction < 0）。
  - 低周期 ColorX2MA 在上一根柱子为空头颜色，本柱收盘变为中性或多头颜色（`Clr[1] == 2` 且 `Clr[0] != 2`）。
  - 允许做空。
- **平多**
  - 出现低周期空头颜色（`Clr[1] == 2`）并且开启了二级多头平仓，或高周期趋势翻为空头且启用了一级多头平仓。
- **平空**
  - 出现低周期多头颜色（`Clr[1] == 1`）并且开启了二级空头平仓，或高周期趋势翻为多头且启用了一级空头平仓。
- **止损/止盈**
  - 可选的止损与止盈以点数表示（乘以合约的价格步长），在每根完成的信号周期 K 线上根据极值与持仓均价进行检查。

## 默认参数
- **趋势周期**：6 小时 K 线。
- **信号周期**：30 分钟 K 线。
- **趋势平滑**：SMA(12) → Jurik(5, Phase 15)。
- **信号平滑**：SMA(12) → Jurik(5, Phase 15)。
- **应用价格**：收盘价。
- **信号偏移**：两个周期均为 1 根柱子。
- **权限**：允许多空方向的开仓和平仓。
- **止损**：1000 点（根据价格步长换算）。
- **止盈**：2000 点（根据价格步长换算）。

## 筛选与说明
- 方向：多空双向，可通过权限开关控制。
- 周期：双周期结构（趋势周期 + 信号周期）。
- 指标：双层 ColorX2MA，可自定义两级平滑方式。
- 平滑支持：`Sma`、`Ema`、`Smma`、`Lwma`、`Jurik`，其他原库算法暂未实现。
- 价格类型：完整支持 12 种公式，包括 TrendFollow 与 Demark 价格。
- 止损：可选的固定距离止损/止盈。
- 复杂度：中等，需要同步两个时间框架和颜色缓冲。
- 适用市场：外汇、指数、加密等需要 ColorX2MA 趋势过滤的品种。

## 使用提示
- 建议保持高周期明显大于信号周期，以降低震荡噪声。
- 通过调整 `SignalSignalBar` 控制信号灵敏度：数值越小越敏感，越大越平滑。
- 如果品种没有提供 `PriceStep`，止损和止盈距离将按价格单位直接解释。
- Jurik 平滑需要 StockSharp 的相关指标许可，若不可用可改用其他平滑方式。
