# Стратегия EuroSurge Simplified

## Общее описание
- Перенос эксперта MetaTrader 4 **«EuroSurge Simplified»** на высокоуровневый API StockSharp.
- Работает только с закрывшимися свечами и объединяет сигналы пяти индикаторов (MA, RSI, MACD, полосы Боллинджера, стохастик).
- Вводит настраиваемую паузу между сделками и сразу выставляет тейк-профит и стоп-лосс в шагах цены.
- Поддерживает три схемы управления объёмом: фиксированный объём, процент от баланса, процент от текущей equity.

## Логика сигналов
1. **Тренд по скользящим средним** (опционально): 20-периодная SMA должна быть выше/ниже длинной SMA.
2. **Фильтр RSI** (опционально): значение RSI должно быть ниже/выше заданных уровней для открытия длинных/коротких позиций.
3. **Подтверждение MACD** (опционально): линия MACD должна находиться выше/ниже сигнальной линии.
4. **Полосы Боллинджера** (опционально): цена закрытия должна пробивать нижнюю/верхнюю полосу.
5. **Стохастик** (опционально): %K и %D одновременно ниже 50 (покупка) либо выше 50 (продажа).

Все активированные фильтры должны дать согласованный сигнал. Перед открытием новой позиции стратегия закрывает встречный объём, повторяя поведение оригинального эксперта.

## Управление рисками
- Дистанции стоп-лосса и тейк-профита задаются в шагах цены (MetaTrader «points»).
- После открытия позиции автоматически вызываются `SetStopLoss` и `SetTakeProfit`.
- Новая сделка допускается только по истечении заданного количества минут с момента последнего входа.

## Управление объёмом
- **FixedSize**: торгует объёмом `FixedVolume`.
- **BalancePercent**: использует долю стартового баланса и делит её на последнюю цену закрытия для оценки количества лотов.
- **EquityPercent**: аналогично, но опирается на текущую стоимость портфеля.
- Объём корректируется в пределах минимальных/максимальных ограничений инструмента и округляется к шагу объёма.

## Параметры
| Имя | Описание |
| --- | -------- |
| `TradeSizeType` | Режим управления объёмом. |
| `FixedVolume` | Объём в режиме FixedSize. |
| `TradeSizePercent` | Доля капитала для процентных режимов. |
| `TakeProfitPoints` / `StopLossPoints` | Расстояние до тейка и стопа в шагах цены. |
| `MinTradeIntervalMinutes` | Минимальный интервал между сделками. |
| `MaPeriod` | Длина медленной SMA (быстрая фиксирована на 20). |
| `RsiPeriod`, `RsiBuyLevel`, `RsiSellLevel` | Настройки RSI. |
| `MacdFast`, `MacdSlow`, `MacdSignal` | Параметры MACD. |
| `BollingerLength`, `BollingerWidth` | Параметры полос Боллинджера. |
| `StochasticLength`, `StochasticK`, `StochasticD` | Настройки стохастика. |
| `UseMa`, `UseRsi`, `UseMacd`, `UseBollinger`, `UseStochastic` | Переключатели фильтров. |
| `CandleType` | Тип свечей для расчётов. |

## Отличия от оригинала
- Проверка допустимого объёма реализована через шаг объёма и биржевые ограничения, что повторяет проверки MetaTrader.
- Защитные ордера выставляются стандартными методами `SetStopLoss`/`SetTakeProfit`, а не ручным расчётом ценовых уровней.
- Все индикаторы подключены через `BindEx`, поэтому не используется прямой вызов `GetValue`.

## Рекомендации по использованию
1. Назначьте стратегии нужный инструмент и портфель, выберите таймфрейм через `CandleType`.
2. Настройте переключатели индикаторов, чтобы воспроизвести или упростить исходный алгоритм.
3. Увеличивайте `MinTradeIntervalMinutes`, если необходимо снизить частоту сделок.
4. Убедитесь, что значения `TakeProfitPoints` и `StopLossPoints` соответствуют шагу цены инструмента.
