# Стратегия Noah 10 Pips 2006

## Краткое описание
- Полностью повторяет алгоритм советника Noah10pips2006 для MetaTrader 4 в инфраструктуре StockSharp.
- Использует диапазон предыдущей сессии для построения каналов и выставления стоп-заявок около средней цены.
- Поддерживает фиксацию прибыли, последующее трейлинг-сопровождение и однократный реверс после закрытия первой позиции.

## Алгоритм работы
1. **Расчёт диапазона**  
   В начале нового торгового дня (с учётом параметра `TimeZoneOffset`) стратегия запоминает максимум и минимум предыдущей сессии и рассчитывает:  
   - Среднюю точку диапазона.  
   - Буферные уровни на расстоянии 20 пунктов (pips) выше и ниже.  
   - Зону входа: если диапазон ≤ 160 пунктов, используется фиксированные ±40 пунктов, иначе 25% от ширины диапазона.
2. **Первая заявка**  
   После наступления торгового окна проверяется последний закрытый бар:  
   - Закрытие между средней и верхним буфером → размещается стоп-заявка на продажу по средней.  
   - Закрытие между нижним буфером и средней → размещается стоп-заявка на покупку по средней.  
   Заявки выставляются только при ширине зоны выше `MinimumRangePips`.
3. **Дополнительная заявка**  
   Если активна только одна стоп-заявка, добавляется противоположная по соответствующему буферному уровню, чтобы подготовиться к пробою в любую сторону.
4. **Сопровождение позиции**  
   - После срабатывания ордера выставляются защитные стоп-лосс и тейк-профит.  
   - При достижении прибыли `TrailSecureProfitPips` стоп переносится на уровень, обеспечивающий `SecureProfitPips`.  
   - При включённом `TrailingStopPips` стоп далее сопровождает цену с указанным шагом.
5. **Завершение дня**  
   Вне торгового окна и по пятничному дедлайну (`FridayEndHour`) все заявки и позиции закрываются.
6. **Реверс**  
   После закрытия первой позиции при отсутствии фиксации прибыли стратегия открывает рыночную позицию в противоположную сторону — так же, как оригинальный советник.

## Основные параметры
- `CandleType` — тип свечей для вычислений, по умолчанию 1 час.  
- `TimeZoneOffset` — смещение времени данных в часах.  
- `StartHour/StartMinute`, `EndHour/EndMinute` — границы торгового окна.  
- `FridayEndHour`, `TradeFriday` — настройка торговли по пятницам и принудительного закрытия.  
- `StopLossPips`, `TakeProfitPips` — дистанции защитных ордеров.  
- `SecureProfitPips`, `TrailSecureProfitPips`, `TrailingStopPips` — логика фиксации прибыли и трейлинг-стопа.  
- `MinimumRangePips` — минимальная ширина диапазона для постановки заявок.  
- `MinVolume`, `MaxVolume`, `MaximumRiskPercent`, `FixedVolume` — управление объёмом, эквивалент функции `LotsRisk` в MT4.

## Практические рекомендации
- Для риск-менеджмента инструмент должен иметь корректные `PriceStep` и `StepPrice`; иначе включите `FixedVolume` и задайте объём вручную.  
- Изменение защитных уровней происходит на закрытии свечи; при необходимости используйте более мелкий таймфрейм.  
- Константы 20/40 пунктов рассчитаны под четырёхзнаковый Forex. Для других инструментов адаптируйте параметры.  
- Графические объекты из MT4 не переносятся автоматически; их можно добавить через возможности графика StockSharp.
