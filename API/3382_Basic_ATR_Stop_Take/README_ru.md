# Basic ATR Stop Take

## Обзор
Basic ATR Stop Take переносит советник MetaTrader 4 **«Basic ATR stop_take expert adviser»** на высокоуровневый API StockSharp. Стратегия предельно проста: она открывает только одну позицию в выбранном направлении, рассчитывает средний истинный диапазон (ATR) по рабочим свечам и выставляет защитный стоп-лосс и тейк-профит как произведение ATR на заданные множители. После закрытия сделки по любому из уровней алгоритм сразу же переходит в режим ожидания следующего сигнала в ту же сторону.

## Логика стратегии
### Индикаторная основа
* **Average True Range (ATR)** – вычисляется по подписанному типу свечей с настраиваемым периодом. Индикатор измеряет текущую волатильность и задаёт расстояния до стопа и цели.

### Правила входа
* Проверка выполняется на закрытии каждой полностью сформированной свечи.
* При отсутствии позиции и направлении **Buy** отправляется рыночная заявка на покупку с указанным объёмом.
* При отсутствии позиции и направлении **Sell** отправляется рыночная заявка на продажу с указанным объёмом.
* Значение **None** блокирует новые входы, но существующая позиция будет сопровождаться до закрытия.

### Правила выхода
* **ATR-стоп** – расстояние равно `ATR × Stop Factor`. Для длинных позиций стоп размещается ниже цены входа, для коротких – выше. Как только экстремумы свечи касаются уровня, позиция закрывается рыночной заявкой.
* **ATR-тейк** – расстояние равно `ATR × Take Factor`. Для длинных позиций цель располагается выше входа, для коротких – ниже. Достижение уровня закрывает сделку рыночной заявкой.
* Если один из множителей равен `0`, соответствующий уровень отключается; оставшийся уровень продолжит контролироваться.

### Управление позицией
* Одновременно может существовать только одна позиция. После её закрытия стратегия ждёт закрытия следующей свечи перед повторным входом в том же направлении.
* В методе запуска вызывается `StartProtection()`, чтобы защита StockSharp отслеживала внешние позиции.

## Параметры
* **Trade Direction** – направление торговли (`None`, `Buy` или `Sell`).
* **Trade Volume** – объём заявки для единственного входа.
* **ATR Period** – период расчёта ATR.
* **Stop Factor** – множитель ATR для стоп-лосса; значение 0 отключает стоп.
* **Take Factor** – множитель ATR для тейк-профита; значение 0 отключает цель.
* **Candle Type** – тип свечей, используемый для расчёта ATR и управления сделкой.

## Дополнительные сведения
* Значения по умолчанию повторяют настройки исходного советника (режим покупок, объём 0.01 лота, период ATR 14, стоп 1.5 ATR, тейк 2.0 ATR).
* Уровни проверяются по максимуму и минимуму свечи, поэтому срабатывание происходит сразу после пробития диапазона свечи.
* Стратегия не наращивает и не разворачивает позицию – только закрывает и дожидается следующего бара перед новым входом.
* В комплект входит только реализация на C#; Python-версия отсутствует.
