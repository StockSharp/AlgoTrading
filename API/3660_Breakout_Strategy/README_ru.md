# Breakout Strategy

## Обзор

Breakout Strategy — это конвертация советника MetaTrader 5 `BreakoutStrategy.mq5` на платформу StockSharp. Стратегия отслеживает максимум и минимум за заданный период и открывает сделки при пробое границ канала. Открытые позиции сопровождаются трейлинг-каналом, построенным по второму Дончиану, что воспроизводит логику исходного эксперта.

## Логика торговли

1. **Канал входа** — максимальные и минимальные цены за `EntryPeriod` свечей сдвигаются на `EntryShift` баров, чтобы исключить текущую свечу из расчёта пробоя.
2. **Определение пробоя** — лонг-сигнал возникает, когда максимум свечи превышает верхнюю границу, увеличенную на один шаг цены. Шорт-сигнал срабатывает при падении минимума ниже нижней границы минус один шаг цены.
3. **Канал выхода** — максимум и минимум за `ExitPeriod` баров также сдвигаются на `ExitShift`. При активной опции `UseMiddleLine` трейлинг использует максимум (для покупок) или минимум (для продаж) между средней и внешней линиями, как в оригинале.
4. **Управление позицией** — длинная позиция закрывается, если минимум свечи пробивает трейлинг-уровень; короткая закрывается при касании максимума уровня выхода. Противоположные сигналы полностью закрывают текущую позицию перед открытием новой.
5. **Размер позиции** — расчёт объёма основан на параметре `RiskPerTrade`. Стратегия берёт капитал портфеля, переводит дистанцию до стопа в денежный эквивалент через `PriceStep` и `StepPrice` инструмента и подбирает максимально допустимый объём с учётом `VolumeStep`, `VolumeMin` и `VolumeMax`.

## Параметры

| Имя | Описание |
| --- | --- |
| `CandleType` | Тип свечей, используемый в расчётах (по умолчанию — часовые). |
| `EntryPeriod` | Длина окна для канала пробоя. |
| `EntryShift` | Сдвиг канала входа в барах; значение `1` соответствует MQL5 версии. |
| `ExitPeriod` | Длина окна для трейлинг-канала. |
| `ExitShift` | Сдвиг канала выхода в барах. |
| `UseMiddleLine` | Использовать ли среднюю линию Дончиана в вычислении трейлинга. |
| `RiskPerTrade` | Доля капитала, которую допускается потерять в одной сделке. |

## Примечания

- Все комментарии в исходном коде написаны на английском языке в соответствии с требованиями репозитория.
- Реализация использует высокоуровневый API StockSharp: подписку на свечи, индикаторы `Highest`/`Lowest` и индикатор `Shift` для сдвига без ручных буферов.
- Автоматические тесты не поставляются; перед реальной торговлей протестируйте стратегию на своём стенде.
