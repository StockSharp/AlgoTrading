# Стратегия Momo Trades
[English](README.md) | [中文](README_cn.md)

Конверсия оригинального советника MetaTrader "Momo_trades", торгующего пробои импульса с фильтрами по скользящей средней и структуре MACD.

## Логика стратегии
- Работает только по завершённым свечам выбранного таймфрейма и поддерживает одну совокупную позицию.
- Использует простую скользящую среднюю с настраиваемым сдвигом бара, чтобы измерять удалённость цены закрытия от средней. Для покупок цена закрытия выбранного бара должна быть выше SMA на величину, превышающую параметр смещения; для продаж — ниже на ту же величину.
- Проверяет каскадное условие по основной линии MACD, полностью повторяющее правила из MQL: несколько прошлых значений должны последовательно расти и пересекать ноль для входа в лонг либо падать и пересекать ноль для шорта, что защищает от ослабления импульса.
- Открывает рыночную сделку с объёмом стратегии, когда фильтр SMA и шаблон MACD совпадают по направлению.

## Управление рисками
- Стоп-лосс, тейк-профит, трейлинг-стоп, шаг трейлинга, перевод в безубыток и порог смещения задаются в пунктах и автоматически переводятся в ценовые единицы через шаг цены инструмента.
- При заданных тейк-профите и трейлинг-стопе стоп подтягивается только после прохождения ценой суммы трейлинга и шага, полностью воспроизводя логику MQL-версии.
- При отсутствии тейк-профита и активном параметре безубытка стоп переносится на цену входа, как только достигается порог безубытка.
- Все уровни пересчитываются на каждой завершённой свече и закрывают позицию рыночными ордерами при пересечении минимумом или максимумом свечи.

## Управление сессией
- Флаг `CloseEndDay` соответствует оригиналу: позиция закрывается в 23:00 (в пятницу в 21:00) по времени площадки. После указанного часа стратегия пропускает новые входы до следующего дня.

## Параметры
- **SMA Period / MA Bar Shift** – период скользящей средней и индекс бара, по которому берутся значения SMA и цены.
- **MACD Fast / Slow / Signal / Bar Shift** – настройки MACD и сдвиг, используемый при проверке паттерна импульса.
- **Stop Loss / Take Profit / Trailing Stop / Trailing Step / Breakeven / Price Shift** – расстояния в пунктах для выхода, трейлинга и фильтра SMA.
- **Close End Of Day** – закрытие позиций перед окончанием торговой сессии.
- **Candle Type** – тип свечей, используемых для расчётов и сигналов.
