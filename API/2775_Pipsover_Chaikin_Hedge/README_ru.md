# Pipsover Chaikin Hedge

## Общее описание
Стратегия переносит советник «Pipsover 2» из MetaTrader в StockSharp. Торговая идея — искать экстремальные значения индикатора
Chaikin, когда цена предыдущей свечи прокалывает скользящую среднюю, и подтверждать разворот телом свечи. При появлении
противоположного сигнала стратегия немедленно переворачивает суммарную позицию, что имитирует хеджирование, использованное в
исходном MQL-алгоритме.

## Индикаторы и данные
- **Chaikin Oscillator** — строится на линии накопления/распределения и сглаживается двумя средними. Тип сглаживания (простая,
  экспоненциальная, сглаженная или взвешенная) и периоды соответствуют параметрам MetaTrader.
- **Скользящая средняя цены** — настраиваемые период, сдвиг и тип. Используется как опорный уровень, относительно которого
  анализируется минимум/максимум предыдущей свечи.
- **Таймфрейм** — подписка на единственный поток свечей задаётся параметром `CandleType`.

## Логика входов и выходов
1. Анализируются только завершённые свечи.
2. Для определения перекупленности/перепроданности используется значение Chaikin на предыдущей свече.
3. Свеча должна проколоть текущее значение средней: `Low < MA` для лонга и `High > MA` для шорта.
4. Вход при отсутствии позиции:
   - **Лонг** — предыдущая свеча бычья, минимум ниже средней, Chaikin < `-OpenLevel`.
   - **Шорт** — предыдущая свеча медвежья, максимум выше средней, Chaikin > `OpenLevel`.
5. При открытой позиции и появлении противоположного сигнала стратегия разворачивает позицию, отправляя рыночный ордер с
   объёмом `|Position| + Volume`.
6. Стоп-лосс и тейк-профит моделируются внутри стратегии по максимумам/минимумам свечей, поскольку StockSharp использует
   неттинговый учёт.

## Управление рисками
- **Стоп-лосс и тейк-профит** — задаются в пунктах и автоматически переводятся в цену через `PriceStep`. Нулевое значение
  отключает соответствующий уровень.
- **Перевод в безубыток** — после движения на `BreakevenPips` стоп переносится на цену входа.
- **Трейлинг-стоп** — активируется после прохождения `BreakevenPips + TrailingStopPips` и сопровождает цену на расстоянии
  `TrailingStopPips`.
- **Сброс состояний** — при закрытии позиции внутренние ценовые уровни очищаются.

## Параметры
| Параметр | Описание |
| -------- | -------- |
| `OpenLevel` | Значение Chaikin для открытия новой позиции (по умолчанию 100). |
| `CloseLevel` | Значение Chaikin для разворота текущей позиции (по умолчанию 125). |
| `StopLossPips` | Стоп-лосс в пунктах (по умолчанию 65). |
| `TakeProfitPips` | Тейк-профит в пунктах (по умолчанию 100). |
| `TrailingStopPips` | Дистанция трейлинг-стопа (по умолчанию 30). |
| `BreakevenPips` | Прибыль в пунктах для перевода стопа в безубыток (по умолчанию 15). |
| `MaPeriod` | Период скользящей средней цены (по умолчанию 20). |
| `MaShift` | Сдвиг скользящей средней в барах (по умолчанию 0). |
| `MaType` | Тип скользящей средней (Simple, Exponential, Smoothed, Weighted). |
| `ChaikinFastPeriod` | Быстрый период Chaikin (по умолчанию 3). |
| `ChaikinSlowPeriod` | Медленный период Chaikin (по умолчанию 10). |
| `ChaikinMaType` | Тип средней, применяемой при расчёте Chaikin. |
| `CandleType` | Таймфрейм свечей для расчёта. |

## Примечания
- Объём сделок задаётся базовым свойством `Volume` стратегии.
- Для инструментов с 3 или 5 знаками после запятой размер пункта вычисляется как `PriceStep * 10`, что соответствует логике MT5.
- Из-за неттингового учёта в StockSharp пара противоположных сделок из оригинала реализована как мгновенный разворот позиции.
