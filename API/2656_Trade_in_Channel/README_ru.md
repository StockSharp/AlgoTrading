# Стратегия Trade in Channel
[English](README.md) | [中文](README_cn.md)

Контртрендовая канальная стратегия, которая продаёт/покупает на границах канала Дончиана, когда верхняя или нижняя граница не
изменяется. Алгоритм сопоставляет последнюю свечу с предыдущими границами канала и pivot, вычисленным по закрытию прошлой свечи,
чтобы определить момент входа против экстремального движения. Защита позиций строится на стопе по ATR и настраиваемом трейлинг-
стопе, который фиксирует прибыль при движении цены в нужную сторону.

## Подробности

- **Условия входа**:
  - Шорт: верхняя граница канала не изменилась, а максимум свечи коснулся этой границы, либо предыдущее закрытие находится между
    pivot и верхней границей.
  - Лонг: нижняя граница канала не изменилась, а минимум свечи коснулся этой границы, либо предыдущее закрытие находится между
    pivot и нижней границей.
- **Направление торговли**: Лонг и Шорт.
- **Условия выхода**:
  - Закрыть лонг при касании верхней границы при неизменном канале, либо при срабатывании ATR-стопа/трейлинг-стопа.
  - Закрыть шорт при касании нижней границы при неизменном канале, либо при срабатывании ATR-стопа/трейлинг-стопа.
- **Стопы**:
  - Начальный стоп для лонга устанавливается на `support - ATR`, для шорта — на `resistance + ATR`.
  - Трейлинг-стоп активируется после превышения прибыли над `TrailingStopPips` (в шаге цены) и подтягивается вслед за лучшей ценой.
- **Значения по умолчанию**:
  - `ChannelPeriod` = 20 (период канала Дончиана)
  - `AtrPeriod` = 4 (сглаживание ATR)
  - `Volume` = 1 контракт/лот
  - `TrailingStopPips` = 30 шагов цены
  - `CandleType` = таймфрейм 1 час
- **Фильтры**:
  - Категория: Каналы / Средняя реверсия
  - Направление: Лонг и Шорт
  - Индикаторы: Donchian Channel, ATR
  - Стопы: Жёсткий ATR + трейлинг-стоп
  - Сложность: Средняя
  - Таймфрейм: Внутридневной
  - Сезонность: Нет
  - Нейросети: Нет
  - Дивергенции: Нет
  - Уровень риска: Средний

## Примечания

- Pivot вычисляется как `(верхняя граница + нижняя граница + предыдущее закрытие) / 3`, полностью повторяя оригинальный советник.
- Стратегия держит только одну чистую позицию и разворачивается только после полного закрытия текущей сделки.
- Параметр `TrailingStopPips` задаётся в шагах цены ("пунктах") и умножается на `PriceStep` инструмента для получения фактического
  ценового отступа.
