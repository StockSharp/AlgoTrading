# Стратегия Alligator Simple

## Обзор
Стратегия Alligator Simple переносит советник MetaTrader «Alligator Simple v1.0» в экосистему StockSharp. Алгоритм анализирует индикатор Alligator Билла Уильямса только на закрытых свечах и открывает позицию, когда линии Lips, Teeth и Jaw на предыдущей свече выстраиваются в одном направлении. Для каждой сделки можно задать стоп-лосс, тейк-профит и трейлинг-стоп в пунктах, полностью повторяя оригинальную MQL-логику.

## Индикаторы и данные
- **Линии Alligator**: три сглаженные скользящие средние (SMMA), рассчитываемые по медианной цене свечи `(high + low) / 2` с индивидуальными периодами и сдвигами вперёд для Jaw, Teeth и Lips.
- **Свечи**: стратегия подписывается на выбранный `CandleType` (по умолчанию часовые свечи) и обрабатывает только завершённые свечи, чтобы избежать заглядывания в будущее.

## Логика торговли
1. **Оценка сигнала**
   - Получить значения Alligator на предыдущей закрытой свече с учётом заданных сдвигов.
   - Условие для покупки: `Lips[t-1] > Teeth[t-1] > Jaw[t-1]`.
   - Условие для продажи: `Lips[t-1] < Teeth[t-1] < Jaw[t-1]`.
2. **Исполнение**
   - Если позиций нет, открыть сделку объёмом `OrderVolume` по рынку.
   - Одновременно удерживается только одна позиция; противоположные сигналы игнорируются, пока текущая позиция не будет закрыта.

## Выход и управление рисками
- **Начальный стоп-лосс**: при `StopLossPips > 0` уровень устанавливается на расстоянии заданного количества пунктов от цены входа, расстояние пересчитывается через минимальный шаг цены инструмента (для инструментов с 3/5 знаками добавляется множитель 10, как в MetaTrader).
- **Тейк-профит**: при `TakeProfitPips > 0` цель ставится симметрично относительно цены входа; значение 0 отключает тейк-профит.
- **Трейлинг-стоп**: если `TrailingStopPips` и `TrailingStepPips` положительные, стоп переносится к `close − TrailingStop` (для лонга) или `close + TrailingStop` (для шорта), когда цена прошла минимум `TrailingStop + TrailingStep` в прибыльную сторону. Для моделирования внутридневных касаний используются максимумы и минимумы свечи.
- **Закрытие позиций**: условия стоп-лосса, тейк-профита и трейлинг-стопа проверяются на каждой завершённой свече и приводят к отправке рыночного ордера на закрытие.

## Параметры
- `OrderVolume` (по умолчанию **1**): торговый объём в лотах или контрактах.
- `StopLossPips` (по умолчанию **100**): дистанция стоп-лосса в пунктах. Ноль отключает стоп.
- `TakeProfitPips` (по умолчанию **100**): дистанция тейк-профита в пунктах. Ноль отключает цель.
- `TrailingStopPips` (по умолчанию **5**): расстояние трейлинг-стопа в пунктах. Ноль отключает трейлинг.
- `TrailingStepPips` (по умолчанию **5**): дополнительное движение цены перед переносом трейлинг-стопа; при активном трейлинге должно быть положительным.
- `JawPeriod`, `TeethPeriod`, `LipsPeriod`: периоды SMMA для линий Alligator (по умолчанию 13/8/5).
- `JawShift`, `TeethShift`, `LipsShift`: сдвиги вперёд при чтении значений Alligator (по умолчанию 8/5/3).
- `CandleType`: тип/таймфрейм свечей для расчётов (по умолчанию часовые свечи).

## Особенности реализации
- Пунктовые расстояния автоматически подстраиваются под шаг цены инструмента; для инструментов с тремя или пятью знаками используется коэффициент 10, чтобы сохранить определение пункта из MetaTrader.
- История индикаторов хранится в буферах достаточной длины, чтобы учитывать заданные сдвиги, без ручного копирования массивов.
- Для отправки заявок используются методы `BuyMarket` и `SellMarket`, что позволяет сосредоточиться на генерации сигналов и управлении рисками.
