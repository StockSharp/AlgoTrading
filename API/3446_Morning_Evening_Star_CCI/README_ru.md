# Стратегия Morning/Evening Star CCI

## Обзор
Стратегия повторяет логику советника MetaTrader 5 **Expert_AMS_ES_CCI**, реализованную на высокоуровневом API StockSharp. Алгоритм ищет разворотные свечные модели «Утренняя звезда» и «Вечерняя звезда» и подтверждает их сигналом индикатора Commodity Channel Index (CCI). Все расчёты выполняются по закрытым свечам базового инструмента.

## Логика торговли
- **Вход в лонг (Morning Star)**
  - Последовательно появляется три свечи, образующие «утреннюю звезду»:
    - Свеча 1: длинное чёрное тело (длина превышает средний размер тела за заданный период).
    - Свеча 2: короткое тело с разрывом вниз относительно первой свечи.
    - Свеча 3: закрывается выше середины тела первой свечи.
  - Значение CCI на сигнальной свече ниже отрицательного порога входа (по умолчанию −50).
- **Вход в шорт (Evening Star)**
  - Фиксируется модель «вечерняя звезда»:
    - Свеча 1: длинное белое тело.
    - Свеча 2: короткое тело с разрывом вверх относительно первой свечи.
    - Свеча 3: закрывается ниже середины тела первой свечи.
  - Значение CCI на сигнальной свече выше положительного порога входа (по умолчанию +50).
- **Правила выхода**
  - Для коротких позиций: закрывать при переходе CCI выше −NeutralThreshold либо ниже +NeutralThreshold (по умолчанию ±80).
  - Для длинных позиций: закрывать при переходе CCI ниже +NeutralThreshold либо при падении ниже −NeutralThreshold.
  - Дополнительных стопов и тейков не задано; при необходимости используйте защиту позиций (`StartProtection`).

## Используемые индикаторы
- **CCI** с периодом `CciPeriod` (по умолчанию 25) — фильтр подтверждения.
- **Простая скользящая средняя размера свечных тел** длиной `BodyAveragePeriod` (по умолчанию 5) для оценки силы модели.

## Параметры
| Параметр | Описание | Значение по умолчанию | Примечание |
| --- | --- | --- | --- |
| `CciPeriod` | Период расчёта CCI. | 25 | Доступен для оптимизации. |
| `BodyAveragePeriod` | Окно усреднения длины тел свечей. | 5 | Доступен для оптимизации. |
| `EntryThreshold` | Абсолютное значение CCI для открытия позиций. | 50 | Используется знак ±. |
| `NeutralThreshold` | Абсолютное значение CCI для фиксации прибыли/убытка. | 80 | Используется знак ±. |
| `CandleType` | Тип (таймфрейм) свечей для анализа. | Часовые свечи | Можно изменить под свой инструмент. |

## Дополнительные замечания
- Подписка на свечи выполняется через `SubscribeCandles`, индикаторы подключаются методом `Bind`.
- Сделки исполняются рыночными ордерами `BuyMarket` и `SellMarket` в объёме `Volume` с учётом текущей позиции.
- Все комментарии в коде оставлены на английском языке.
- Стратегия не изменяет блок тестов и не требует дополнительных внешних библиотек.
