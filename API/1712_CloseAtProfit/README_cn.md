# 盈利自动平仓策略
[English](README.md) | [Русский](README_ru.md)

该策略监控策略产生的所有交易的已实现盈亏。当累积利润超过用户设定的阈值时，会立即平掉当前持仓，并可选择取消所有挂单。通过设置亏损限制，也可以在达到最大回撤时触发同样的行为。

策略本身不分析指标或价格走势，而是充当一种保护层，在达到货币目标或止损水平时退出市场。订阅简单的K线仅用于定期检查当前的盈亏值。

## 参数

- **UseProfitToClose** – 是否根据盈利目标平仓。默认：`true`。
- **ProfitToClose** – 触发全部平仓的盈利值（货币单位）。默认：`20`。
- **UseLossToClose** – 是否根据亏损限制平仓。默认：`false`。
- **LossToClose** – 当亏损超过该值（货币单位）时触发全部平仓。默认：`100`。
- **ClosePendingOrders** – 平仓时是否取消所有挂单。默认：`true`。
- **CandleType** – 用于触发定期检查的K线类型。默认：1分钟周期。

## 交易逻辑

1. 订阅选定周期的K线。
2. 在每根完成的K线上计算当前已实现盈亏。
3. 如果利润大于或等于 `ProfitToClose`，则平掉全部持仓并可选取消挂单。
4. 如果启用了亏损监控且当前盈亏小于等于 `-LossToClose`，则平掉全部持仓并可选取消挂单。

## 额外说明

- 该策略只会平掉所附证券的持仓。
- 挂单通过内置的 `CancelActiveOrders` 方法取消。
- 可以与其他入场策略组合，以实现盈利止盈或账户保护。

## 筛选器

- 分类：风险管理
- 方向：双向
- 指标：无
- 止损：有
- 复杂度：基础
- 时间框架：任意
- 季节性：无
- 神经网络：无
- 背离：无
- 风险等级：中等
