# Стратегия закрытия по прибыли
[English](README.md) | [中文](README_cn.md)

Стратегия отслеживает реализованную прибыль и убыток всех сделок, выполненных стратегией. Когда накопленная прибыль превышает заданный пользователем порог, стратегия немедленно закрывает открытую позицию и при необходимости отменяет активные заявки. При указании допустимого убытка можно включить аналогичное поведение при достижении максимальной просадки.

Стратегия не анализирует индикаторы или движение цены. Она выступает защитным слоем и выводит из рынка после достижения денежной цели или уровня остановки. Подписка на простые свечи используется только для периодической проверки текущего значения PnL.

## Параметры

- **UseProfitToClose** – включить или отключить закрытие по цели прибыли. По умолчанию `true`.
- **ProfitToClose** – значение прибыли в денежных единицах, при достижении которого закрывается позиция. По умолчанию `20`.
- **UseLossToClose** – включить или отключить закрытие по пределу убытка. По умолчанию `false`.
- **LossToClose** – значение убытка в денежных единицах, при превышении которого позиция закрывается. По умолчанию `100`.
- **ClosePendingOrders** – отменять ли активные заявки при закрытии позиции. По умолчанию `true`.
- **CandleType** – тип свечей, используемых для периодических проверок. По умолчанию таймфрейм 1 минута.

## Логика торговли

1. Подписка на свечи выбранного таймфрейма.
2. На каждой завершенной свече вычисляется текущий реализованный PnL.
3. Если прибыль больше либо равна `ProfitToClose`, закрывается вся позиция и при необходимости отменяются заявки.
3. Если включён контроль убытка и текущий PnL меньше либо равен `-LossToClose`, закрывается вся позиция и при необходимости отменяются заявки.

## Дополнительные замечания

- Стратегия закрывает только позицию по тому инструменту, к которому она подключена.
- Заявки отменяются встроенным методом `CancelActiveOrders`.
- Логику можно комбинировать с другими стратегиями входа для реализации взятия прибыли или защиты портфеля.

## Фильтры

- Категория: Управление рисками
- Направление: Оба
- Индикаторы: Нет
- Стопы: Да
- Сложность: Базовая
- Таймфрейм: Любой
- Сезонность: Нет
- Нейросети: Нет
- Дивергенция: Нет
- Уровень риска: Средний
