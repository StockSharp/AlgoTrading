# Стратегия Renko Line Break vs RSI
[English](README.md) | [中文](README_cn.md)

Стратегия повторяет логику советника «RenkoLineBreak vs RSI» из MetaTrader с использованием высокоуровневого API StockSharp. Для определения направления используется поток кирпичей Renko, фильтрация входов выполняется по RSI, а заявки выставляются в виде отложенных стопов на основе структуры из трёх свечей.

## Подробности

- **Условия входа**:
  - **Покупка**: тренд Renko остаётся восходящим, а RSI опускается до уровня `50 - RsiShift` или ниже. Выставляется стоп-заявка на покупку по максимуму свечи три бара назад плюс `IndentFromHighLow`.
  - **Продажа**: тренд Renko остаётся нисходящим, а RSI поднимается до уровня `50 + RsiShift` или выше. Выставляется стоп-заявка на продажу по минимуму свечи три бара назад минус `IndentFromHighLow`.
  - Отложенные заявки снимаются при появлении переходных состояний Renko (`ToUp` / `ToDown`).
- **Направление**: Покупка и продажа.
- **Условия выхода**:
  - Сигнал к закрытию при обратном переходе тренда Renko (`ToDown` для лонга, `ToUp` для шорта).
  - RSI возвращается через середину диапазона (`50 ± RsiShift`).
  - Достижение свечой уровней запланированного стоп-лосса или тейк-профита.
- **Стопы**:
  - Стоп-лосс привязан к экстремуму последних трёх свечей с поправкой `IndentFromHighLow`.
  - Тейк-профит отстоит от предполагаемой цены входа на `TakeProfit` (можно отключить, установив 0).
- **Значения по умолчанию**:
  - `BoxSize` = 500m.
  - `RsiPeriod` = 4.
  - `RsiShift` = 20m.
  - `TakeProfit` = 1000m.
  - `IndentFromHighLow` = 50m.
  - `Volume` = 1m.
  - `CandleType` = таймфрейм 5 минут.
- **Фильтры**:
  - Категория: Следование за трендом.
  - Направление: Обе стороны.
  - Индикаторы: Renko, RSI.
  - Стопы: Жёсткий стоп и тейк-профит.
  - Сложность: Средняя.
  - Таймфрейм: Гибрид (Renko + время).
  - Сезонность: Нет.
  - Нейросети: Нет.
  - Дивергенции: Нет.
  - Уровень риска: Средний.

## Как это работает

1. Подписка на `RenkoCandleMessage` определяет текущее направление. При смене кирпича тренд переводится в состояние `ToUp` или `ToDown`, что имитирует оригинальный индикатор.
2. Одновременно временные свечи рассчитывают RSI и предоставляют максимум/минимум последних трёх баров для расчёта уровней пробоя.
3. Когда условия по Renko и RSI совпадают, регистрируется соответствующая стоп-заявка. Пара стоп-лосс/тейк-профит сохраняется и начинает отслеживаться после срабатывания заявки.
4. После исполнения ордера уровни защиты активируются, и каждую новую свечу стратегия проверяет, достигла ли цена стопа или цели; при достижении позиция закрывается по рынку.
5. Если импульс ослабевает (RSI возвращается за середину) или Renko сигнализирует разворот, позиция закрывается досрочно.

## Используемые индикаторы

- **Кирпичи Renko** — определяют направление и переходные состояния тренда.
- **Индекс относительной силы (RSI)** — фильтрует входы, требуя отката против тренда.

## Дополнительные замечания

- `IndentFromHighLow` повторяет буфер оригинального советника, удерживая заявки на расстоянии от ближайших экстремумов.
- При значении `TakeProfit = 0` тейк-профит отключается, но стоп-лосс продолжает работать.
- Одновременно активна лишь одна отложенная заявка; при изменении условий она автоматически отменяется.
