# Стратегия FX-CHAOS Scalp

## Общее описание
Стратегия FX-CHAOS Scalp повторяет оригинального эксперта MT5, объединяющего Awesome Oscillator и уровни ZigZag на основе фракталов на нескольких таймфреймах. Версия для StockSharp подписывается на часовые свечи для исполнения и на дневные свечи для фильтрации по старшему таймфрейму. Встроенный трекер воссоздаёт логику индикатора «ZigZag on Fractals», анализируя последовательности из пяти свечей и соединяя найденные фракталы в чередующиеся экстремумы.

## Пошаговая логика
1. **Сбор данных**
   - Часовые свечи управляют поиском сигналов и контролем рисков.
   - Дневные свечи формируют контрольные уровни старшего ZigZag.
   - Awesome Oscillator (5, 34) рассчитывается по часовым данным.
2. **Фрактальный ZigZag**
   - Каждая завершённая свеча добавляется в окно из пяти элементов.
   - Когда центральная свеча удовлетворяет условиям восходящего или нисходящего фрактала, обновляется текущий экстремум; если новый фрактал в том же направлении более экстремальный, предыдущий уровень заменяется.
3. **Поиск сигналов на закрытии часа**
   - Сигнал на покупку появляется, если свеча открылась ниже максимума предыдущей свечи, закрылась выше него, при этом закрытие находится ниже последнего часового ZigZag, выше дневного ZigZag, а значение Awesome Oscillator отрицательное.
   - Сигнал на продажу зеркален: используются минимум предыдущей свечи и положительное значение осциллятора.
4. **Исполнение и сопровождение**
   - Перед открытием новой позиции стратегия закрывает противоположную, если она существует.
   - Цена входа сохраняется и используется для расчёта стоп-лосса и тейк-профита.

## Параметры
| Имя | Описание |
| --- | --- |
| `Volume` | Торговый объём в лотах для каждой рыночной заявки. |
| `Stop Loss (pts)` | Расстояние стоп-лосса в пунктах. Значение умножается на шаг цены инструмента; `0` отключает защиту. |
| `Take Profit (pts)` | Расстояние тейк-профита в пунктах. Вычисляется аналогично стоп-лоссу; `0` отключает цель. |
| `Trading Candle` | Основной таймфрейм (по умолчанию 1 час). |
| `Daily Candle` | Старший таймфрейм для фильтра ZigZag (по умолчанию 1 день). |

## Управление рисками
- На закрытии каждой часовой свечи проверяется, достигла ли цена уровней стоп-лосса или тейк-профита, рассчитанных от цены входа.
- При срабатывании защитного уровня позиция закрывается немедленно, флаг входа сбрасывается, что исключает повторный вход в ту же свечу.
- При появлении противоположного сигнала текущая позиция также закрывается перед открытием новой.

## Особенности реализации
- Логика ZigZag реализована через минимальное локальное состояние и работает поверх подписок на свечи, без обращения к буферам индикаторов.
- Пока ZigZag не сформирован (не хватает по две свечи слева и справа), торговля приостанавливается.
- Awesome Oscillator подключён через `BindEx`, поэтому стратегия использует только финальные значения индикатора.
- Расстояния стоп-лосса и тейк-профита масштабируются через `Security.PriceStep`; при его отсутствии применяется множитель в 1 пункт.

## Файлы
- `CS/FxChaosScalpStrategy.cs` — реализация стратегии с ZigZag-трекером, фильтром Awesome Oscillator и торговой логикой.
- `README.md` — документация на английском языке.
- `README_cn.md` — документация на китайском языке.
