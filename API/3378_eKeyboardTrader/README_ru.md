# Стратегия eKeyboardTrader

## Обзор
Эта стратегия воспроизводит логику советника MetaTrader «eKeyboardTrader», используя высокоуровневый API StockSharp. В оригинале торговля выполнялась через горячие клавиши и текстовые подсказки на графике. В версии для StockSharp взаимодействие перенесено в параметры стратегии, при этом последовательность ручных действий, проверки безопасности и настройка защитных ордеров сохранены.

## Торговая логика
1. **Подписка на Level1** — стратегия подписывается на поток лучших бид/аск котировок и использует их для проверки готовности к исполнению ручных команд.
2. **Ручные команды** — три булевых параметра (`BuyRequest`, `SellRequest`, `CloseRequest`) заменяют сочетания клавиш B, S и C. При установке значения `true` выполняется соответствующая рыночная операция, после чего флаг автоматически сбрасывается.
3. **Ограничение частоты** — между командами действует пауза в одну секунду, что защищает от повторной отправки, как и в оригинальном советнике.
4. **Защита позиций** — расстояния до стоп-лосса и тейк-профита задаются в пунктах MetaTrader и переводятся в абсолютные цены через `Security.PriceStep`. При наличии хотя бы одного защитного расстояния включается `StartProtection`, благодаря чему каждая сделка сопровождается выставлением защитных заявок.
5. **Учёт проскальзывания** — параметр `SlippagePoints` сохранён для совместимости и выводится в лог при каждой ручной сделке, аналогично комментариям советника.

## Параметры
| Параметр | Описание |
|----------|----------|
| `OrderVolume` | Базовый объём для ручных рыночных заявок. |
| `StopLossPoints` | Дистанция до защитного стоп-лосса в пунктах MetaTrader (0 — отключено). |
| `TakeProfitPoints` | Дистанция до защитного тейк-профита в пунктах MetaTrader (0 — отключено). |
| `SlippagePoints` | Информационный допуск по проскальзыванию, выводимый в лог. |
| `BuyRequest` | Установите `true`, чтобы отправить рыночную покупку (с последующим сбросом). |
| `SellRequest` | Установите `true`, чтобы отправить рыночную продажу (с последующим сбросом). |
| `CloseRequest` | Установите `true`, чтобы закрыть нетто-позицию по рынку (с последующим сбросом). |

## Отличия от версии MQL
- На графике нет текстовых подсказок и звуковых сигналов — информацию о действиях можно отслеживать через лог.
- Защитные заявки управляются через `StartProtection`, который закрывает позицию рыночными ордерами при достижении порога, вместо модификации отдельных тикетов.
- Горячие клавиши заменены параметрами. Интерфейс, размещающий стратегию, может привязать к ним любые элементы управления.
- Диагностика торговых запросов в MetaTrader сведена к лаконичным сообщениям в журнале.

## Рекомендации по использованию
- Перед стартом стратегии обязательно назначьте `Security` и `Portfolio`, как это требует исходный советник.
- Проверка флагов выполняется при поступлении новых данных Level1, поэтому в спокойном рынке исполнение произойдёт на ближайшей котировке.
- Изменение `StopLossPoints` или `TakeProfitPoints` во время работы потребует перезапуска стратегии, чтобы переинициализировать модуль защиты.
