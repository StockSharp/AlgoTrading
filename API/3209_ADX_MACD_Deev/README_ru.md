# Стратегия ADX MACD Deev

## Общее описание
**ADX MACD Deev Strategy** — порт оригинального советника для MetaTrader. Стратегия объединяет силу тренда по индикатору Average Directional Index (ADX) и импульс по Moving Average Convergence Divergence (MACD). Сделки открываются только при одновременном согласии двух индикаторов, что помогает отсекать слабые сигналы и работать только с устойчивыми движениями.

## Логика работы
1. **Подготовка индикаторов**
   - ADX рассчитывается с настраиваемым периодом усреднения. Хранятся последние значения ADX, и стратегия проверяет, чтобы они последовательно росли (для покупок) или снижались (для продаж) в течение заданного числа баров.
   - MACD строится на основе экспоненциальных средних (fast, slow, signal). Для входа необходимо, чтобы гистограмма и сигнальная линия одновременно двигались в нужном направлении в течение указанного интервала.
2. **Вход в позицию**
   - **Покупка** — когда значение MACD превышает порог `MACD Minimum (pips)`, гистограмма и сигнальная линия последовательно растут, а ADX находится выше минимума и тоже растёт.
   - **Продажа** — когда MACD опускается ниже отрицательного порога, обе линии MACD снижаются, а ADX остаётся выше минимума и одновременно уменьшается.
   - В рынке одновременно может быть открыта только одна позиция.
3. **Управление рисками**
   - Начальные уровни Stop Loss и Take Profit рассчитываются в ценовых пунктах на основе `PriceStep` инструмента и выбранных значений в пунктах (pips).
   - Активируйте трейлинг-стоп, чтобы переносить защитный уровень после прохождения ценой расстояния `Trailing Stop + Trailing Step`.
   - Опция `Take Half Profit` позволяет закрыть половину позиции при достижении тейк-профита, оставшаяся часть сопровождается трейлингом.

## Параметры
| Группа | Название | Описание |
| --- | --- | --- |
| Trading | Order Volume | Объём рыночного ордера. |
| Risk | Stop Loss (pips) | Расстояние начального стоп-лосса. |
| Risk | Take Profit (pips) | Расстояние начального тейк-профита. |
| Risk | Trailing Stop (pips) | Дистанция трейлинг-стопа, 0 — выключен. |
| Risk | Trailing Step (pips) | Дополнительный шаг перед очередным смещением трейлинга. |
| Risk | Take Half Profit | Включить частичную фиксацию половины позиции. |
| Indicators | ADX Period | Период усреднения ADX. |
| Indicators | ADX Bars Interval | Сколько последних баров ADX должны следовать тренду. |
| Indicators | ADX Minimum | Минимальное значение ADX для входа. |
| Indicators | MACD Fast EMA | Период быстрой EMA для MACD. |
| Indicators | MACD Slow EMA | Период медленной EMA для MACD. |
| Indicators | MACD Signal EMA | Период сигнальной EMA. |
| Indicators | MACD Bars Interval | Количество баров MACD, подтверждающих направление. |
| Indicators | MACD Minimum (pips) | Минимальная величина MACD в пипсах. |
| General | Candle Type | Тип/таймфрейм свечей. |

## Рекомендации
- Для корректного пересчёта пипсов инструмент должен иметь ненулевой `PriceStep`. При `PriceStep = 0` пороги MACD оцениваются в абсолютных значениях.
- Частичные закрытия округляются в соответствии с `VolumeStep` инструмента.
- Трейлинг-стоп пересчитывается только на закрытых свечах.
- Стратегия использует высокоуровневое API (`SubscribeCandles().BindEx(...)`) и не обращается напрямую к буферам индикаторов.
