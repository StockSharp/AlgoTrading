# Elite eFibo Trader 策略

## 概述
**Elite eFibo Trader Strategy** 源自 MQL5 顾问程序 “Elite eFibo Trader”。策略基于斐波那契数列构建加仓网格：先以 `LotsLevel1` 的手数开仓，然后按照固定间距批量挂入止损买/卖单。策略依赖逐笔成交数据，并会随着网格扩展自动上移/下移保护性止损。

## 工作流程
1. 当没有持仓和挂单且允许交易时，策略会在选定方向（多或空）启动新的网格周期。
2. 首单按照市价成交，其余 13 张挂单分别位于 `LevelDistance` 的倍数位置，手数由 `LotsLevel2` … `LotsLevel14` 设置（默认为斐波那契序列）。
3. 每次成交都会在入场价附近放置一个距离为 `StopLossPoints` 的保护止损。对于多头取所有止损中的最大值，空头取最小值，并将其同步给整套仓位形成追踪止损。
4. 一旦价格触及追踪止损，策略立即平掉全部仓位并撤销剩余挂单。
5. 策略实时计算以账户货币计价的浮动盈亏。当达到 `MoneyTakeProfit` 后关闭网格；若 `TradeAgainAfterProfit` 为真，则自动重新开始新一轮，否则保持等待。

## 参数
- `OpenBuy`：仅运行多头网格。
- `OpenSell`：仅运行空头网格。
- `TradeAgainAfterProfit`：达到盈利目标后是否自动重新启动。
- `LevelDistance`：相邻挂单之间的距离，以合约最小价位（`PriceStep`）为单位。
- `StopLossPoints`：单笔交易的固定止损距离，以价位为单位。
- `MoneyTakeProfit`：以账户货币表示的浮动盈利目标。
- `LotsLevel1` … `LotsLevel14`：每一层网格的手数，默认采用斐波那契序列 1, 1, 2, 3, 5, …, 377。

## 实现细节
- 所有价格偏移均依据 `Security.PriceStep` 计算；若最小价位未定义（为 0），策略不会发送订单。
- 任意时刻只允许一个网格周期运行，所有挂单在周期开始时一次性创建。
- 追踪止损会在每次成交或减仓时重新计算，确保全部持仓共享最佳保护价位。
- 盈亏评估依赖 `Position`、`PositionPrice` 以及 `StepPrice` 等市场数据。
- 当 `TradeAgainAfterProfit` 设为 `false` 时，策略在实现盈利目标后会保持停用状态，直至手动重新启用。

## 使用建议
- 启动前请只勾选一个方向（多或空），同时启用两个方向会阻止网格启动。
- 根据交易品种的波动率与合约规模调整间距和手数。较大的斐波那契手数会快速放大仓位，需配合充分的回测验证。
- 确认经纪商支持所计算出的止损挂单价格，否则可能出现下单被拒的情况。
