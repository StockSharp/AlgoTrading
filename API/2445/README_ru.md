# Стратегия Elite eFibo Trader

## Описание
**Elite eFibo Trader Strategy** — конвертация советника MQL5 «Elite eFibo Trader». Стратегия строит сетку усредняющих заявок по числам Фибоначчи: открывает стартовую рыночную позицию и размещает цепочку стоп-заявок через фиксированные интервалы. Работа ведётся на тиковых данных, а уровни стоп-лосса автоматически подтягиваются по мере расширения сетки.

## Алгоритм работы
1. При отсутствии открытых позиций и активных заявок, когда торговля разрешена, запускается новый цикл в выбранном направлении (покупка или продажа).
2. Первая сделка исполняется по рынку объёмом `LotsLevel1`. Ещё тринадцать стоп-заявок выставляются на расстояниях, кратных `LevelDistance`, их объёмы задаются параметрами `LotsLevel2` … `LotsLevel14` (последовательность Фибоначчи).
3. Для каждой сработавшей заявки фиксируется индивидуальный стоп-уровень на `StopLossPoints` шагов цены от входа. Максимальный (для лонга) или минимальный (для шорта) из этих уровней становится общим трейлинг-стопом для всей позиции.
4. При достижении цены трейлинг-уровня позиция закрывается полностью, оставшиеся стоп-заявки снимаются.
5. Плавающая прибыль рассчитывается в валюте счёта. Когда она достигает `MoneyTakeProfit`, сетка закрывается. В зависимости от `TradeAgainAfterProfit` цикл либо запускается повторно, либо стратегия ожидает ручного включения.

## Параметры
- `OpenBuy` — включить сетку только на покупку.
- `OpenSell` — включить сетку только на продажу.
- `TradeAgainAfterProfit` — автоматически перезапускать сетку после фиксации прибыли.
- `LevelDistance` — расстояние между уровнями сетки в шагах цены инструмента.
- `StopLossPoints` — расстояние стоп-лосса от цены входа в шагах цены.
- `MoneyTakeProfit` — целевая плавающая прибыль в валюте счёта.
- `LotsLevel1` … `LotsLevel14` — объёмы для каждого уровня сетки (по умолчанию последовательность Фибоначчи 1, 1, 2, 3, 5, …, 377).

## Особенности реализации
- Смещения по цене вычисляются через `PriceStep` инструмента. Если шаг цены не задан (0), стратегия не отправляет заявки.
- Одновременно активен только один торговый цикл; все стоп-заявки создаются в момент запуска и остаются до исполнения или отмены.
- При каждом новом исполнении пересчитывается общий трейлинг-стоп, чтобы все позиции имели лучший доступный уровень защиты.
- Контроль прибыли основан на текущей позиции (`Position`, `PositionPrice`) и параметрах шага/стоимости шага (`PriceStep`, `StepPrice`).
- Если `TradeAgainAfterProfit` = `false`, после достижения цели стратегия блокирует новые циклы до ручного включения.

## Рекомендации по использованию
- Перед запуском включите только одно направление (покупка или продажа). При одновременном включении обоих сетка не стартует.
- Корректируйте расстояния и объёмы в соответствии с волатильностью инструмента и размером контракта. Большие объёмы по Фибоначчи ведут к агрессивному наращиванию позиции и требуют тщательного тестирования.
- Убедитесь, что брокер поддерживает выставление стоп-заявок по рассчитанным ценам, иначе возможно отклонение заявок.
