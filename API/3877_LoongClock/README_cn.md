# Loong Clock 策略

## 概述
Loong Clock 策略是从 MetaTrader 专家顾问 `LoongClock.mq5` 转换而来的 StockSharp 可视化示例。策略会在图表上绘制一个圆形布局的数字时钟，每秒刷新一次，同时显示当前的小时、分钟和秒值，可选择本地时间、交易服务器时间或 UTC。

该示例不会发送订单，也不会评估市场条件。它的主要目的在于演示如何结合 StockSharp 的图表绘制辅助方法与策略计时器来创建实时更新的图表组件。

## 工作原理
1. 订阅指定的蜡烛类型，为图表提供有效的时间/价格坐标轴。
2. 记录最新蜡烛的收盘价，作为时钟的纵向锚点。
3. 启动 1 秒计时器。每次触发时：
   - 根据用户设置选择时间源（本地/服务器/UTC）。
   - 通过简单三角函数计算每个标签的位置。
   - 在相应坐标绘制中心标记（`@`）以及小时、分钟和秒标签。
4. 所有绘制都复用同一个锚定时间，因此时钟在图表上保持固定，仅标签内容随时间更新。

通过将时针角度转换为时间轴和价格轴的偏移量，能够精确定位标签。小时、分钟和秒使用不同的半径，以还原 MQL 版本的分层效果。

## 参数
| 名称 | 说明 |
| --- | --- |
| `CandleType` | 用于锚定图表区域的蜡烛序列，默认 1 分钟。 |
| `TimeSource` | 时钟所显示的时间源，可选 `Local`、`Server`、`Utc`，默认 `Local`。 |
| `HourTimeRadius` | 小时标签在时间轴上的半径，默认 8 分钟。 |
| `MinuteTimeRadius` | 分钟标签在时间轴上的半径，默认 10 分钟。 |
| `SecondTimeRadius` | 秒标签在时间轴上的半径，默认 12 分钟。 |
| `HourPriceRadius` | 小时标签在价格轴上的半径，默认 0.20。 |
| `MinutePriceRadius` | 分钟标签在价格轴上的半径，默认 0.32。 |
| `SecondPriceRadius` | 秒标签在价格轴上的半径，默认 0.52。 |

所有半径参数均可配置，方便在不同图表比例下调整时钟的大小和形状。

## 使用步骤
1. 将策略附加到能够提供所选 `CandleType` 蜡烛数据的品种。
2. 确保连接器能够提供实时或历史数据，使至少一根蜡烛完成收盘。
3. 在图表上观察时钟，每秒刷新一次；通过 `TimeSource` 切换显示的时间基准。
4. 调整半径参数，可微调小时、分钟、秒标签之间的间距。

## 与 MQL 版本的差异
- 使用 StockSharp 策略计时器与图表绘制辅助方法，替代 MetaTrader 的定时器与图表标签 API。
- 小时、分钟、秒标签采用两位数格式，便于阅读。
- 通过策略参数分别控制水平方向与垂直方向的半径，更灵活地调整布局。
- 以最近收盘价作为锚点，而非像素坐标，从而适配不同品种与价格尺度。

本转换保留了原始脚本持续更新时间显示的核心思想，同时展示了如何利用 StockSharp 的高级 API 进行图表可视化开发。
