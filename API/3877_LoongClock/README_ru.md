# Стратегия Loong Clock

## Обзор
Loong Clock — это визуальная стратегия StockSharp, конвертированная из MetaTrader-советника `LoongClock.mq5`. Она рисует на графике цифровое отображение аналоговых часов: значения часа, минуты и секунды располагаются по кругу и обновляются каждую секунду. Пользователь может выбрать локальное время, время торгового сервера или UTC.

В отличие от типичных торговых стратегий, данный пример не отправляет заявки и не анализирует рынок. Его задача — показать, как с помощью таймера стратегии и функций рисования StockSharp можно создать постоянно обновляемый графический виджет.

## Как это работает
1. Стратегия подписывается на выбранный тип свечей, чтобы сформировать корректные оси времени и цены на графике.
2. Последняя цена закрытия запоминается и используется как вертикальная опора для часов.
3. Запускается секундный таймер. Каждый тик таймера:
   - Определяет источник времени согласно параметру (локальное/серверное/UTC).
   - Вычисляет координаты меток часов с помощью тригонометрии.
   - Рисует центр (`@`) и подписи часа, минуты и секунды в рассчитанных точках.
4. Для всех объектов используется одно и то же опорное время, поэтому часы остаются неподвижными, а обновляются только значения.

Позиции меток рассчитываются переводом угла стрелки в смещение по оси времени и цене. Для часа, минуты и секунды применяются разные радиусы, что повторяет внешний вид оригинального MQL-скрипта.

## Параметры
| Имя | Описание |
| --- | --- |
| `CandleType` | Тип свечей, применяемый для построения осей. По умолчанию минутные свечи. |
| `TimeSource` | Источник времени: `Local`, `Server` или `Utc`. По умолчанию `Local`. |
| `HourTimeRadius` | Радиус часовой метки по оси времени. По умолчанию 8 минут. |
| `MinuteTimeRadius` | Радиус минутной метки по оси времени. По умолчанию 10 минут. |
| `SecondTimeRadius` | Радиус секундной метки по оси времени. По умолчанию 12 минут. |
| `HourPriceRadius` | Радиус часовой метки по оси цены. По умолчанию 0.20. |
| `MinutePriceRadius` | Радиус минутной метки по оси цены. По умолчанию 0.32. |
| `SecondPriceRadius` | Радиус секундной метки по оси цены. По умолчанию 0.52. |

Радиусы вынесены в параметры, что позволяет легко подгонять размеры часов под масштаб конкретного графика.

## Использование
1. Привяжите стратегию к инструменту, для которого доступен поток свечей выбранного типа.
2. Убедитесь, что подключение поставляет реальные или исторические данные, чтобы хотя бы одна свеча закрылась.
3. Наблюдайте за графиком: часы обновляются каждую секунду. При необходимости переключайте `TimeSource`.
4. Настраивайте радиусы, чтобы изменить расстояние между метками часов, минут и секунд.

## Отличия от версии MQL
- Таймер стратегии и функции рисования StockSharp заменяют MQL-функции `EventSetTimer` и объекты графических меток.
- Значения часов, минут и секунд выводятся в двухзначном формате для лучшей читаемости.
- Горизонтальные и вертикальные радиусы регулируются отдельными параметрами.
- В качестве опорной точки используется последняя цена закрытия, а не координаты в пикселях, поэтому часы корректно масштабируются под разные инструменты.

Конвертация сохраняет идею постоянно обновляемых часов и демонстрирует применение высокоуровневого API StockSharp для создания интерактивных элементов на графике.
