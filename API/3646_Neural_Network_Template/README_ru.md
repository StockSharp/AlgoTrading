# Стратегия Neural Network Template

## Обзор
Стратегия повторяет MQL5-шаблон, в котором значения RSI и MACD передавались в нейронную сеть. В StockSharp отсутствует оригинальный загрузчик нейросети, поэтому вместо «чёрного ящика» используется прозрачная модель оценки, сохраняющая структуру и риск-контроль исходного эксперта. Цель — входить в рынок, когда RSI и MACD совпадают по направлению, а ожидаемое движение достаточно велико.

## Индикаторы и данные
- **RSI (12 периодов)** считается по цене закрытия и соответствует типичной цене из MQL5-версии.
- **MACD (12/48/12)** используется для оценки гистограммы и силы импульса.
- **Таймфрейм** настраивается, по умолчанию 5-минутные свечи как в исходном советнике.

## Логика торговли
1. После закрытия каждой свечи стратегия обновляет скользящее окно значений RSI и гистограммы MACD. Размер окна задаётся параметром `BarsToPattern`.
2. Отклонение RSI от уровня 50 и отклонение гистограммы MACD от её скользящего среднего комбинируются в показатель доверия. Для сжатия диапазона применяется гиперболический тангенс, имитирующий выход нейросети.
3. Если абсолютное значение доверия превышает `TradeLevel`, а прогнозируемое движение (в пунктах) больше `MinTargetPoints`, стратегия открывает позицию по рынку в направлении оценки.
4. Для каждой позиции рассчитывается индивидуальный тейк-профит: прогнозируемое движение умножается на `ProfitMultiply`, после чего ограничивается `MaxTakeProfitPoints`. Стоп-лосс выставляется симметрично в пунктах.
5. Пока позиция открыта, каждая завершённая свеча проверяет достижение целевых уровней. При касании цены тейк-профита или стоп-лосса позиция закрывается по рынку, а внутреннее состояние сбрасывается.

## Параметры
| Параметр | Описание |
| --- | --- |
| `BarsToPattern` | Размер скользящего окна для расчётов RSI и MACD. |
| `TradeLevel` | Минимальная требуемая уверенность (0-1) для открытия сделки. |
| `ProfitMultiply` | Множитель, применяемый к прогнозу перед ограничением `MaxTakeProfitPoints`. |
| `MinTargetPoints` | Минимальный прогноз по пунктам, необходимый для входа. |
| `MaxTakeProfitPoints` | Максимально допустимый тейк-профит в пунктах. |
| `StopLossPoints` | Расстояние стоп-лосса от цены входа в пунктах. |
| `TradeVolume` | Объём каждой рыночной заявки. |
| `CandleType` | Тип/таймфрейм свечей, которые подписывает стратегия. |

## Примечания
- Детерминированная модель уверенности упрощает анализ и сохраняет дух оригинальной нейросетевой идеи.
- Управление тейк-профитом и стоп-лоссом выполняется вручную внутри стратегии, чтобы у каждой сделки оставались собственные целевые уровни, как в версии MQL5.
- Стратегия анализирует сигналы только при отсутствии открытой позиции, полностью копируя однопозиционный режим исходного эксперта.
