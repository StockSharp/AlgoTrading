# Стратегия Swetten

## Общее описание
Swetten — нейросетевая стратегия пробоя, изначально созданная для MetaTrader 4. Она анализирует спред между долгой простой скользящей средней с периодом 233 и десятью более короткими средними на минутных свечах. Полученные спреды подаются в радиально-базисную сеть, которая выдаёт положительный (покупка) или отрицательный (продажа) сигнал.

## Рынок и таймфрейм
- Разрабатывалась для основных валютных пар, исходная версия работала с EURUSD.
- Расчёты выполняются по минутным свечам и только после их полного формирования.
- Проверка сигналов происходит каждые два часа в начале чётного часа (00:00, 02:00, …, 22:00). В выходные торги не открываются.

## Индикаторы и признаки
- Простые скользящие средние с периодами: 233 (база), 144, 89, 55, 34, 21, 13, 8, 5, 3, 2.
- Входы нейросети — разницы между SMA(233) и каждой быстрой SMA.
- Перед подачей в сеть значения ограничиваются обученными диапазонами, нормализуются и масштабируются исходными коэффициентами.
- Нейросеть полностью повторяет функцию `EURUSDn` из исходной DLL: 38 гауссовых функций, чьи значения усредняются для получения итогового активационного уровня.

## Правила торговли
1. Дождаться закрытия минутной свечи, которая завершает чётный час в рабочий день.
2. Рассчитать активацию нейросети на основе разниц скользящих средних.
3. Если активация > 0 и текущая позиция не длинная — отправить рыночную покупку на объём `TradeVolume + abs(Position)`.
4. Если активация < 0 и текущая позиция не короткая — отправить рыночную продажу на объём `TradeVolume + abs(Position)`.
5. Управление позицией:
   - Фиксированный тейк-профит в шагах цены (`TakeProfitPoints`).
   - Фиксированный стоп-лосс в шагах цены (`StopLossPoints`).
   - При достижении уровней по максимуму/минимуму свечи позиция закрывается рыночной заявкой.

## Параметры
| Имя | Описание | Значение по умолчанию |
| --- | --- | --- |
| `CandleType` | Серия свечей для расчётов. | Минутные свечи |
| `TradeVolume` | Базовый объём сделки в лотах. | 0.1 |
| `SlowPeriod` | Период базовой SMA. | 233 |
| `TakeProfitPoints` | Тейк-профит в шагах цены. | 150 |
| `StopLossPoints` | Стоп-лосс в шагах цены. | 40 |

## Особенности конверсии
- Нейросетевой код из DLL переписан на C# строчка к строчке, что обеспечивает идентичный результат.
- Логика закрытия позиций повторяет MQL-условия `OrderClose`, используя экстремумы свечей и шаг цены.
- Метод `OnNewMyTrade` фиксирует цену последней сделки для корректной оценки выхода.
- Код использует высокоуровневые API StockSharp (`SubscribeCandles`, `Bind`) и сопровождается комментариями на английском языке, как требуют инструкции.
