# Swetten 策略

## 概述
Swetten 是最初为 MetaTrader 4 开发的神经网络突破策略。策略在一分钟K线上计算 233 周期简单移动平均线与 10 条更快均线之间的价差，并将这些价差输入径向基神经网络。网络输出为正时认为多头占优，输出为负时认为空头占优。

## 市场与周期
- 适用于主要外汇货币对，原版针对 EURUSD。
- 所有计算基于完整收盘的一分钟K线。
- 仅在偶数小时（00:00、02:00 … 22:00）闭合的K线上评估信号；周末不触发交易。

## 指标与特征
- 简单移动平均线：233（基准）、144、89、55、34、21、13、8、5、3、2。
- 神经网络输入为 SMA233 与每条快速均线之间的差值。
- 输入在送入网络前会进行范围裁剪、归一化与缩放，参数与原始 DLL 完全一致。
- 神经网络包含 38 个高斯特征，本策略逐条重写 `EURUSDn` 函数以保证结果一致。

## 交易规则
1. 等待工作日偶数小时结束的一分钟K线收盘。
2. 根据最新均线差值计算神经网络激活值。
3. 若激活值大于 0 且当前非多头仓位，则以 `TradeVolume + abs(Position)` 的数量市价买入。
4. 若激活值小于 0 且当前非空头仓位，则以同样的数量市价卖出。
5. 持仓管理：
   - 使用 `TakeProfitPoints` 指定的固定止盈距离（价格步长单位）。
   - 使用 `StopLossPoints` 指定的固定止损距离。
   - 若蜡烛最高价/最低价触及止盈或止损距离，则通过市价单平仓。

## 参数
| 名称 | 说明 | 默认值 |
| --- | --- | --- |
| `CandleType` | 用于分析的K线类型。 | 1 分钟 |
| `TradeVolume` | 开仓基础手数。 | 0.1 |
| `SlowPeriod` | 基准简单移动平均线的周期。 | 233 |
| `TakeProfitPoints` | 止盈距离（价格步长）。 | 150 |
| `StopLossPoints` | 止损距离（价格步长）。 | 40 |

## 转换说明
- 将原始 DLL 中的神经网络函数完全移植到 C#，避免依赖外部库。
- 止盈止损逻辑依据原 MQL 代码的 `OrderClose` 条件，在K线极值上进行判断。
- 通过 `OnNewMyTrade` 记录成交价，从而在关闭仓位时参考最新成交价格。
- 遵循 StockSharp 转换指南，采用 `SubscribeCandles` 和 `Bind` 等高级 API，并将全部注释改为英文。
