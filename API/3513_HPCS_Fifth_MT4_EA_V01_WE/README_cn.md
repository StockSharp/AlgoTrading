# HPCS Fifth MT4 EA V01 WE 策略
[English](README.md) | [Русский](README_ru.md)

## 概述
**HPCS Fifth MT4 EA V01 WE** 策略是 MetaTrader 4 专家顾问 `_HPCS_Fifth_MT4_EA_V01_WE.mq4` 的 StockSharp 版本。原始 EA 仅用于通知：当图表生成新的蜡烛时，会调用 `Alert()` 并播放提示音。本实现依靠 StockSharp 的高级 API 订阅指定的蜡烛时间框架，忽略尚未完成的更新，在蜡烛收盘时记录一条自定义消息，并可选地记录需要播放的声音文件名称，从而忠实复制 MT4 中的行为。

策略不会下单或调整头寸，适合用于监控行情节奏、驱动外部提醒系统或作为更复杂自动化流程的模块。通过参数可以选择蜡烛类型、自定义日志内容以及说明要播放的音频资源。

## 通知流程
1. 启动时根据 `CandleType` 订阅蜡烛序列。
2. 仅处理状态为 `Finished` 的蜡烛，以匹配 MetaTrader 只使用收盘数据的逻辑。
3. 记录上一根蜡烛的开盘时间，如果新蜡烛的开盘时间相同则跳过，避免重复提示。
4. 检测到新的已完成蜡烛后，写入包含 `AlertMessage` 和开盘时间（ISO 8601 格式）的信息日志。
5. 当 `PlaySound` 为真且 `SoundFile` 非空时，再写入一条日志，提示需要触发的声音文件。

该流程在保持平台无关性的同时，实现了 `Alert()` 与 `PlaySound()` 的组合效果，可与 StockSharp 的日志、通知或自定义监听器集成。

## 参数
- `CandleType` – 需要监控的蜡烛数据类型及时间框架（默认：1 分钟蜡烛）。
- `AlertMessage` – 在检测到新蜡烛时写入日志的文本（默认：`"New Candle Generated"`）。
- `PlaySound` – 是否写入声音提示信息（默认：`true`）。
- `SoundFile` – 与提示关联的声音文件名称（默认：`"alert.wav"`）。

策略本身不交易，只有在将其嵌入其他系统时才需要设置 `Volume`。

## 使用建议
- 将日志与桌面通知、邮件服务或自建的声音播放器连接，在新蜡烛生成时触发所需的提醒。
- 运行多个实例并配置不同的 `CandleType`，可同时监控多种时间框架，例如 1 分钟与 1 小时图。
- 在 `AlertMessage` 中加入品种名称、时间框架或交易时段，方便快速识别提醒来源。
- 如果策略作为更大交易机器人的一部分，日志输出可以作为其他模块等待收盘的同步信号。

## 实现细节
- 使用 `SubscribeCandles` 与 `Bind` 等高层 API，无需手动维护时间序列，行为与 MT4 的 `Time[]` 数组一致。
- 严格检查 `CandleStates.Finished`，确保只在蜡烛收盘时触发提醒，避免生成过程中的噪声。
- 仅保存上一根蜡烛的开盘时间，不引入多余集合，符合转换规范的要求。
- 如果存在可视化界面，策略会调用 `CreateChartArea` 与 `DrawCandles` 在图表上绘制蜡烛，便于观察行情节奏。
- 代码注释与日志均使用英文，方便跨语言团队协作并满足项目约束。

该示例表明，即便是简单的 MT4 提醒脚本，也能在 StockSharp 中通过参数化设计和高层 API 获得结构化的实现。
