# Стратегия HPCS Fifth MT4 EA V01 WE
[English](README.md) | [中文](README_cn.md)

## Обзор
**HPCS Fifth MT4 EA V01 WE** — это точный перенос советника MetaTrader 4 `_HPCS_Fifth_MT4_EA_V01_WE.mq4` в инфраструктуру StockSharp. Оригинальный советник носит информационный характер: он следит за активным графиком и при появлении каждой новой свечи выводит сигнал и запускает звук. Переписанная стратегия использует высокоуровневый API StockSharp, чтобы подписаться на нужный таймфрейм, отфильтровать незавершённые обновления и зафиксировать пользовательское уведомление, как только свеча закрывается. Дополнительная запись о звуковом файле имитирует вызов `PlaySound`, поэтому стратегия идеально подходит как лёгкий монитор сессии или строительный блок для более сложной автоматизации.

В отличие от торговых алгоритмов, стратегия не создаёт ордера. Её задача — оперативно информировать трейдера о появлении новых баров на любом доступном таймфрейме. Набор параметров позволяет выбрать тип свечей, настроить текст оповещения и указать файл звука, который должен воспроизводиться внешними средствами.

## Логика уведомлений
1. При запуске стратегия подписывается на поток свечей, указанный параметром `CandleType`.
2. Обрабатываются только свечи в состоянии `Finished`, что повторяет ориентацию MT4 на закрытые бары.
3. Запоминается время открытия последней обработанной свечи. Если новая запись имеет тот же штамп времени, она пропускается, чтобы избежать повторных уведомлений.
4. При появлении уникальной завершённой свечи стратегия создаёт информационную запись с текстом `AlertMessage` и временем открытия в формате ISO 8601.
5. Если флаг `PlaySound` включён и параметр `SoundFile` заполнен, добавляется вторая запись, фиксирующая название звукового ресурса.

Такой алгоритм воспроизводит комбинацию вызовов `Alert()` и `PlaySound()` из MetaTrader в унифицированном виде, совместимом с журналами и уведомлениями StockSharp.

## Параметры
- `CandleType` — тип данных и таймфрейм свечей для наблюдения (по умолчанию минутные свечи).
- `AlertMessage` — текст информационного сообщения при появлении новой свечи (по умолчанию `"New Candle Generated"`).
- `PlaySound` — флаг, управляющий выводом записи о звуковом оповещении (по умолчанию `true`).
- `SoundFile` — имя звукового файла, связанного с уведомлением (по умолчанию `"alert.wav"`).

Свойство `Volume` имеет смысл изменять только при использовании стратегии в составе более крупной системы — сама по себе она не торгует.

## Рекомендации по использованию
- Свяжите стратегию с системами уведомлений StockSharp или внешними обработчиками логов, чтобы получать всплывающие подсказки, письма или воспроизведение звука при формировании нового бара.
- Запускайте несколько экземпляров с различными `CandleType`, если требуется контролировать несколько таймфреймов одновременно (например, минутный и часовой графики).
- Настройте `AlertMessage`, добавив в него название инструмента, таймфрейм или торговую сессию для большей ясности.
- В составе более крупного бота записи журнала можно использовать как сигнал синхронизации для модулей, которым важно дождаться закрытия свечи.

## Особенности реализации
- Используется высокоуровневый API (`SubscribeCandles` и `Bind`), поэтому нет необходимости вручную управлять временными рядами, как в MQL-массиве `Time[]`.
- Фильтрация по `CandleStates.Finished` полностью исключает повторные срабатывания во время формирования свечи и сохраняет поведение исходного советника.
- Стратегия хранит только время открытия последней свечи, что избавляет от вспомогательных коллекций и соответствует ограничениям на конвертацию.
- При наличии окна визуализации вызываются `CreateChartArea` и `DrawCandles`, позволяя оператору наблюдать поток свечей на графике.
- Все комментарии и сообщения оставлены на английском языке согласно требованиям процесса миграции.

Несмотря на простоту, пример показывает, как уведомительные скрипты MetaTrader переносятся в StockSharp с сохранением функциональности и использованием параметров для гибкой настройки.
