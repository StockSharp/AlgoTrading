# Стратегия AeroSpine

## Обзор
Стратегия AeroSpine — это перенос советника MetaTrader **AEROSPINE.mq4**. Торговля ведётся по одному инструменту и строится на пробое дневного открытия. Оригинальный робот требовал таймфрейм D1 и анализировал тики; версия для StockSharp сохраняет логику «прорыва цены от открытия дня», но использует завершённые свечи.

## Логика торговли
- В начале каждого торгового дня запоминается цена открытия дня (берётся из первой свечи текущей даты).
- Новые входы рассматриваются только после заданного часа. Последняя завершённая свеча должна пройти проверку на минимальный объём, а текущий спред — быть меньше допустимого значения.
- При отсутствии позиции и без ожидания восстановления:
  - **Покупка** открывается, когда максимум свечи превышает дневное открытие на `EntryOffsetPips` пунктов.
  - **Продажа** открывается, когда минимум свечи пробивает дневное открытие вниз на `EntryOffsetPips` пунктов.
- После убыточного закрытия формируется сделка восстановления в противоположном направлении. Для неё используется порог `RecoveryOffsetPips`, а объём увеличивается на величину проигрышной позиции плюс базовый объём, что повторяет мартингейл оригинала.
- Управление открытой позицией включает:
  - фиксированный тейк-профит на расстоянии `TakeProfitPips` от цены входа;
  - необязательное переведение в безубыток: после прохождения `BreakEvenPips` цена откатывается назад и сделка закрывается;
  - защитный выход, если цена возвращается к дневному открытию и проходит против позиции `ExitOffsetPips` пунктов.

## Параметры
| Название | Описание |
| -------- | -------- |
| **Candle Type** | Рабочий таймфрейм свечей для расчёта сигналов. |
| **Volume** | Базовый торговый объём первой сделки и основа для расчёта объёма восстановления. |
| **Entry Hour** | Минимальный час (по времени биржи), когда допускаются новые входы. |
| **Entry Offset** | Отступ от дневного открытия в пунктах для первого входа. |
| **Exit Offset** | Отступ от дневного открытия против позиции, при достижении которого позиция закрывается. |
| **Recovery Offset** | Отступ для входа в сделку восстановления. |
| **Take Profit** | Дистанция тейк-профита от цены открытия позиции. |
| **Break Even** | Дистанция для активации выхода по безубытку. |
| **Use Break Even** | Включает или отключает безубыточное сопровождение. |
| **Volume Filter** | Минимальный объём свечи, аналог условия `Volume[0] > 10000` в MQL. |
| **Max Spread** | Максимально допустимый спред перед открытием сделок. |
| **Enable Recovery** | Разрешает восстановительные сделки после убытков. |

## Особенности переноса
- В оригинале проверка пробоя выполнялась по тикам на графике D1. В портированной версии дневное открытие обновляется по первой свече дня, а условия пробоя рассчитываются по максимуму/минимуму завершённых свечей.
- Удалены элементы пользовательского интерфейса MetaTrader (текстовые метки, кросс-символьная статистика). Сохранена лишь логика торговли текущим инструментом.
- Управление стопами через `OrderModify` заменено на вызов `ClosePosition()` при достижении расчётных уровней.
- Фильтры по спреду и объёму напрямую соответствуют проверкам `MODE_SPREAD` и `Volume[0]` из исходного кода.
