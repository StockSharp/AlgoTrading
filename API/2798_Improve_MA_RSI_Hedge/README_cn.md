# Improve MA & RSI Hedge 策略
[English](README.md) | [Русский](README_ru.md)

本策略将 MetaTrader 的 “Improve” EA 迁移到 StockSharp 平台。它同时交易两个品种：在策略中选择的主品种以及用于对冲的品种。交易方向由主品种上的两条平滑移动平均线（SMMA）以及 RSI 指标共同决定。对冲腿与主腿保持同方向，从而构建协同的双品种头寸，目标是在相关资产同步运动时捕捉收益，同时降低单一品种的风险。

## 策略逻辑

- 在主品种上计算两条平滑移动平均线（SMMA），可分别设置快线与慢线周期。
- 计算同周期的 RSI，并监控超卖/超买水平。
- 当慢线位于快线上方且 RSI 低于或等于超卖阈值时，同时在两个品种上开多仓。
- 当慢线位于快线下方且 RSI 高于或等于超买阈值时，同时在两个品种上开空仓。
- 持仓一直保留，直到两个品种的合计浮动利润达到设定的货币目标，然后通过市价单同时平掉两条腿。

算法保存每个品种最新的收盘价，并使用入场价与当前价的差值估算总体利润。由于没有内置止损，如果价格未触及盈利目标，仓位可能会长期持有。

## 参数

| 参数 | 说明 |
| --- | --- |
| **Volume** | 主腿与对冲腿的下单数量。 |
| **Profit Target** | 两条腿共享的盈利目标（货币单位）。达到后立刻平仓。 |
| **Hedge Security** | 与主品种同时交易的对冲品种。 |
| **Fast MA** | 快速 SMMA 的周期（默认 8）。 |
| **Slow MA** | 慢速 SMMA 的周期（默认 21），必须大于快速周期。 |
| **RSI Period** | RSI 的计算长度（默认 21）。 |
| **Oversold** | RSI 的超卖阈值，满足条件并配合均线关系触发做多（默认 30）。 |
| **Overbought** | RSI 的超买阈值，满足条件并配合均线关系触发做空（默认 70）。 |
| **Candle Type** | 计算所用的蜡烛周期。默认 1 小时，可按需求调整。 |

## 使用指标

- **平滑移动平均线（SMMA）**：用于判定趋势方向（快/慢两条）。
- **相对强弱指标（RSI）**：用于识别超卖与超买区域。

## 入场与出场规则

1. **做多**
   - 慢速 SMMA 高于快速 SMMA。
   - RSI ≤ 超卖阈值。
   - 在主品种和对冲品种上同时发送买入市价单。
2. **做空**
   - 慢速 SMMA 低于快速 SMMA。
   - RSI ≥ 超买阈值。
   - 在两个品种上同时发送卖出市价单。
3. **平仓**
   - 当 `(主腿利润 + 对冲腿利润) ≥ Profit Target` 时，通过市价单同时平掉所有仓位。
   - 策略不包含额外的止损或追踪止损，如需风险控制应另外实现。

## 使用建议

- 启动策略前必须指定主品种和对冲品种，否则策略会抛出异常。
- 合计利润基于蜡烛收盘价估算，实际成交可能受滑点和执行速度影响。
- 建议用于高度相关的品种组合（如相关货币对或同类期货），预期出现同步走势。
- 实盘时应结合额外的资金管理或组合风险控制，因为策略仅依赖虚拟盈利目标作为退出机制。
