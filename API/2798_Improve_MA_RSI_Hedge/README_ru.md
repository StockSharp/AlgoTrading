# Стратегия Improve MA & RSI Hedge
[English](README.md) | [中文](README_cn.md)

Стратегия является переносом эксперта MetaTrader «Improve» на платформу StockSharp. Она одновременно торгует двумя инструментами: основным, выбранным в настройках стратегии, и хеджирующим. Направление сделки определяется положением двух сглаженных скользящих средних (SMMA) на основном инструменте и значением индикатора RSI. Хеджирующая нога открывается в том же направлении, формируя синхронную позицию на двух инструментах и уменьшая риск отдельного актива.

## Логика стратегии

- Рассчитываются две сглаженные скользящие средние (SMMA) с настраиваемыми периодами для основного инструмента.
- RSI вычисляется по тем же свечам и сравнивается с уровнями перепроданности/перекупленности.
- **Длинная позиция** открывается одновременно по обоим инструментам, когда медленная SMMA находится выше быстрой, а RSI ниже или равен уровню перепроданности.
- **Короткая позиция** открывается по обоим инструментам, когда медленная SMMA ниже быстрой, а RSI выше или равен уровню перекупленности.
- Открытые позиции удерживаются до тех пор, пока суммарная плавающая прибыль по двум ногам не превысит заданный денежный порог. После достижения цели обе позиции закрываются рыночными заявками.

Алгоритм хранит последние цены закрытия каждого инструмента и оценивает суммарную прибыль через разницу между текущей ценой и ценой входа. Стоп‑лоссов нет, поэтому позиции могут находиться в рынке долгое время, если цена не достигает цели по прибыли.

## Параметры

| Параметр | Описание |
| --- | --- |
| **Volume** | Объём заявки для основного и хеджирующего инструмента. |
| **Profit Target** | Денежная цель для обеих ног. При достижении значения все позиции закрываются. |
| **Hedge Security** | Хеджирующий инструмент, торгуемый вместе с основным. |
| **Fast MA** | Период быстрой сглаженной скользящей средней (по умолчанию 8). |
| **Slow MA** | Период медленной сглаженной скользящей средней (по умолчанию 21). Должен быть больше периода быстрой. |
| **RSI Period** | Длина расчёта RSI (по умолчанию 21). |
| **Oversold** | Уровень RSI для входа в покупки при выполнении условия по средним (по умолчанию 30). |
| **Overbought** | Уровень RSI для входа в продажи при выполнении условия по средним (по умолчанию 70). |
| **Candle Type** | Таймфрейм свечей для расчётов. По умолчанию используется часовой интервал. |

## Используемые индикаторы

- **Smoothed Moving Average (SMMA)** — два индикатора с разными периодами для оценки направления тренда.
- **Relative Strength Index (RSI)** — определяет зоны перепроданности и перекупленности.

## Правила входа и выхода

1. **Покупка**
   - Медленная SMMA выше быстрой.
   - RSI ≤ уровень перепроданности.
   - Рыночные заявки на покупку отправляются по основному и хеджирующему инструментам.
2. **Продажа**
   - Медленная SMMA ниже быстрой.
   - RSI ≥ уровень перекупленности.
   - Рыночные заявки на продажу отправляются по обоим инструментам.
3. **Выход**
   - Когда `(прибыль по основному инструменту + прибыль по хеджу) ≥ Profit Target`, обе позиции закрываются рыночными заявками.
   - Дополнительных стоп‑лоссов и трейлинг‑стопов нет. При необходимости их следует реализовывать отдельно.

## Дополнительные рекомендации

- Перед запуском стратегии необходимо указать как основной, так и хеджирующий инструменты, иначе будет сгенерировано исключение.
- Суммарная прибыль рассчитывается по ценам закрытия свечей, поэтому фактический результат может отличаться из‑за проскальзывания и различий в исполнении.
- Стратегия подходит для коррелированных инструментов (например, валютных пар или связанных фьючерсов), где ожидается синхронное движение.
- Рекомендуется дополнить стратегию портфельными ограничениями по риску, поскольку единственным механизмом выхода остаётся виртуальная цель по прибыли.
