# Стратегия MaRobot

## Краткое описание
- Реализует свечную стратегию пересечения скользящих средних на настраиваемом внутридневном таймфрейме с фильтрами по дневным ADX и RSI.
- Задействует высокоуровневый `Bind` StockSharp для расчёта двух `SimpleMovingAverage`, индикаторов экстремумов `Lowest`/`Highest`, а также дневных `AverageDirectionalIndex` и `RelativeStrengthIndex`.
- Полностью повторяет защитные механизмы MT4-версии: процентный тейк-профит, стоп по локальному экстремуму и переход в безубыток после достижения минимальной прибыли.

## Индикаторы
- Быстрая и медленная `SimpleMovingAverage` на рабочем таймфрейме.
- `Lowest` и `Highest` для определения минимальной и максимальной цены за последние `BackClose` баров.
- Дневные `AverageDirectionalIndex` и `RelativeStrengthIndex` для оценки силы тренда и импульса.

## Параметры
- `CandleType` – основной таймфрейм (по умолчанию 15-минутные свечи).
- `FastPeriod`, `SlowPeriod` – периоды быстрых и медленных SMA.
- `AdxThreshold` – максимальное значение дневного ADX для разрешения входа.
- `RsiThreshold` – порог дневного RSI для покупок (для продаж используется `100 - RsiThreshold`).
- `TakeProfitRatio` – относительное значение тейк-профита от цены входа.
- `StopLossPoints` – расстояние защитного стопа (в шагах цены), активируемого после достижения `ProtectThreshold`.
- `ProtectThreshold` – минимальная доля прибыли для постановки защитного стопа.
- `BackClose` – количество завершённых баров для выбора экстремума стопа.
- `DailyAdxPeriod`, `DailyRsiPeriod` – периоды дневных индикаторов.

## Правила работы
1. Сигналы обрабатываются только на закрытых свечах, как в исходном советнике MT4.
2. Торговля начинается после формирования всех индикаторов и получения актуальных дневных значений ADX/RSI.
3. **Фильтры входа**:
   - Если дневной ADX превышает `AdxThreshold`, новые позиции не открываются.
   - Лонг: быстая SMA пересекает медленную снизу вверх и дневной RSI ниже `RsiThreshold`.
   - Шорт: быстая SMA пересекает медленную сверху вниз и дневной RSI выше `100 - RsiThreshold`.
4. При входе фиксируется экстремум (`Lowest` для лонга, `Highest` для шорта) как ориентир стоп-лосса.
5. **Сопровождение позиции**:
   - Закрытие по достижении прибыли `TakeProfitRatio` от цены входа.
   - Закрытие при пробое зафиксированного экстремума.
   - Закрытие при обратном пересечении скользящих средних.
   - После превышения `ProtectThreshold` рассчитывается защитный стоп на расстоянии `StopLossPoints` (с округлением к шагу цены); при возврате цены к этому уровню позиция закрывается.
6. После выхода из позиции внутренние переменные очищаются.

## Примечания
- Все комментарии в коде написаны на английском языке согласно требованиям репозитория.
- Стратегия использует только высокоуровневые подписки StockSharp, без прямого доступа к буферам индикаторов.
- Python-реализация намеренно отсутствует в соответствии с заданием.
