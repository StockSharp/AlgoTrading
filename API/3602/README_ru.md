# Стратегия ShowHistoryOnChart

## Общее описание
**ShowHistoryOnChartStrategy** воспроизводит ранее исполненные сделки, экспортированные из MetaTrader в CSV-файл. Стратегия открывает и закрывает позиции в среде StockSharp строго по расписанию из истории, что позволяет визуально оценивать прошлые сделки на графике без расчёта индикаторов.

## Идея оригинального MQL-советника
Советник MetaTrader "ShowHistoryOnChart-V1.1" считывает историю сделок из CSV и рисует на графике стрелки и трендовые линии, отмечая каждую позицию. Самостоятельно ордера он не выставляет. В портированной версии для StockSharp те же самые сделки исполняются рыночными приказами в соответствующие моменты времени, и слой Own Trades показывает точки входа и выхода, аналогичные оригиналу.

## Логика работы
1. **Разбор CSV**. При запуске стратегия открывает файл, указаный в параметре `FileName`. CSV должен быть разделён точкой с запятой и содержать поля: время открытия, тип (Buy/Sell), объём, символ, цена открытия, дополнительный объём, время закрытия, цена закрытия, комиссия, своп и прибыль.
2. **Фильтр по инструменту**. В расписание попадают только записи, у которых поле `symbol` совпадает с выбранным инструментом (`Security.Id` или `Security.Code`).
3. **Сортировка по времени**. Все сделки упорядочиваются по времени открытия. Сделки, начавшиеся до момента запуска стратегии, пропускаются, чтобы не воспроизводить закрытую историю.
4. **Цикл воспроизведения**. Стратегия подписывается на свечи типа `CandleType`. Когда свеча завершается:
   - Все ожидающие сделки с временем открытия не позже закрытия свечи исполняются рыночными ордерами (`BuyMarket` или `SellMarket`).
   - Для активных сделок, у которых время закрытия не позже закрытия свечи, отправляется встречный рыночный ордер для фиксации позиции.
5. **Отрисовка**. Поскольку выставляются реальные ордера, вспомогательный метод `DrawOwnTrades` отображает на графике точки входа и выхода, что визуально повторяет поведение MQL-версии.

## Параметры
| Имя | Описание | Значение по умолчанию |
|-----|----------|-----------------------|
| `FileName` | Абсолютный или относительный путь к CSV-файлу истории сделок. | Пустая строка |
| `CandleType` | Тип свечей, по которым синхронизируется расписание (например, минутные свечи). | Минутные свечи |

## Дополнительная информация
- Метки времени должны корректно разбираются методами `DateTimeOffset.Parse` или `DateTime.Parse` в инвариантной культуре (например, `2023.05.01 12:30`).
- Объём берётся из третьего столбца CSV (соответствует `volume1` в исходном скрипте) и приводится к модулю.
- Записи с некорректными данными (неизвестный тип, отсутствие полей, закрытие раньше открытия) игнорируются с предупреждением в журнале.
- Стратегия не использует индикаторы и выполняет только функцию воспроизведения сделок.
